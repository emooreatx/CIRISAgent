
=============================================================================== ERRORS ================================================================================
______________________________________________ ERROR at setup of TestAsyncEmergencyEndpoint.test_async_shutdown_success _______________________________________________
tests/api/routes/test_emergency.py:263: in async_client
    async with AsyncClient(app=app, base_url="http://test") as client:
E   TypeError: AsyncClient.__init__() got an unexpected keyword argument 'app'
__________________________________________________ ERROR at setup of TestIncidentEndpoints.test_get_recent_incidents __________________________________________________
file /home/emoore/CIRISAgent/tests/api/routes/test_incidents.py, line 108
      async def test_get_recent_incidents(self, client, mock_services, sample_incident):
          """Test getting recent incidents."""
          # For now, the endpoint returns empty results
          response = await client.get("/v1/incidents?hours=24")
          assert response.status_code == 200

          data = response.json()
          assert data["success"] is True
          assert data["data"]["total"] == 0
          assert data["data"]["incidents"] == []
          assert isinstance(data["data"]["severity_counts"], dict)
          assert isinstance(data["data"]["status_counts"], dict)
E       fixture 'client' not found
>       available fixtures: _session_event_loop, _session_faker, admin_headers, anyio_backend, anyio_backend_name, anyio_backend_options, api_port, api_required, authority_headers, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cleanup_after_test, cov, doctest_namespace, ensure_pydantic_models_rebuilt, event_loop, event_loop_policy, faker, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, mock_auth_service, mock_services, monkeypatch, no_cover, observer_headers, pytestconfig, randomize_api_port, record_property, record_testsuite_property, record_xml_attribute, recwarn, root_headers, runtime, sample_incident, sample_insight, sample_problem, service_registry, skip_without_discord_token, tests/api/routes/test_incidents.py::<event_loop>, tests/api/routes/test_incidents.py::TestIncidentEndpoints::<event_loop>, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory
>       use 'pytest --fixtures [testpath]' for help on them.

/home/emoore/CIRISAgent/tests/api/routes/test_incidents.py:108
__________________________________________________ ERROR at setup of TestIncidentEndpoints.test_get_incident_details __________________________________________________
file /home/emoore/CIRISAgent/tests/api/routes/test_incidents.py, line 121
      async def test_get_incident_details(self, client, mock_services, sample_incident):
          """Test getting specific incident details."""
          # Mock memory service to return incident
          mock_services["memory"].recall_one.return_value = sample_incident.to_graph_node()

          response = await client.get("/v1/incidents/incident_001")
          assert response.status_code == 200

          data = response.json()
          assert data["success"] is True
          assert data["data"]["id"] == "incident_001"
          assert data["data"]["severity"] == "HIGH"
          assert data["data"]["status"] == "OPEN"
E       fixture 'client' not found
>       available fixtures: _session_event_loop, _session_faker, admin_headers, anyio_backend, anyio_backend_name, anyio_backend_options, api_port, api_required, authority_headers, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cleanup_after_test, cov, doctest_namespace, ensure_pydantic_models_rebuilt, event_loop, event_loop_policy, faker, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, mock_auth_service, mock_services, monkeypatch, no_cover, observer_headers, pytestconfig, randomize_api_port, record_property, record_testsuite_property, record_xml_attribute, recwarn, root_headers, runtime, sample_incident, sample_insight, sample_problem, service_registry, skip_without_discord_token, tests/api/routes/test_incidents.py::<event_loop>, tests/api/routes/test_incidents.py::TestIncidentEndpoints::<event_loop>, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory
>       use 'pytest --fixtures [testpath]' for help on them.

/home/emoore/CIRISAgent/tests/api/routes/test_incidents.py:121
_________________________________________________ ERROR at setup of TestIncidentEndpoints.test_get_incident_not_found _________________________________________________
file /home/emoore/CIRISAgent/tests/api/routes/test_incidents.py, line 135
      async def test_get_incident_not_found(self, client, mock_services):
          """Test getting non-existent incident."""
          mock_services["memory"].recall_one.return_value = None

          response = await client.get("/v1/incidents/nonexistent")
          assert response.status_code == 404
          assert "Incident not found" in response.json()["detail"]
E       fixture 'client' not found
>       available fixtures: _session_event_loop, _session_faker, admin_headers, anyio_backend, anyio_backend_name, anyio_backend_options, api_port, api_required, authority_headers, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cleanup_after_test, cov, doctest_namespace, ensure_pydantic_models_rebuilt, event_loop, event_loop_policy, faker, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, mock_auth_service, mock_services, monkeypatch, no_cover, observer_headers, pytestconfig, randomize_api_port, record_property, record_testsuite_property, record_xml_attribute, recwarn, root_headers, runtime, sample_incident, sample_insight, sample_problem, service_registry, skip_without_discord_token, tests/api/routes/test_incidents.py::<event_loop>, tests/api/routes/test_incidents.py::TestIncidentEndpoints::<event_loop>, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory
>       use 'pytest --fixtures [testpath]' for help on them.

/home/emoore/CIRISAgent/tests/api/routes/test_incidents.py:135
_________________________________________________ ERROR at setup of TestIncidentEndpoints.test_get_incident_patterns __________________________________________________
file /home/emoore/CIRISAgent/tests/api/routes/test_incidents.py, line 143
      async def test_get_incident_patterns(self, client, mock_services):
          """Test getting incident patterns."""
          response = await client.get("/v1/incidents/patterns?hours=168")
          assert response.status_code == 200

          data = response.json()
          assert data["success"] is True
          assert data["data"]["total"] == 0
          assert data["data"]["patterns"] == []
          assert "Last 168 hours" in data["data"]["analysis_period"]
E       fixture 'client' not found
>       available fixtures: _session_event_loop, _session_faker, admin_headers, anyio_backend, anyio_backend_name, anyio_backend_options, api_port, api_required, authority_headers, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cleanup_after_test, cov, doctest_namespace, ensure_pydantic_models_rebuilt, event_loop, event_loop_policy, faker, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, mock_auth_service, mock_services, monkeypatch, no_cover, observer_headers, pytestconfig, randomize_api_port, record_property, record_testsuite_property, record_xml_attribute, recwarn, root_headers, runtime, sample_incident, sample_insight, sample_problem, service_registry, skip_without_discord_token, tests/api/routes/test_incidents.py::<event_loop>, tests/api/routes/test_incidents.py::TestIncidentEndpoints::<event_loop>, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory
>       use 'pytest --fixtures [testpath]' for help on them.

/home/emoore/CIRISAgent/tests/api/routes/test_incidents.py:143
__________________________________________________ ERROR at setup of TestIncidentEndpoints.test_get_current_problems __________________________________________________
file /home/emoore/CIRISAgent/tests/api/routes/test_incidents.py, line 154
      async def test_get_current_problems(self, client, mock_services, sample_problem):
          """Test getting current problems."""
          response = await client.get("/v1/incidents/problems")
          assert response.status_code == 200

          data = response.json()
          assert data["success"] is True
          assert data["data"]["total"] == 0
          assert data["data"]["problems"] == []
          assert data["data"]["unresolved_count"] == 0
E       fixture 'client' not found
>       available fixtures: _session_event_loop, _session_faker, admin_headers, anyio_backend, anyio_backend_name, anyio_backend_options, api_port, api_required, authority_headers, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cleanup_after_test, cov, doctest_namespace, ensure_pydantic_models_rebuilt, event_loop, event_loop_policy, faker, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, mock_auth_service, mock_services, monkeypatch, no_cover, observer_headers, pytestconfig, randomize_api_port, record_property, record_testsuite_property, record_xml_attribute, recwarn, root_headers, runtime, sample_incident, sample_insight, sample_problem, service_registry, skip_without_discord_token, tests/api/routes/test_incidents.py::<event_loop>, tests/api/routes/test_incidents.py::TestIncidentEndpoints::<event_loop>, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory
>       use 'pytest --fixtures [testpath]' for help on them.

/home/emoore/CIRISAgent/tests/api/routes/test_incidents.py:154
_________________________________________________ ERROR at setup of TestIncidentEndpoints.test_get_incident_insights __________________________________________________
file /home/emoore/CIRISAgent/tests/api/routes/test_incidents.py, line 165
      async def test_get_incident_insights(self, client, mock_services, sample_insight):
          """Test getting incident insights."""
          response = await client.get("/v1/incidents/insights?days=7")
          assert response.status_code == 200

          data = response.json()
          assert data["success"] is True
          assert data["data"]["total"] == 0
          assert data["data"]["insights"] == []
          assert data["data"]["applied_count"] == 0
          assert data["data"]["effectiveness_avg"] is None
E       fixture 'client' not found
>       available fixtures: _session_event_loop, _session_faker, admin_headers, anyio_backend, anyio_backend_name, anyio_backend_options, api_port, api_required, authority_headers, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cleanup_after_test, cov, doctest_namespace, ensure_pydantic_models_rebuilt, event_loop, event_loop_policy, faker, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, mock_auth_service, mock_services, monkeypatch, no_cover, observer_headers, pytestconfig, randomize_api_port, record_property, record_testsuite_property, record_xml_attribute, recwarn, root_headers, runtime, sample_incident, sample_insight, sample_problem, service_registry, skip_without_discord_token, tests/api/routes/test_incidents.py::<event_loop>, tests/api/routes/test_incidents.py::TestIncidentEndpoints::<event_loop>, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory
>       use 'pytest --fixtures [testpath]' for help on them.

/home/emoore/CIRISAgent/tests/api/routes/test_incidents.py:165
____________________________________________ ERROR at setup of TestIncidentEndpoints.test_analyze_incidents_requires_admin ____________________________________________
file /home/emoore/CIRISAgent/tests/api/routes/test_incidents.py, line 177
      async def test_analyze_incidents_requires_admin(self, client, mock_services):
          """Test that analyze endpoint requires admin role."""
          # Test with observer token (should fail)
          headers = {"Authorization": "Bearer mock-observer-token"}
          response = await client.post(
              "/v1/incidents/analyze",
              json={"hours": 24},
              headers=headers
          )
          assert response.status_code == 403
E       fixture 'client' not found
>       available fixtures: _session_event_loop, _session_faker, admin_headers, anyio_backend, anyio_backend_name, anyio_backend_options, api_port, api_required, authority_headers, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cleanup_after_test, cov, doctest_namespace, ensure_pydantic_models_rebuilt, event_loop, event_loop_policy, faker, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, mock_auth_service, mock_services, monkeypatch, no_cover, observer_headers, pytestconfig, randomize_api_port, record_property, record_testsuite_property, record_xml_attribute, recwarn, root_headers, runtime, sample_incident, sample_insight, sample_problem, service_registry, skip_without_discord_token, tests/api/routes/test_incidents.py::<event_loop>, tests/api/routes/test_incidents.py::TestIncidentEndpoints::<event_loop>, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory
>       use 'pytest --fixtures [testpath]' for help on them.

/home/emoore/CIRISAgent/tests/api/routes/test_incidents.py:177
_______________________________________________ ERROR at setup of TestIncidentEndpoints.test_analyze_incidents_success ________________________________________________
file /home/emoore/CIRISAgent/tests/api/routes/test_incidents.py, line 188
      async def test_analyze_incidents_success(self, client, mock_services, sample_insight):
          """Test successful incident analysis."""
          mock_services["incident"].process_recent_incidents.return_value = sample_insight

          # Use admin token
          headers = {"Authorization": "Bearer mock-admin-token"}
          response = await client.post(
              "/v1/incidents/analyze",
              json={"hours": 24, "force": True},
              headers=headers
          )
          assert response.status_code == 200

          data = response.json()
          assert data["success"] is True
          assert data["data"]["id"] == "insight_001"
          assert data["data"]["insight_type"] == "PERIODIC_ANALYSIS"

          # Verify service was called
          mock_services["incident"].process_recent_incidents.assert_called_once_with(hours=24)
E       fixture 'client' not found
>       available fixtures: _session_event_loop, _session_faker, admin_headers, anyio_backend, anyio_backend_name, anyio_backend_options, api_port, api_required, authority_headers, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cleanup_after_test, cov, doctest_namespace, ensure_pydantic_models_rebuilt, event_loop, event_loop_policy, faker, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, mock_auth_service, mock_services, monkeypatch, no_cover, observer_headers, pytestconfig, randomize_api_port, record_property, record_testsuite_property, record_xml_attribute, recwarn, root_headers, runtime, sample_incident, sample_insight, sample_problem, service_registry, skip_without_discord_token, tests/api/routes/test_incidents.py::<event_loop>, tests/api/routes/test_incidents.py::TestIncidentEndpoints::<event_loop>, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory
>       use 'pytest --fixtures [testpath]' for help on them.

/home/emoore/CIRISAgent/tests/api/routes/test_incidents.py:188
__________________________________________________ ERROR at setup of TestIncidentEndpoints.test_get_recommendations ___________________________________________________
file /home/emoore/CIRISAgent/tests/api/routes/test_incidents.py, line 209
      async def test_get_recommendations(self, client, mock_services):
          """Test getting improvement recommendations."""
          response = await client.get("/v1/incidents/recommendations")
          assert response.status_code == 200

          data = response.json()
          assert data["success"] is True
          assert len(data["data"]["recommendations"]) == 2  # Default example has 2
          assert data["data"]["total_count"] == 4

          # Check example recommendation structure
          rec = data["data"]["recommendations"][0]
          assert rec["category"] == "Error Handling"
          assert rec["priority"] == "HIGH"
          assert len(rec["recommendations"]) == 2
          assert rec["rationale"] != ""
E       fixture 'client' not found
>       available fixtures: _session_event_loop, _session_faker, admin_headers, anyio_backend, anyio_backend_name, anyio_backend_options, api_port, api_required, authority_headers, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cleanup_after_test, cov, doctest_namespace, ensure_pydantic_models_rebuilt, event_loop, event_loop_policy, faker, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, mock_auth_service, mock_services, monkeypatch, no_cover, observer_headers, pytestconfig, randomize_api_port, record_property, record_testsuite_property, record_xml_attribute, recwarn, root_headers, runtime, sample_incident, sample_insight, sample_problem, service_registry, skip_without_discord_token, tests/api/routes/test_incidents.py::<event_loop>, tests/api/routes/test_incidents.py::TestIncidentEndpoints::<event_loop>, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory
>       use 'pytest --fixtures [testpath]' for help on them.

/home/emoore/CIRISAgent/tests/api/routes/test_incidents.py:209
__________________________________________________ ERROR at setup of TestIncidentEndpoints.test_service_unavailable ___________________________________________________
file /home/emoore/CIRISAgent/tests/api/routes/test_incidents.py, line 226
      async def test_service_unavailable(self, client, app):
          """Test when incident service is not available."""
          # Remove service
          app.state.incident_management_service = None

          response = await client.get("/v1/incidents")
          assert response.status_code == 503
          assert "Incident management service not available" in response.json()["detail"]
E       fixture 'client' not found
>       available fixtures: _session_event_loop, _session_faker, admin_headers, anyio_backend, anyio_backend_name, anyio_backend_options, api_port, api_required, authority_headers, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cleanup_after_test, cov, doctest_namespace, ensure_pydantic_models_rebuilt, event_loop, event_loop_policy, faker, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, mock_auth_service, mock_services, monkeypatch, no_cover, observer_headers, pytestconfig, randomize_api_port, record_property, record_testsuite_property, record_xml_attribute, recwarn, root_headers, runtime, sample_incident, sample_insight, sample_problem, service_registry, skip_without_discord_token, tests/api/routes/test_incidents.py::<event_loop>, tests/api/routes/test_incidents.py::TestIncidentEndpoints::<event_loop>, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory
>       use 'pytest --fixtures [testpath]' for help on them.

/home/emoore/CIRISAgent/tests/api/routes/test_incidents.py:226
_______________________________________________ ERROR at setup of TestIncidentEndpoints.test_memory_service_unavailable _______________________________________________
file /home/emoore/CIRISAgent/tests/api/routes/test_incidents.py, line 235
      async def test_memory_service_unavailable(self, client, app, mock_services):
          """Test when memory service is not available."""
          # Remove memory service
          app.state.memory_service = None

          response = await client.get("/v1/incidents/incident_001")
          assert response.status_code == 503
          assert "Memory service not available" in response.json()["detail"]
E       fixture 'client' not found
>       available fixtures: _session_event_loop, _session_faker, admin_headers, anyio_backend, anyio_backend_name, anyio_backend_options, api_port, api_required, authority_headers, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cleanup_after_test, cov, doctest_namespace, ensure_pydantic_models_rebuilt, event_loop, event_loop_policy, faker, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, mock_auth_service, mock_services, monkeypatch, no_cover, observer_headers, pytestconfig, randomize_api_port, record_property, record_testsuite_property, record_xml_attribute, recwarn, root_headers, runtime, sample_incident, sample_insight, sample_problem, service_registry, skip_without_discord_token, tests/api/routes/test_incidents.py::<event_loop>, tests/api/routes/test_incidents.py::TestIncidentEndpoints::<event_loop>, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory
>       use 'pytest --fixtures [testpath]' for help on them.

/home/emoore/CIRISAgent/tests/api/routes/test_incidents.py:235
______________________________________________ ERROR at setup of TestIncidentEndpoints.test_query_parameters_validation _______________________________________________
file /home/emoore/CIRISAgent/tests/api/routes/test_incidents.py, line 244
      async def test_query_parameters_validation(self, client, mock_services):
          """Test query parameter validation."""
          # Test hours validation
          response = await client.get("/v1/incidents?hours=200")  # Over max
          assert response.status_code == 422

          response = await client.get("/v1/incidents?hours=0")  # Under min
          assert response.status_code == 422

          # Test analyze hours validation
          headers = {"Authorization": "Bearer mock-admin-token"}
          response = await client.post(
              "/v1/incidents/analyze",
              json={"hours": 200},  # Over max
              headers=headers
          )
          assert response.status_code == 422
E       fixture 'client' not found
>       available fixtures: _session_event_loop, _session_faker, admin_headers, anyio_backend, anyio_backend_name, anyio_backend_options, api_port, api_required, authority_headers, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cleanup_after_test, cov, doctest_namespace, ensure_pydantic_models_rebuilt, event_loop, event_loop_policy, faker, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, mock_auth_service, mock_services, monkeypatch, no_cover, observer_headers, pytestconfig, randomize_api_port, record_property, record_testsuite_property, record_xml_attribute, recwarn, root_headers, runtime, sample_incident, sample_insight, sample_problem, service_registry, skip_without_discord_token, tests/api/routes/test_incidents.py::<event_loop>, tests/api/routes/test_incidents.py::TestIncidentEndpoints::<event_loop>, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory
>       use 'pytest --fixtures [testpath]' for help on them.

/home/emoore/CIRISAgent/tests/api/routes/test_incidents.py:244
___________________________________________________ ERROR at setup of TestIncidentEndpoints.test_filter_parameters ____________________________________________________
file /home/emoore/CIRISAgent/tests/api/routes/test_incidents.py, line 262
      async def test_filter_parameters(self, client, mock_services):
          """Test filter parameters are accepted."""
          # Test incident filters
          response = await client.get("/v1/incidents?severity=HIGH&status=OPEN&component=DatabaseService")
          assert response.status_code == 200

          # Test problem filters
          response = await client.get("/v1/incidents/problems?status=RESOLVED&min_incidents=5")
          assert response.status_code == 200

          # Test recommendation filters
          response = await client.get("/v1/incidents/recommendations?priority=HIGH&category=Performance")
          assert response.status_code == 200
E       fixture 'client' not found
>       available fixtures: _session_event_loop, _session_faker, admin_headers, anyio_backend, anyio_backend_name, anyio_backend_options, api_port, api_required, authority_headers, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cleanup_after_test, cov, doctest_namespace, ensure_pydantic_models_rebuilt, event_loop, event_loop_policy, faker, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, mock_auth_service, mock_services, monkeypatch, no_cover, observer_headers, pytestconfig, randomize_api_port, record_property, record_testsuite_property, record_xml_attribute, recwarn, root_headers, runtime, sample_incident, sample_insight, sample_problem, service_registry, skip_without_discord_token, tests/api/routes/test_incidents.py::<event_loop>, tests/api/routes/test_incidents.py::TestIncidentEndpoints::<event_loop>, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory
>       use 'pytest --fixtures [testpath]' for help on them.

/home/emoore/CIRISAgent/tests/api/routes/test_incidents.py:262
_____________________________________________ ERROR at setup of TestSchedulerEndpoints.test_list_scheduled_tasks_success ______________________________________________
file /home/emoore/CIRISAgent/tests/api/routes/test_scheduler.py, line 109
      def test_list_scheduled_tasks_success(self, app_with_scheduler, mock_scheduler_service,
E       fixture 'mock_observer_auth' not found
>       available fixtures: _session_event_loop, _session_faker, admin_headers, anyio_backend, anyio_backend_name, anyio_backend_options, api_port, api_required, app_with_scheduler, authority_headers, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cleanup_after_test, cov, doctest_namespace, ensure_pydantic_models_rebuilt, event_loop, event_loop_policy, faker, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, mock_auth_service, mock_scheduler_service, mock_time_service, monkeypatch, no_cover, observer_headers, pytestconfig, randomize_api_port, record_property, record_testsuite_property, record_xml_attribute, recwarn, root_headers, runtime, sample_recurring_task_info, sample_scheduled_task, sample_scheduled_task_info, service_registry, skip_without_discord_token, tests/api/routes/test_scheduler.py::<event_loop>, tests/api/routes/test_scheduler.py::TestSchedulerEndpoints::<event_loop>, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory
>       use 'pytest --fixtures [testpath]' for help on them.

/home/emoore/CIRISAgent/tests/api/routes/test_scheduler.py:109
___________________________________________ ERROR at setup of TestSchedulerEndpoints.test_list_scheduled_tasks_with_filter ____________________________________________
file /home/emoore/CIRISAgent/tests/api/routes/test_scheduler.py, line 136
      def test_list_scheduled_tasks_with_filter(self, app_with_scheduler, mock_scheduler_service,
E       fixture 'mock_observer_auth' not found
>       available fixtures: _session_event_loop, _session_faker, admin_headers, anyio_backend, anyio_backend_name, anyio_backend_options, api_port, api_required, app_with_scheduler, authority_headers, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cleanup_after_test, cov, doctest_namespace, ensure_pydantic_models_rebuilt, event_loop, event_loop_policy, faker, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, mock_auth_service, mock_scheduler_service, mock_time_service, monkeypatch, no_cover, observer_headers, pytestconfig, randomize_api_port, record_property, record_testsuite_property, record_xml_attribute, recwarn, root_headers, runtime, sample_recurring_task_info, sample_scheduled_task, sample_scheduled_task_info, service_registry, skip_without_discord_token, tests/api/routes/test_scheduler.py::<event_loop>, tests/api/routes/test_scheduler.py::TestSchedulerEndpoints::<event_loop>, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory
>       use 'pytest --fixtures [testpath]' for help on them.

/home/emoore/CIRISAgent/tests/api/routes/test_scheduler.py:136
____________________________________________ ERROR at setup of TestSchedulerEndpoints.test_list_scheduled_tasks_pagination ____________________________________________
file /home/emoore/CIRISAgent/tests/api/routes/test_scheduler.py, line 159
      def test_list_scheduled_tasks_pagination(self, app_with_scheduler, mock_scheduler_service,
E       fixture 'mock_observer_auth' not found
>       available fixtures: _session_event_loop, _session_faker, admin_headers, anyio_backend, anyio_backend_name, anyio_backend_options, api_port, api_required, app_with_scheduler, authority_headers, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cleanup_after_test, cov, doctest_namespace, ensure_pydantic_models_rebuilt, event_loop, event_loop_policy, faker, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, mock_auth_service, mock_scheduler_service, mock_time_service, monkeypatch, no_cover, observer_headers, pytestconfig, randomize_api_port, record_property, record_testsuite_property, record_xml_attribute, recwarn, root_headers, runtime, sample_recurring_task_info, sample_scheduled_task, sample_scheduled_task_info, service_registry, skip_without_discord_token, tests/api/routes/test_scheduler.py::<event_loop>, tests/api/routes/test_scheduler.py::TestSchedulerEndpoints::<event_loop>, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory
>       use 'pytest --fixtures [testpath]' for help on them.

/home/emoore/CIRISAgent/tests/api/routes/test_scheduler.py:159
____________________________________________ ERROR at setup of TestSchedulerEndpoints.test_list_scheduled_tasks_no_service ____________________________________________
file /home/emoore/CIRISAgent/tests/api/routes/test_scheduler.py, line 179
      def test_list_scheduled_tasks_no_service(self, app_with_scheduler, mock_observer_auth):
E       fixture 'mock_observer_auth' not found
>       available fixtures: _session_event_loop, _session_faker, admin_headers, anyio_backend, anyio_backend_name, anyio_backend_options, api_port, api_required, app_with_scheduler, authority_headers, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cleanup_after_test, cov, doctest_namespace, ensure_pydantic_models_rebuilt, event_loop, event_loop_policy, faker, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, mock_auth_service, mock_scheduler_service, mock_time_service, monkeypatch, no_cover, observer_headers, pytestconfig, randomize_api_port, record_property, record_testsuite_property, record_xml_attribute, recwarn, root_headers, runtime, sample_recurring_task_info, sample_scheduled_task, sample_scheduled_task_info, service_registry, skip_without_discord_token, tests/api/routes/test_scheduler.py::<event_loop>, tests/api/routes/test_scheduler.py::TestSchedulerEndpoints::<event_loop>, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory
>       use 'pytest --fixtures [testpath]' for help on them.

/home/emoore/CIRISAgent/tests/api/routes/test_scheduler.py:179
_______________________________________________ ERROR at setup of TestSchedulerEndpoints.test_get_task_details_success ________________________________________________
file /home/emoore/CIRISAgent/tests/api/routes/test_scheduler.py, line 195
      def test_get_task_details_success(self, app_with_scheduler, mock_scheduler_service,
E       fixture 'mock_observer_auth' not found
>       available fixtures: _session_event_loop, _session_faker, admin_headers, anyio_backend, anyio_backend_name, anyio_backend_options, api_port, api_required, app_with_scheduler, authority_headers, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cleanup_after_test, cov, doctest_namespace, ensure_pydantic_models_rebuilt, event_loop, event_loop_policy, faker, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, mock_auth_service, mock_scheduler_service, mock_time_service, monkeypatch, no_cover, observer_headers, pytestconfig, randomize_api_port, record_property, record_testsuite_property, record_xml_attribute, recwarn, root_headers, runtime, sample_recurring_task_info, sample_scheduled_task, sample_scheduled_task_info, service_registry, skip_without_discord_token, tests/api/routes/test_scheduler.py::<event_loop>, tests/api/routes/test_scheduler.py::TestSchedulerEndpoints::<event_loop>, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory
>       use 'pytest --fixtures [testpath]' for help on them.

/home/emoore/CIRISAgent/tests/api/routes/test_scheduler.py:195
______________________________________________ ERROR at setup of TestSchedulerEndpoints.test_get_task_details_not_found _______________________________________________
file /home/emoore/CIRISAgent/tests/api/routes/test_scheduler.py, line 216
      def test_get_task_details_not_found(self, app_with_scheduler, mock_scheduler_service,
E       fixture 'mock_observer_auth' not found
>       available fixtures: _session_event_loop, _session_faker, admin_headers, anyio_backend, anyio_backend_name, anyio_backend_options, api_port, api_required, app_with_scheduler, authority_headers, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cleanup_after_test, cov, doctest_namespace, ensure_pydantic_models_rebuilt, event_loop, event_loop_policy, faker, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, mock_auth_service, mock_scheduler_service, mock_time_service, monkeypatch, no_cover, observer_headers, pytestconfig, randomize_api_port, record_property, record_testsuite_property, record_xml_attribute, recwarn, root_headers, runtime, sample_recurring_task_info, sample_scheduled_task, sample_scheduled_task_info, service_registry, skip_without_discord_token, tests/api/routes/test_scheduler.py::<event_loop>, tests/api/routes/test_scheduler.py::TestSchedulerEndpoints::<event_loop>, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory
>       use 'pytest --fixtures [testpath]' for help on them.

/home/emoore/CIRISAgent/tests/api/routes/test_scheduler.py:216
_____________________________________________ ERROR at setup of TestSchedulerEndpoints.test_create_scheduled_task_success _____________________________________________
file /home/emoore/CIRISAgent/tests/api/routes/test_scheduler.py, line 233
      def test_create_scheduled_task_success(self, app_with_scheduler, mock_scheduler_service,
E       fixture 'mock_admin_auth' not found
>       available fixtures: _session_event_loop, _session_faker, admin_headers, anyio_backend, anyio_backend_name, anyio_backend_options, api_port, api_required, app_with_scheduler, authority_headers, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cleanup_after_test, cov, doctest_namespace, ensure_pydantic_models_rebuilt, event_loop, event_loop_policy, faker, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, mock_auth_service, mock_scheduler_service, mock_time_service, monkeypatch, no_cover, observer_headers, pytestconfig, randomize_api_port, record_property, record_testsuite_property, record_xml_attribute, recwarn, root_headers, runtime, sample_recurring_task_info, sample_scheduled_task, sample_scheduled_task_info, service_registry, skip_without_discord_token, tests/api/routes/test_scheduler.py::<event_loop>, tests/api/routes/test_scheduler.py::TestSchedulerEndpoints::<event_loop>, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory
>       use 'pytest --fixtures [testpath]' for help on them.

/home/emoore/CIRISAgent/tests/api/routes/test_scheduler.py:233
______________________________________________ ERROR at setup of TestSchedulerEndpoints.test_create_scheduled_task_cron _______________________________________________
file /home/emoore/CIRISAgent/tests/api/routes/test_scheduler.py, line 266
      def test_create_scheduled_task_cron(self, app_with_scheduler, mock_scheduler_service,
E       fixture 'mock_admin_auth' not found
>       available fixtures: _session_event_loop, _session_faker, admin_headers, anyio_backend, anyio_backend_name, anyio_backend_options, api_port, api_required, app_with_scheduler, authority_headers, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cleanup_after_test, cov, doctest_namespace, ensure_pydantic_models_rebuilt, event_loop, event_loop_policy, faker, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, mock_auth_service, mock_scheduler_service, mock_time_service, monkeypatch, no_cover, observer_headers, pytestconfig, randomize_api_port, record_property, record_testsuite_property, record_xml_attribute, recwarn, root_headers, runtime, sample_recurring_task_info, sample_scheduled_task, sample_scheduled_task_info, service_registry, skip_without_discord_token, tests/api/routes/test_scheduler.py::<event_loop>, tests/api/routes/test_scheduler.py::TestSchedulerEndpoints::<event_loop>, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory
>       use 'pytest --fixtures [testpath]' for help on them.

/home/emoore/CIRISAgent/tests/api/routes/test_scheduler.py:266
________________________________________ ERROR at setup of TestSchedulerEndpoints.test_create_scheduled_task_missing_schedule _________________________________________
file /home/emoore/CIRISAgent/tests/api/routes/test_scheduler.py, line 296
      def test_create_scheduled_task_missing_schedule(self, app_with_scheduler, mock_admin_auth):
E       fixture 'mock_admin_auth' not found
>       available fixtures: _session_event_loop, _session_faker, admin_headers, anyio_backend, anyio_backend_name, anyio_backend_options, api_port, api_required, app_with_scheduler, authority_headers, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cleanup_after_test, cov, doctest_namespace, ensure_pydantic_models_rebuilt, event_loop, event_loop_policy, faker, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, mock_auth_service, mock_scheduler_service, mock_time_service, monkeypatch, no_cover, observer_headers, pytestconfig, randomize_api_port, record_property, record_testsuite_property, record_xml_attribute, recwarn, root_headers, runtime, sample_recurring_task_info, sample_scheduled_task, sample_scheduled_task_info, service_registry, skip_without_discord_token, tests/api/routes/test_scheduler.py::<event_loop>, tests/api/routes/test_scheduler.py::TestSchedulerEndpoints::<event_loop>, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory
>       use 'pytest --fixtures [testpath]' for help on them.

/home/emoore/CIRISAgent/tests/api/routes/test_scheduler.py:296
__________________________________________ ERROR at setup of TestSchedulerEndpoints.test_create_scheduled_task_invalid_cron ___________________________________________
file /home/emoore/CIRISAgent/tests/api/routes/test_scheduler.py, line 318
      def test_create_scheduled_task_invalid_cron(self, app_with_scheduler, mock_scheduler_service,
E       fixture 'mock_admin_auth' not found
>       available fixtures: _session_event_loop, _session_faker, admin_headers, anyio_backend, anyio_backend_name, anyio_backend_options, api_port, api_required, app_with_scheduler, authority_headers, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cleanup_after_test, cov, doctest_namespace, ensure_pydantic_models_rebuilt, event_loop, event_loop_policy, faker, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, mock_auth_service, mock_scheduler_service, mock_time_service, monkeypatch, no_cover, observer_headers, pytestconfig, randomize_api_port, record_property, record_testsuite_property, record_xml_attribute, recwarn, root_headers, runtime, sample_recurring_task_info, sample_scheduled_task, sample_scheduled_task_info, service_registry, skip_without_discord_token, tests/api/routes/test_scheduler.py::<event_loop>, tests/api/routes/test_scheduler.py::TestSchedulerEndpoints::<event_loop>, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory
>       use 'pytest --fixtures [testpath]' for help on them.

/home/emoore/CIRISAgent/tests/api/routes/test_scheduler.py:318
_____________________________________________ ERROR at setup of TestSchedulerEndpoints.test_cancel_scheduled_task_success _____________________________________________
file /home/emoore/CIRISAgent/tests/api/routes/test_scheduler.py, line 345
      def test_cancel_scheduled_task_success(self, app_with_scheduler, mock_scheduler_service,
E       fixture 'mock_admin_auth' not found
>       available fixtures: _session_event_loop, _session_faker, admin_headers, anyio_backend, anyio_backend_name, anyio_backend_options, api_port, api_required, app_with_scheduler, authority_headers, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cleanup_after_test, cov, doctest_namespace, ensure_pydantic_models_rebuilt, event_loop, event_loop_policy, faker, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, mock_auth_service, mock_scheduler_service, mock_time_service, monkeypatch, no_cover, observer_headers, pytestconfig, randomize_api_port, record_property, record_testsuite_property, record_xml_attribute, recwarn, root_headers, runtime, sample_recurring_task_info, sample_scheduled_task, sample_scheduled_task_info, service_registry, skip_without_discord_token, tests/api/routes/test_scheduler.py::<event_loop>, tests/api/routes/test_scheduler.py::TestSchedulerEndpoints::<event_loop>, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory
>       use 'pytest --fixtures [testpath]' for help on them.

/home/emoore/CIRISAgent/tests/api/routes/test_scheduler.py:345
____________________________________________ ERROR at setup of TestSchedulerEndpoints.test_cancel_scheduled_task_not_found ____________________________________________
file /home/emoore/CIRISAgent/tests/api/routes/test_scheduler.py, line 368
      def test_cancel_scheduled_task_not_found(self, app_with_scheduler, mock_scheduler_service,
E       fixture 'mock_admin_auth' not found
>       available fixtures: _session_event_loop, _session_faker, admin_headers, anyio_backend, anyio_backend_name, anyio_backend_options, api_port, api_required, app_with_scheduler, authority_headers, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cleanup_after_test, cov, doctest_namespace, ensure_pydantic_models_rebuilt, event_loop, event_loop_policy, faker, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, mock_auth_service, mock_scheduler_service, mock_time_service, monkeypatch, no_cover, observer_headers, pytestconfig, randomize_api_port, record_property, record_testsuite_property, record_xml_attribute, recwarn, root_headers, runtime, sample_recurring_task_info, sample_scheduled_task, sample_scheduled_task_info, service_registry, skip_without_discord_token, tests/api/routes/test_scheduler.py::<event_loop>, tests/api/routes/test_scheduler.py::TestSchedulerEndpoints::<event_loop>, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory
>       use 'pytest --fixtures [testpath]' for help on them.

/home/emoore/CIRISAgent/tests/api/routes/test_scheduler.py:368
_____________________________________________ ERROR at setup of TestSchedulerEndpoints.test_get_execution_history_success _____________________________________________
file /home/emoore/CIRISAgent/tests/api/routes/test_scheduler.py, line 385
      def test_get_execution_history_success(self, app_with_scheduler, mock_scheduler_service,
E       fixture 'mock_observer_auth' not found
>       available fixtures: _session_event_loop, _session_faker, admin_headers, anyio_backend, anyio_backend_name, anyio_backend_options, api_port, api_required, app_with_scheduler, authority_headers, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cleanup_after_test, cov, doctest_namespace, ensure_pydantic_models_rebuilt, event_loop, event_loop_policy, faker, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, mock_auth_service, mock_scheduler_service, mock_time_service, monkeypatch, no_cover, observer_headers, pytestconfig, randomize_api_port, record_property, record_testsuite_property, record_xml_attribute, recwarn, root_headers, runtime, sample_recurring_task_info, sample_scheduled_task, sample_scheduled_task_info, service_registry, skip_without_discord_token, tests/api/routes/test_scheduler.py::<event_loop>, tests/api/routes/test_scheduler.py::TestSchedulerEndpoints::<event_loop>, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory
>       use 'pytest --fixtures [testpath]' for help on them.

/home/emoore/CIRISAgent/tests/api/routes/test_scheduler.py:385
____________________________________________ ERROR at setup of TestSchedulerEndpoints.test_get_execution_history_filtered _____________________________________________
file /home/emoore/CIRISAgent/tests/api/routes/test_scheduler.py, line 406
      def test_get_execution_history_filtered(self, app_with_scheduler, mock_scheduler_service,
E       fixture 'mock_observer_auth' not found
>       available fixtures: _session_event_loop, _session_faker, admin_headers, anyio_backend, anyio_backend_name, anyio_backend_options, api_port, api_required, app_with_scheduler, authority_headers, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cleanup_after_test, cov, doctest_namespace, ensure_pydantic_models_rebuilt, event_loop, event_loop_policy, faker, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, mock_auth_service, mock_scheduler_service, mock_time_service, monkeypatch, no_cover, observer_headers, pytestconfig, randomize_api_port, record_property, record_testsuite_property, record_xml_attribute, recwarn, root_headers, runtime, sample_recurring_task_info, sample_scheduled_task, sample_scheduled_task_info, service_registry, skip_without_discord_token, tests/api/routes/test_scheduler.py::<event_loop>, tests/api/routes/test_scheduler.py::TestSchedulerEndpoints::<event_loop>, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory
>       use 'pytest --fixtures [testpath]' for help on them.

/home/emoore/CIRISAgent/tests/api/routes/test_scheduler.py:406
____________________________________________ ERROR at setup of TestSchedulerEndpoints.test_get_upcoming_executions_success ____________________________________________
file /home/emoore/CIRISAgent/tests/api/routes/test_scheduler.py, line 434
      def test_get_upcoming_executions_success(self, app_with_scheduler, mock_scheduler_service,
E       fixture 'mock_observer_auth' not found
>       available fixtures: _session_event_loop, _session_faker, admin_headers, anyio_backend, anyio_backend_name, anyio_backend_options, api_port, api_required, app_with_scheduler, authority_headers, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cleanup_after_test, cov, doctest_namespace, ensure_pydantic_models_rebuilt, event_loop, event_loop_policy, faker, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, mock_auth_service, mock_scheduler_service, mock_time_service, monkeypatch, no_cover, observer_headers, pytestconfig, randomize_api_port, record_property, record_testsuite_property, record_xml_attribute, recwarn, root_headers, runtime, sample_recurring_task_info, sample_scheduled_task, sample_scheduled_task_info, service_registry, skip_without_discord_token, tests/api/routes/test_scheduler.py::<event_loop>, tests/api/routes/test_scheduler.py::TestSchedulerEndpoints::<event_loop>, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory
>       use 'pytest --fixtures [testpath]' for help on them.

/home/emoore/CIRISAgent/tests/api/routes/test_scheduler.py:434
_________________________________________________ ERROR at setup of TestSchedulerEndpoints.test_admin_only_endpoints __________________________________________________
file /home/emoore/CIRISAgent/tests/api/routes/test_scheduler.py, line 486
      def test_admin_only_endpoints(self, app_with_scheduler, mock_observer_auth):
E       fixture 'mock_observer_auth' not found
>       available fixtures: _session_event_loop, _session_faker, admin_headers, anyio_backend, anyio_backend_name, anyio_backend_options, api_port, api_required, app_with_scheduler, authority_headers, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cleanup_after_test, cov, doctest_namespace, ensure_pydantic_models_rebuilt, event_loop, event_loop_policy, faker, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, mock_auth_service, mock_scheduler_service, mock_time_service, monkeypatch, no_cover, observer_headers, pytestconfig, randomize_api_port, record_property, record_testsuite_property, record_xml_attribute, recwarn, root_headers, runtime, sample_recurring_task_info, sample_scheduled_task, sample_scheduled_task_info, service_registry, skip_without_discord_token, tests/api/routes/test_scheduler.py::<event_loop>, tests/api/routes/test_scheduler.py::TestSchedulerEndpoints::<event_loop>, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory
>       use 'pytest --fixtures [testpath]' for help on them.

/home/emoore/CIRISAgent/tests/api/routes/test_scheduler.py:486
____________________________________________________ ERROR at setup of TestGetDeferrals.test_get_deferrals_success ____________________________________________________
tests/api/routes/test_wa.py:63: in observer_auth
    permissions={Permission.VIEW_LOGS, Permission.VIEW_MEMORY},
E   AttributeError: type object 'Permission' has no attribute 'VIEW_LOGS'. Did you mean: 'VIEW_TOOLS'?
___________________________________________________ ERROR at setup of TestGetDeferrals.test_get_deferrals_filtered ____________________________________________________
tests/api/routes/test_wa.py:63: in observer_auth
    permissions={Permission.VIEW_LOGS, Permission.VIEW_MEMORY},
E   AttributeError: type object 'Permission' has no attribute 'VIEW_LOGS'. Did you mean: 'VIEW_TOOLS'?
______________________________________________ ERROR at setup of TestGetDeferralDetail.test_get_deferral_detail_success _______________________________________________
tests/api/routes/test_wa.py:63: in observer_auth
    permissions={Permission.VIEW_LOGS, Permission.VIEW_MEMORY},
E   AttributeError: type object 'Permission' has no attribute 'VIEW_LOGS'. Did you mean: 'VIEW_TOOLS'?
_____________________________________________ ERROR at setup of TestGetDeferralDetail.test_get_deferral_detail_not_found ______________________________________________
tests/api/routes/test_wa.py:63: in observer_auth
    permissions={Permission.VIEW_LOGS, Permission.VIEW_MEMORY},
E   AttributeError: type object 'Permission' has no attribute 'VIEW_LOGS'. Did you mean: 'VIEW_TOOLS'?
_________________________________________________ ERROR at setup of TestResolveDeferral.test_resolve_deferral_approve _________________________________________________
tests/api/routes/test_wa.py:76: in authority_auth
    Permission.VIEW_LOGS,
E   AttributeError: type object 'Permission' has no attribute 'VIEW_LOGS'. Did you mean: 'VIEW_TOOLS'?
_________________________________________________ ERROR at setup of TestResolveDeferral.test_resolve_deferral_reject __________________________________________________
tests/api/routes/test_wa.py:76: in authority_auth
    Permission.VIEW_LOGS,
E   AttributeError: type object 'Permission' has no attribute 'VIEW_LOGS'. Did you mean: 'VIEW_TOOLS'?
________________________________________ ERROR at setup of TestResolveDeferral.test_resolve_deferral_insufficient_permissions _________________________________________
tests/api/routes/test_wa.py:63: in observer_auth
    permissions={Permission.VIEW_LOGS, Permission.VIEW_MEMORY},
E   AttributeError: type object 'Permission' has no attribute 'VIEW_LOGS'. Did you mean: 'VIEW_TOOLS'?
_________________________________________________ ERROR at setup of TestRequestGuidance.test_request_guidance_success _________________________________________________
tests/api/routes/test_wa.py:63: in observer_auth
    permissions={Permission.VIEW_LOGS, Permission.VIEW_MEMORY},
E   AttributeError: type object 'Permission' has no attribute 'VIEW_LOGS'. Did you mean: 'VIEW_TOOLS'?
_______________________________________________________ ERROR at setup of TestPermissions.test_get_permissions ________________________________________________________
tests/api/routes/test_wa.py:63: in observer_auth
    permissions={Permission.VIEW_LOGS, Permission.VIEW_MEMORY},
E   AttributeError: type object 'Permission' has no attribute 'VIEW_LOGS'. Did you mean: 'VIEW_TOOLS'?
_______________________________________________________ ERROR at setup of TestPermissions.test_grant_permission _______________________________________________________
tests/api/routes/test_wa.py:76: in authority_auth
    Permission.VIEW_LOGS,
E   AttributeError: type object 'Permission' has no attribute 'VIEW_LOGS'. Did you mean: 'VIEW_TOOLS'?
______________________________________________________ ERROR at setup of TestPermissions.test_revoke_permission _______________________________________________________
tests/api/routes/test_wa.py:76: in authority_auth
    Permission.VIEW_LOGS,
E   AttributeError: type object 'Permission' has no attribute 'VIEW_LOGS'. Did you mean: 'VIEW_TOOLS'?
________________________________________________________ ERROR at setup of TestAgentProcessor.test_initialize _________________________________________________________
tests/ciris_engine/logic/processors/core/test_main_processor.py:92: in main_processor
    processor = AgentProcessor(
ciris_engine/logic/processors/core/main_processor.py:79: in __init__
    self.wakeup_processor = WakeupProcessor(
ciris_engine/logic/processors/states/wakeup_processor.py:60: in __init__
    super().__init__(*args, **kwargs)
ciris_engine/logic/processors/core/base_processor.py:50: in __init__
    raise ValueError("resource_monitor is required for processors")
E   ValueError: resource_monitor is required for processors
_____________________________________________________ ERROR at setup of TestAgentProcessor.test_start_processing ______________________________________________________
tests/ciris_engine/logic/processors/core/test_main_processor.py:92: in main_processor
    processor = AgentProcessor(
ciris_engine/logic/processors/core/main_processor.py:79: in __init__
    self.wakeup_processor = WakeupProcessor(
ciris_engine/logic/processors/states/wakeup_processor.py:60: in __init__
    super().__init__(*args, **kwargs)
ciris_engine/logic/processors/core/base_processor.py:50: in __init__
    raise ValueError("resource_monitor is required for processors")
E   ValueError: resource_monitor is required for processors
___________________________________________________ ERROR at setup of TestAgentProcessor.test_process_single_round ____________________________________________________
tests/ciris_engine/logic/processors/core/test_main_processor.py:92: in main_processor
    processor = AgentProcessor(
ciris_engine/logic/processors/core/main_processor.py:79: in __init__
    self.wakeup_processor = WakeupProcessor(
ciris_engine/logic/processors/states/wakeup_processor.py:60: in __init__
    super().__init__(*args, **kwargs)
ciris_engine/logic/processors/core/base_processor.py:50: in __init__
    raise ValueError("resource_monitor is required for processors")
E   ValueError: resource_monitor is required for processors
_____________________________________________________ ERROR at setup of TestAgentProcessor.test_state_transition ______________________________________________________
tests/ciris_engine/logic/processors/core/test_main_processor.py:92: in main_processor
    processor = AgentProcessor(
ciris_engine/logic/processors/core/main_processor.py:79: in __init__
    self.wakeup_processor = WakeupProcessor(
ciris_engine/logic/processors/states/wakeup_processor.py:60: in __init__
    super().__init__(*args, **kwargs)
ciris_engine/logic/processors/core/base_processor.py:50: in __init__
    raise ValueError("resource_monitor is required for processors")
E   ValueError: resource_monitor is required for processors
__________________________________________________ ERROR at setup of TestAgentProcessor.test_handle_processor_error ___________________________________________________
tests/ciris_engine/logic/processors/core/test_main_processor.py:92: in main_processor
    processor = AgentProcessor(
ciris_engine/logic/processors/core/main_processor.py:79: in __init__
    self.wakeup_processor = WakeupProcessor(
ciris_engine/logic/processors/states/wakeup_processor.py:60: in __init__
    super().__init__(*args, **kwargs)
ciris_engine/logic/processors/core/base_processor.py:50: in __init__
    raise ValueError("resource_monitor is required for processors")
E   ValueError: resource_monitor is required for processors
__________________________________________________ ERROR at setup of TestAgentProcessor.test_max_consecutive_errors ___________________________________________________
tests/ciris_engine/logic/processors/core/test_main_processor.py:92: in main_processor
    processor = AgentProcessor(
ciris_engine/logic/processors/core/main_processor.py:79: in __init__
    self.wakeup_processor = WakeupProcessor(
ciris_engine/logic/processors/states/wakeup_processor.py:60: in __init__
    super().__init__(*args, **kwargs)
ciris_engine/logic/processors/core/base_processor.py:50: in __init__
    raise ValueError("resource_monitor is required for processors")
E   ValueError: resource_monitor is required for processors
_______________________________________________________ ERROR at setup of TestAgentProcessor.test_round_timeout _______________________________________________________
tests/ciris_engine/logic/processors/core/test_main_processor.py:92: in main_processor
    processor = AgentProcessor(
ciris_engine/logic/processors/core/main_processor.py:79: in __init__
    self.wakeup_processor = WakeupProcessor(
ciris_engine/logic/processors/states/wakeup_processor.py:60: in __init__
    super().__init__(*args, **kwargs)
ciris_engine/logic/processors/core/base_processor.py:50: in __init__
    raise ValueError("resource_monitor is required for processors")
E   ValueError: resource_monitor is required for processors
______________________________________________________ ERROR at setup of TestAgentProcessor.test_stop_processing ______________________________________________________
tests/ciris_engine/logic/processors/core/test_main_processor.py:92: in main_processor
    processor = AgentProcessor(
ciris_engine/logic/processors/core/main_processor.py:79: in __init__
    self.wakeup_processor = WakeupProcessor(
ciris_engine/logic/processors/states/wakeup_processor.py:60: in __init__
    super().__init__(*args, **kwargs)
ciris_engine/logic/processors/core/base_processor.py:50: in __init__
    raise ValueError("resource_monitor is required for processors")
E   ValueError: resource_monitor is required for processors
______________________________________________________ ERROR at setup of TestAgentProcessor.test_emergency_stop _______________________________________________________
tests/ciris_engine/logic/processors/core/test_main_processor.py:92: in main_processor
    processor = AgentProcessor(
ciris_engine/logic/processors/core/main_processor.py:79: in __init__
    self.wakeup_processor = WakeupProcessor(
ciris_engine/logic/processors/states/wakeup_processor.py:60: in __init__
    super().__init__(*args, **kwargs)
ciris_engine/logic/processors/core/base_processor.py:50: in __init__
    raise ValueError("resource_monitor is required for processors")
E   ValueError: resource_monitor is required for processors
_____________________________________________________ ERROR at setup of TestAgentProcessor.test_get_current_state _____________________________________________________
tests/ciris_engine/logic/processors/core/test_main_processor.py:92: in main_processor
    processor = AgentProcessor(
ciris_engine/logic/processors/core/main_processor.py:79: in __init__
    self.wakeup_processor = WakeupProcessor(
ciris_engine/logic/processors/states/wakeup_processor.py:60: in __init__
    super().__init__(*args, **kwargs)
ciris_engine/logic/processors/core/base_processor.py:50: in __init__
    raise ValueError("resource_monitor is required for processors")
E   ValueError: resource_monitor is required for processors
_____________________________________________________ ERROR at setup of TestAgentProcessor.test_get_state_history _____________________________________________________
tests/ciris_engine/logic/processors/core/test_main_processor.py:92: in main_processor
    processor = AgentProcessor(
ciris_engine/logic/processors/core/main_processor.py:79: in __init__
    self.wakeup_processor = WakeupProcessor(
ciris_engine/logic/processors/states/wakeup_processor.py:60: in __init__
    super().__init__(*args, **kwargs)
ciris_engine/logic/processors/core/base_processor.py:50: in __init__
    raise ValueError("resource_monitor is required for processors")
E   ValueError: resource_monitor is required for processors
___________________________________________________ ERROR at setup of TestAgentProcessor.test_get_processor_metrics ___________________________________________________
tests/ciris_engine/logic/processors/core/test_main_processor.py:92: in main_processor
    processor = AgentProcessor(
ciris_engine/logic/processors/core/main_processor.py:79: in __init__
    self.wakeup_processor = WakeupProcessor(
ciris_engine/logic/processors/states/wakeup_processor.py:60: in __init__
    super().__init__(*args, **kwargs)
ciris_engine/logic/processors/core/base_processor.py:50: in __init__
    raise ValueError("resource_monitor is required for processors")
E   ValueError: resource_monitor is required for processors
____________________________________________________ ERROR at setup of TestAgentProcessor.test_validate_transition ____________________________________________________
tests/ciris_engine/logic/processors/core/test_main_processor.py:92: in main_processor
    processor = AgentProcessor(
ciris_engine/logic/processors/core/main_processor.py:79: in __init__
    self.wakeup_processor = WakeupProcessor(
ciris_engine/logic/processors/states/wakeup_processor.py:60: in __init__
    super().__init__(*args, **kwargs)
ciris_engine/logic/processors/core/base_processor.py:50: in __init__
    raise ValueError("resource_monitor is required for processors")
E   ValueError: resource_monitor is required for processors
_________________________________________________ ERROR at setup of TestAgentProcessor.test_transition_to_same_state __________________________________________________
tests/ciris_engine/logic/processors/core/test_main_processor.py:92: in main_processor
    processor = AgentProcessor(
ciris_engine/logic/processors/core/main_processor.py:79: in __init__
    self.wakeup_processor = WakeupProcessor(
ciris_engine/logic/processors/states/wakeup_processor.py:60: in __init__
    super().__init__(*args, **kwargs)
ciris_engine/logic/processors/core/base_processor.py:50: in __init__
    raise ValueError("resource_monitor is required for processors")
E   ValueError: resource_monitor is required for processors
____________________________________________________ ERROR at setup of TestAgentProcessor.test_processor_not_found ____________________________________________________
tests/ciris_engine/logic/processors/core/test_main_processor.py:92: in main_processor
    processor = AgentProcessor(
ciris_engine/logic/processors/core/main_processor.py:79: in __init__
    self.wakeup_processor = WakeupProcessor(
ciris_engine/logic/processors/states/wakeup_processor.py:60: in __init__
    super().__init__(*args, **kwargs)
ciris_engine/logic/processors/core/base_processor.py:50: in __init__
    raise ValueError("resource_monitor is required for processors")
E   ValueError: resource_monitor is required for processors
__________________________________________________ ERROR at setup of TestAgentProcessor.test_state_transition_delay ___________________________________________________
tests/ciris_engine/logic/processors/core/test_main_processor.py:92: in main_processor
    processor = AgentProcessor(
ciris_engine/logic/processors/core/main_processor.py:79: in __init__
    self.wakeup_processor = WakeupProcessor(
ciris_engine/logic/processors/states/wakeup_processor.py:60: in __init__
    super().__init__(*args, **kwargs)
ciris_engine/logic/processors/core/base_processor.py:50: in __init__
    raise ValueError("resource_monitor is required for processors")
E   ValueError: resource_monitor is required for processors
__________________________________________________________ ERROR at setup of TestAgentProcessor.test_cleanup __________________________________________________________
tests/ciris_engine/logic/processors/core/test_main_processor.py:92: in main_processor
    processor = AgentProcessor(
ciris_engine/logic/processors/core/main_processor.py:79: in __init__
    self.wakeup_processor = WakeupProcessor(
ciris_engine/logic/processors/states/wakeup_processor.py:60: in __init__
    super().__init__(*args, **kwargs)
ciris_engine/logic/processors/core/base_processor.py:50: in __init__
    raise ValueError("resource_monitor is required for processors")
E   ValueError: resource_monitor is required for processors
_____________________________________________________ ERROR at setup of TestAgentProcessor.test_max_rounds_limit ______________________________________________________
tests/ciris_engine/logic/processors/core/test_main_processor.py:92: in main_processor
    processor = AgentProcessor(
ciris_engine/logic/processors/core/main_processor.py:79: in __init__
    self.wakeup_processor = WakeupProcessor(
ciris_engine/logic/processors/states/wakeup_processor.py:60: in __init__
    super().__init__(*args, **kwargs)
ciris_engine/logic/processors/core/base_processor.py:50: in __init__
    raise ValueError("resource_monitor is required for processors")
E   ValueError: resource_monitor is required for processors
__________________________________________________ ERROR at setup of TestAgentProcessor.test_record_state_transition __________________________________________________
tests/ciris_engine/logic/processors/core/test_main_processor.py:92: in main_processor
    processor = AgentProcessor(
ciris_engine/logic/processors/core/main_processor.py:79: in __init__
    self.wakeup_processor = WakeupProcessor(
ciris_engine/logic/processors/states/wakeup_processor.py:60: in __init__
    super().__init__(*args, **kwargs)
ciris_engine/logic/processors/core/base_processor.py:50: in __init__
    raise ValueError("resource_monitor is required for processors")
E   ValueError: resource_monitor is required for processors
_____________________________________________ ERROR at setup of TestAgentProcessor.test_processor_initialization_failure ______________________________________________
tests/ciris_engine/logic/processors/core/test_main_processor.py:92: in main_processor
    processor = AgentProcessor(
ciris_engine/logic/processors/core/main_processor.py:79: in __init__
    self.wakeup_processor = WakeupProcessor(
ciris_engine/logic/processors/states/wakeup_processor.py:60: in __init__
    super().__init__(*args, **kwargs)
ciris_engine/logic/processors/core/base_processor.py:50: in __init__
    raise ValueError("resource_monitor is required for processors")
E   ValueError: resource_monitor is required for processors
__________________________________________________ ERROR at setup of TestThoughtProcessor.test_get_processing_queue ___________________________________________________
tests/ciris_engine/logic/processors/core/test_thought_processor.py:35: in mock_bus_manager
    mock_llm_bus.select_action = AsyncMock(return_value=ActionSelectionDMAResult(
E   pydantic_core._pydantic_core.ValidationError: 18 validation errors for ActionSelectionDMAResult
E   action_parameters.ObserveParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.SpeakParams.content
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.SpeakParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.ToolParams.name
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.ToolParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.PonderParams.questions
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.PonderParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.RejectParams.reason
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.RejectParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.DeferParams.reason
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.DeferParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.MemorizeParams.node
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.MemorizeParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.RecallParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.ForgetParams.node
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.ForgetParams.reason
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.ForgetParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.TaskCompleteParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
________________________________________________ ERROR at setup of TestThoughtProcessor.test_create_thought_from_task _________________________________________________
tests/ciris_engine/logic/processors/core/test_thought_processor.py:35: in mock_bus_manager
    mock_llm_bus.select_action = AsyncMock(return_value=ActionSelectionDMAResult(
E   pydantic_core._pydantic_core.ValidationError: 18 validation errors for ActionSelectionDMAResult
E   action_parameters.ObserveParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.SpeakParams.content
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.SpeakParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.ToolParams.name
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.ToolParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.PonderParams.questions
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.PonderParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.RejectParams.reason
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.RejectParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.DeferParams.reason
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.DeferParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.MemorizeParams.node
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.MemorizeParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.RecallParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.ForgetParams.node
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.ForgetParams.reason
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.ForgetParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.TaskCompleteParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
________________________________________________ ERROR at setup of TestThoughtProcessor.test_create_follow_up_thought _________________________________________________
tests/ciris_engine/logic/processors/core/test_thought_processor.py:35: in mock_bus_manager
    mock_llm_bus.select_action = AsyncMock(return_value=ActionSelectionDMAResult(
E   pydantic_core._pydantic_core.ValidationError: 18 validation errors for ActionSelectionDMAResult
E   action_parameters.ObserveParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.SpeakParams.content
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.SpeakParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.ToolParams.name
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.ToolParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.PonderParams.questions
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.PonderParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.RejectParams.reason
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.RejectParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.DeferParams.reason
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.DeferParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.MemorizeParams.node
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.MemorizeParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.RecallParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.ForgetParams.node
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.ForgetParams.reason
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.ForgetParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.TaskCompleteParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
_________________________________________________ ERROR at setup of TestThoughtProcessor.test_process_single_thought __________________________________________________
tests/ciris_engine/logic/processors/core/test_thought_processor.py:35: in mock_bus_manager
    mock_llm_bus.select_action = AsyncMock(return_value=ActionSelectionDMAResult(
E   pydantic_core._pydantic_core.ValidationError: 18 validation errors for ActionSelectionDMAResult
E   action_parameters.ObserveParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.SpeakParams.content
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.SpeakParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.ToolParams.name
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.ToolParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.PonderParams.questions
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.PonderParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.RejectParams.reason
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.RejectParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.DeferParams.reason
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.DeferParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.MemorizeParams.node
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.MemorizeParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.RecallParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.ForgetParams.node
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.ForgetParams.reason
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.ForgetParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.TaskCompleteParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
_______________________________________________ ERROR at setup of TestThoughtProcessor.test_process_thought_with_error ________________________________________________
tests/ciris_engine/logic/processors/core/test_thought_processor.py:35: in mock_bus_manager
    mock_llm_bus.select_action = AsyncMock(return_value=ActionSelectionDMAResult(
E   pydantic_core._pydantic_core.ValidationError: 18 validation errors for ActionSelectionDMAResult
E   action_parameters.ObserveParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.SpeakParams.content
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.SpeakParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.ToolParams.name
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.ToolParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.PonderParams.questions
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.PonderParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.RejectParams.reason
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.RejectParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.DeferParams.reason
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.DeferParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.MemorizeParams.node
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.MemorizeParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.RecallParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.ForgetParams.node
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.ForgetParams.reason
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.ForgetParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.TaskCompleteParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
_________________________________________________ ERROR at setup of TestThoughtProcessor.test_max_thought_depth_limit _________________________________________________
tests/ciris_engine/logic/processors/core/test_thought_processor.py:35: in mock_bus_manager
    mock_llm_bus.select_action = AsyncMock(return_value=ActionSelectionDMAResult(
E   pydantic_core._pydantic_core.ValidationError: 18 validation errors for ActionSelectionDMAResult
E   action_parameters.ObserveParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.SpeakParams.content
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.SpeakParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.ToolParams.name
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.ToolParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.PonderParams.questions
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.PonderParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.RejectParams.reason
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.RejectParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.DeferParams.reason
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.DeferParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.MemorizeParams.node
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.MemorizeParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.RecallParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.ForgetParams.node
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.ForgetParams.reason
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.ForgetParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.TaskCompleteParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
________________________________________________ ERROR at setup of TestThoughtProcessor.test_process_multiple_thoughts ________________________________________________
tests/ciris_engine/logic/processors/core/test_thought_processor.py:35: in mock_bus_manager
    mock_llm_bus.select_action = AsyncMock(return_value=ActionSelectionDMAResult(
E   pydantic_core._pydantic_core.ValidationError: 18 validation errors for ActionSelectionDMAResult
E   action_parameters.ObserveParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.SpeakParams.content
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.SpeakParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.ToolParams.name
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.ToolParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.PonderParams.questions
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.PonderParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.RejectParams.reason
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.RejectParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.DeferParams.reason
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.DeferParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.MemorizeParams.node
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.MemorizeParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.RecallParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.ForgetParams.node
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.ForgetParams.reason
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.ForgetParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.TaskCompleteParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
_________________________________________________ ERROR at setup of TestThoughtProcessor.test_handle_terminal_action __________________________________________________
tests/ciris_engine/logic/processors/core/test_thought_processor.py:35: in mock_bus_manager
    mock_llm_bus.select_action = AsyncMock(return_value=ActionSelectionDMAResult(
E   pydantic_core._pydantic_core.ValidationError: 18 validation errors for ActionSelectionDMAResult
E   action_parameters.ObserveParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.SpeakParams.content
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.SpeakParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.ToolParams.name
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.ToolParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.PonderParams.questions
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.PonderParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.RejectParams.reason
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.RejectParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.DeferParams.reason
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.DeferParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.MemorizeParams.node
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.MemorizeParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.RecallParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.ForgetParams.node
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.ForgetParams.reason
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.ForgetParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.TaskCompleteParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
_________________________________________________ ERROR at setup of TestThoughtProcessor.test_action_dispatch_failure _________________________________________________
tests/ciris_engine/logic/processors/core/test_thought_processor.py:35: in mock_bus_manager
    mock_llm_bus.select_action = AsyncMock(return_value=ActionSelectionDMAResult(
E   pydantic_core._pydantic_core.ValidationError: 18 validation errors for ActionSelectionDMAResult
E   action_parameters.ObserveParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.SpeakParams.content
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.SpeakParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.ToolParams.name
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.ToolParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.PonderParams.questions
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.PonderParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.RejectParams.reason
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.RejectParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.DeferParams.reason
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.DeferParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.MemorizeParams.node
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.MemorizeParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.RecallParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.ForgetParams.node
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.ForgetParams.reason
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.ForgetParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.TaskCompleteParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
_____________________________________________________ ERROR at setup of TestThoughtProcessor.test_get_queue_stats _____________________________________________________
tests/ciris_engine/logic/processors/core/test_thought_processor.py:35: in mock_bus_manager
    mock_llm_bus.select_action = AsyncMock(return_value=ActionSelectionDMAResult(
E   pydantic_core._pydantic_core.ValidationError: 18 validation errors for ActionSelectionDMAResult
E   action_parameters.ObserveParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.SpeakParams.content
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.SpeakParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.ToolParams.name
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.ToolParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.PonderParams.questions
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.PonderParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.RejectParams.reason
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.RejectParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.DeferParams.reason
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.DeferParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.MemorizeParams.node
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.MemorizeParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.RecallParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.ForgetParams.node
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.ForgetParams.reason
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.ForgetParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.TaskCompleteParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
________________________________________________ ERROR at setup of TestThoughtProcessor.test_priority_processing_order ________________________________________________
tests/ciris_engine/logic/processors/core/test_thought_processor.py:35: in mock_bus_manager
    mock_llm_bus.select_action = AsyncMock(return_value=ActionSelectionDMAResult(
E   pydantic_core._pydantic_core.ValidationError: 18 validation errors for ActionSelectionDMAResult
E   action_parameters.ObserveParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.SpeakParams.content
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.SpeakParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.ToolParams.name
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.ToolParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.PonderParams.questions
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.PonderParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.RejectParams.reason
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.RejectParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.DeferParams.reason
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.DeferParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.MemorizeParams.node
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.MemorizeParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.RecallParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.ForgetParams.node
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.ForgetParams.reason
E     Field required [type=missing, input_value={'message': 'Test response'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.ForgetParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.TaskCompleteParams.message
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test response', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
____________________________________________________ ERROR at setup of TestServiceInitializer.test_initialize_all _____________________________________________________
tests/ciris_engine/logic/runtime/test_service_initializer.py:38: in service_initializer
    initializer = ServiceInitializer(
E   TypeError: ServiceInitializer.__init__() got an unexpected keyword argument 'db_path'
_______________________________________________ ERROR at setup of TestServiceInitializer.test_initialize_infrastructure _______________________________________________
tests/ciris_engine/logic/runtime/test_service_initializer.py:38: in service_initializer
    initializer = ServiceInitializer(
E   TypeError: ServiceInitializer.__init__() got an unexpected keyword argument 'db_path'
__________________________________________________ ERROR at setup of TestServiceInitializer.test_initialize_database __________________________________________________
tests/ciris_engine/logic/runtime/test_service_initializer.py:38: in service_initializer
    initializer = ServiceInitializer(
E   TypeError: ServiceInitializer.__init__() got an unexpected keyword argument 'db_path'
___________________________________________________ ERROR at setup of TestServiceInitializer.test_initialize_memory ___________________________________________________
tests/ciris_engine/logic/runtime/test_service_initializer.py:38: in service_initializer
    initializer = ServiceInitializer(
E   TypeError: ServiceInitializer.__init__() got an unexpected keyword argument 'db_path'
__________________________________________________ ERROR at setup of TestServiceInitializer.test_initialize_identity __________________________________________________
tests/ciris_engine/logic/runtime/test_service_initializer.py:38: in service_initializer
    initializer = ServiceInitializer(
E   TypeError: ServiceInitializer.__init__() got an unexpected keyword argument 'db_path'
__________________________________________________ ERROR at setup of TestServiceInitializer.test_initialize_security __________________________________________________
tests/ciris_engine/logic/runtime/test_service_initializer.py:38: in service_initializer
    initializer = ServiceInitializer(
E   TypeError: ServiceInitializer.__init__() got an unexpected keyword argument 'db_path'
__________________________________________________ ERROR at setup of TestServiceInitializer.test_initialize_services __________________________________________________
tests/ciris_engine/logic/runtime/test_service_initializer.py:38: in service_initializer
    initializer = ServiceInitializer(
E   TypeError: ServiceInitializer.__init__() got an unexpected keyword argument 'db_path'
______________________________________________ ERROR at setup of TestServiceInitializer.test_initialize_llm_service_mock ______________________________________________
tests/ciris_engine/logic/runtime/test_service_initializer.py:38: in service_initializer
    initializer = ServiceInitializer(
E   TypeError: ServiceInitializer.__init__() got an unexpected keyword argument 'db_path'
______________________________________________ ERROR at setup of TestServiceInitializer.test_initialize_llm_service_real ______________________________________________
tests/ciris_engine/logic/runtime/test_service_initializer.py:38: in service_initializer
    initializer = ServiceInitializer(
E   TypeError: ServiceInitializer.__init__() got an unexpected keyword argument 'db_path'
_____________________________________________________ ERROR at setup of TestServiceInitializer.test_shutdown_all ______________________________________________________
tests/ciris_engine/logic/runtime/test_service_initializer.py:38: in service_initializer
    initializer = ServiceInitializer(
E   TypeError: ServiceInitializer.__init__() got an unexpected keyword argument 'db_path'
__________________________________________________ ERROR at setup of TestServiceInitializer.test_shutdown_with_error __________________________________________________
tests/ciris_engine/logic/runtime/test_service_initializer.py:38: in service_initializer
    initializer = ServiceInitializer(
E   TypeError: ServiceInitializer.__init__() got an unexpected keyword argument 'db_path'
___________________________________________________ ERROR at setup of TestServiceInitializer.test_get_all_services ____________________________________________________
tests/ciris_engine/logic/runtime/test_service_initializer.py:38: in service_initializer
    initializer = ServiceInitializer(
E   TypeError: ServiceInitializer.__init__() got an unexpected keyword argument 'db_path'
_________________________________________________ ERROR at setup of TestServiceInitializer.test_verify_initialization _________________________________________________
tests/ciris_engine/logic/runtime/test_service_initializer.py:38: in service_initializer
    initializer = ServiceInitializer(
E   TypeError: ServiceInitializer.__init__() got an unexpected keyword argument 'db_path'
_________________________________________ ERROR at setup of TestServiceInitializer.test_verify_initialization_missing_service _________________________________________
tests/ciris_engine/logic/runtime/test_service_initializer.py:38: in service_initializer
    initializer = ServiceInitializer(
E   TypeError: ServiceInitializer.__init__() got an unexpected keyword argument 'db_path'
_____________________________________________________ ERROR at setup of TestServiceInitializer.test_service_count _____________________________________________________
tests/ciris_engine/logic/runtime/test_service_initializer.py:38: in service_initializer
    initializer = ServiceInitializer(
E   TypeError: ServiceInitializer.__init__() got an unexpected keyword argument 'db_path'
___________________________________________ ERROR at setup of TestServiceInitializer.test_initialization_order_dependencies ___________________________________________
tests/ciris_engine/logic/runtime/test_service_initializer.py:38: in service_initializer
    initializer = ServiceInitializer(
E   TypeError: ServiceInitializer.__init__() got an unexpected keyword argument 'db_path'
___________________________________________________________ ERROR at setup of test_config_service_lifecycle ___________________________________________________________
tests/ciris_engine/logic/services/graph/test_config_service.py:54: in memory_service
    from ciris_engine.logic.services.runtime.secrets_service import SecretsService
E   ModuleNotFoundError: No module named 'ciris_engine.logic.services.runtime.secrets_service'
__________________________________________________________ ERROR at setup of test_config_service_set_and_get __________________________________________________________
tests/ciris_engine/logic/services/graph/test_config_service.py:54: in memory_service
    from ciris_engine.logic.services.runtime.secrets_service import SecretsService
E   ModuleNotFoundError: No module named 'ciris_engine.logic.services.runtime.secrets_service'
________________________________________________________ ERROR at setup of test_config_service_get_nonexistent ________________________________________________________
tests/ciris_engine/logic/services/graph/test_config_service.py:54: in memory_service
    from ciris_engine.logic.services.runtime.secrets_service import SecretsService
E   ModuleNotFoundError: No module named 'ciris_engine.logic.services.runtime.secrets_service'
_________________________________________________________ ERROR at setup of test_config_service_update_config _________________________________________________________
tests/ciris_engine/logic/services/graph/test_config_service.py:54: in memory_service
    from ciris_engine.logic.services.runtime.secrets_service import SecretsService
E   ModuleNotFoundError: No module named 'ciris_engine.logic.services.runtime.secrets_service'
_________________________________________________________ ERROR at setup of test_config_service_list_configs __________________________________________________________
tests/ciris_engine/logic/services/graph/test_config_service.py:54: in memory_service
    from ciris_engine.logic.services.runtime.secrets_service import SecretsService
E   ModuleNotFoundError: No module named 'ciris_engine.logic.services.runtime.secrets_service'
________________________________________________________ ERROR at setup of test_config_service_list_by_prefix _________________________________________________________
tests/ciris_engine/logic/services/graph/test_config_service.py:54: in memory_service
    from ciris_engine.logic.services.runtime.secrets_service import SecretsService
E   ModuleNotFoundError: No module named 'ciris_engine.logic.services.runtime.secrets_service'
_________________________________________________________ ERROR at setup of test_config_service_delete_config _________________________________________________________
tests/ciris_engine/logic/services/graph/test_config_service.py:54: in memory_service
    from ciris_engine.logic.services.runtime.secrets_service import SecretsService
E   ModuleNotFoundError: No module named 'ciris_engine.logic.services.runtime.secrets_service'
________________________________________________________ ERROR at setup of test_config_service_complex_values _________________________________________________________
tests/ciris_engine/logic/services/graph/test_config_service.py:54: in memory_service
    from ciris_engine.logic.services.runtime.secrets_service import SecretsService
E   ModuleNotFoundError: No module named 'ciris_engine.logic.services.runtime.secrets_service'
_________________________________________________________ ERROR at setup of test_config_service_capabilities __________________________________________________________
tests/ciris_engine/logic/services/graph/test_config_service.py:54: in memory_service
    from ciris_engine.logic.services.runtime.secrets_service import SecretsService
E   ModuleNotFoundError: No module named 'ciris_engine.logic.services.runtime.secrets_service'
____________________________________________________________ ERROR at setup of test_config_service_status _____________________________________________________________
tests/ciris_engine/logic/services/graph/test_config_service.py:54: in memory_service
    from ciris_engine.logic.services.runtime.secrets_service import SecretsService
E   ModuleNotFoundError: No module named 'ciris_engine.logic.services.runtime.secrets_service'
__________________________________________________________ ERROR at setup of test_config_service_versioning ___________________________________________________________
tests/ciris_engine/logic/services/graph/test_config_service.py:54: in memory_service
    from ciris_engine.logic.services.runtime.secrets_service import SecretsService
E   ModuleNotFoundError: No module named 'ciris_engine.logic.services.runtime.secrets_service'
_______________________________________________________ ERROR at setup of test_config_service_metadata_tracking _______________________________________________________
tests/ciris_engine/logic/services/graph/test_config_service.py:54: in memory_service
    from ciris_engine.logic.services.runtime.secrets_service import SecretsService
E   ModuleNotFoundError: No module named 'ciris_engine.logic.services.runtime.secrets_service'
_______________________________________________________ ERROR at setup of test_config_service_batch_operations ________________________________________________________
tests/ciris_engine/logic/services/graph/test_config_service.py:54: in memory_service
    from ciris_engine.logic.services.runtime.secrets_service import SecretsService
E   ModuleNotFoundError: No module named 'ciris_engine.logic.services.runtime.secrets_service'
_______________________________________________________ ERROR at setup of test_config_service_sensitive_config ________________________________________________________
tests/ciris_engine/logic/services/graph/test_config_service.py:54: in memory_service
    from ciris_engine.logic.services.runtime.secrets_service import SecretsService
E   ModuleNotFoundError: No module named 'ciris_engine.logic.services.runtime.secrets_service'
___________________________________________________ ERROR at setup of test_config_node_typed_graph_node_compliance ____________________________________________________
tests/ciris_engine/logic/services/graph/test_config_service.py:54: in memory_service
    from ciris_engine.logic.services.runtime.secrets_service import SecretsService
E   ModuleNotFoundError: No module named 'ciris_engine.logic.services.runtime.secrets_service'
_____________________________________________________ ERROR at setup of test_config_service_no_duplicate_updates ______________________________________________________
tests/ciris_engine/logic/services/graph/test_config_service.py:54: in memory_service
    from ciris_engine.logic.services.runtime.secrets_service import SecretsService
E   ModuleNotFoundError: No module named 'ciris_engine.logic.services.runtime.secrets_service'
__________________________________________________________ ERROR at setup of test_config_service_path_values __________________________________________________________
tests/ciris_engine/logic/services/graph/test_config_service.py:54: in memory_service
    from ciris_engine.logic.services.runtime.secrets_service import SecretsService
E   ModuleNotFoundError: No module named 'ciris_engine.logic.services.runtime.secrets_service'
_____________________________________________________ ERROR at setup of TestAuthenticationService.test_start_stop _____________________________________________________
tests/ciris_engine/logic/services/infrastructure/test_authentication.py:45: in auth_service
    service = AuthenticationService(
E   TypeError: AuthenticationService.__init__() got an unexpected keyword argument 'secrets_service'
____________________________________________________ ERROR at setup of TestAuthenticationService.test_create_token ____________________________________________________
tests/ciris_engine/logic/services/infrastructure/test_authentication.py:45: in auth_service
    service = AuthenticationService(
E   TypeError: AuthenticationService.__init__() got an unexpected keyword argument 'secrets_service'
_________________________________________________ ERROR at setup of TestAuthenticationService.test_verify_valid_token _________________________________________________
tests/ciris_engine/logic/services/infrastructure/test_authentication.py:45: in auth_service
    service = AuthenticationService(
E   TypeError: AuthenticationService.__init__() got an unexpected keyword argument 'secrets_service'
________________________________________________ ERROR at setup of TestAuthenticationService.test_verify_expired_token ________________________________________________
tests/ciris_engine/logic/services/infrastructure/test_authentication.py:45: in auth_service
    service = AuthenticationService(
E   TypeError: AuthenticationService.__init__() got an unexpected keyword argument 'secrets_service'
________________________________________________ ERROR at setup of TestAuthenticationService.test_verify_invalid_token ________________________________________________
tests/ciris_engine/logic/services/infrastructure/test_authentication.py:45: in auth_service
    service = AuthenticationService(
E   TypeError: AuthenticationService.__init__() got an unexpected keyword argument 'secrets_service'
___________________________________________________ ERROR at setup of TestAuthenticationService.test_refresh_token ____________________________________________________
tests/ciris_engine/logic/services/infrastructure/test_authentication.py:45: in auth_service
    service = AuthenticationService(
E   TypeError: AuthenticationService.__init__() got an unexpected keyword argument 'secrets_service'
_______________________________________________ ERROR at setup of TestAuthenticationService.test_refresh_invalid_token ________________________________________________
tests/ciris_engine/logic/services/infrastructure/test_authentication.py:45: in auth_service
    service = AuthenticationService(
E   TypeError: AuthenticationService.__init__() got an unexpected keyword argument 'secrets_service'
____________________________________________________ ERROR at setup of TestAuthenticationService.test_revoke_token ____________________________________________________
tests/ciris_engine/logic/services/infrastructure/test_authentication.py:45: in auth_service
    service = AuthenticationService(
E   TypeError: AuthenticationService.__init__() got an unexpected keyword argument 'secrets_service'
______________________________________________ ERROR at setup of TestAuthenticationService.test_check_permission_allowed ______________________________________________
tests/ciris_engine/logic/services/infrastructure/test_authentication.py:45: in auth_service
    service = AuthenticationService(
E   TypeError: AuthenticationService.__init__() got an unexpected keyword argument 'secrets_service'
______________________________________________ ERROR at setup of TestAuthenticationService.test_check_permission_denied _______________________________________________
tests/ciris_engine/logic/services/infrastructure/test_authentication.py:45: in auth_service
    service = AuthenticationService(
E   TypeError: AuthenticationService.__init__() got an unexpected keyword argument 'secrets_service'
__________________________________________ ERROR at setup of TestAuthenticationService.test_check_permission_unauthenticated __________________________________________
tests/ciris_engine/logic/services/infrastructure/test_authentication.py:45: in auth_service
    service = AuthenticationService(
E   TypeError: AuthenticationService.__init__() got an unexpected keyword argument 'secrets_service'
__________________________________________________ ERROR at setup of TestAuthenticationService.test_validate_api_key __________________________________________________
tests/ciris_engine/logic/services/infrastructure/test_authentication.py:45: in auth_service
    service = AuthenticationService(
E   TypeError: AuthenticationService.__init__() got an unexpected keyword argument 'secrets_service'
______________________________________________ ERROR at setup of TestAuthenticationService.test_validate_invalid_api_key ______________________________________________
tests/ciris_engine/logic/services/infrastructure/test_authentication.py:45: in auth_service
    service = AuthenticationService(
E   TypeError: AuthenticationService.__init__() got an unexpected keyword argument 'secrets_service'
________________________________________________ ERROR at setup of TestAuthenticationService.test_create_service_token ________________________________________________
tests/ciris_engine/logic/services/infrastructure/test_authentication.py:45: in auth_service
    service = AuthenticationService(
E   TypeError: AuthenticationService.__init__() got an unexpected keyword argument 'secrets_service'
_________________________________________________ ERROR at setup of TestAuthenticationService.test_permission_levels __________________________________________________
tests/ciris_engine/logic/services/infrastructure/test_authentication.py:45: in auth_service
    service = AuthenticationService(
E   TypeError: AuthenticationService.__init__() got an unexpected keyword argument 'secrets_service'
_______________________________________________ ERROR at setup of TestAuthenticationService.test_cleanup_expired_tokens _______________________________________________
tests/ciris_engine/logic/services/infrastructure/test_authentication.py:45: in auth_service
    service = AuthenticationService(
E   TypeError: AuthenticationService.__init__() got an unexpected keyword argument 'secrets_service'
__________________________________________________ ERROR at setup of TestAuthenticationService.test_get_capabilities __________________________________________________
tests/ciris_engine/logic/services/infrastructure/test_authentication.py:45: in auth_service
    service = AuthenticationService(
E   TypeError: AuthenticationService.__init__() got an unexpected keyword argument 'secrets_service'
_____________________________________________________ ERROR at setup of TestAuthenticationService.test_get_status _____________________________________________________
tests/ciris_engine/logic/services/infrastructure/test_authentication.py:45: in auth_service
    service = AuthenticationService(
E   TypeError: AuthenticationService.__init__() got an unexpected keyword argument 'secrets_service'
_______________________________________________ ERROR at setup of TestAuthenticationService.test_encrypt_token_metadata _______________________________________________
tests/ciris_engine/logic/services/infrastructure/test_authentication.py:45: in auth_service
    service = AuthenticationService(
E   TypeError: AuthenticationService.__init__() got an unexpected keyword argument 'secrets_service'
_____________________________________________ ERROR at setup of TestAuthenticationService.test_concurrent_token_creation ______________________________________________
tests/ciris_engine/logic/services/infrastructure/test_authentication.py:45: in auth_service
    service = AuthenticationService(
E   TypeError: AuthenticationService.__init__() got an unexpected keyword argument 'secrets_service'
______________________________________________ ERROR at setup of TestAuthenticationService.test_token_with_custom_expiry ______________________________________________
tests/ciris_engine/logic/services/infrastructure/test_authentication.py:45: in auth_service
    service = AuthenticationService(
E   TypeError: AuthenticationService.__init__() got an unexpected keyword argument 'secrets_service'
__________________________________________________ ERROR at setup of TestDeferralIntegration.test_full_deferral_flow __________________________________________________
tests/integration/test_deferral_integration.py:116: in mock_service_registry
    wa_service = WiseAuthorityService(
E   TypeError: WiseAuthorityService.__init__() got an unexpected keyword argument 'memory_service'
______________________________________ ERROR at setup of TestDeferralIntegration.test_concurrent_deferrals_different_priorities _______________________________________
tests/integration/test_deferral_integration.py:116: in mock_service_registry
    wa_service = WiseAuthorityService(
E   TypeError: WiseAuthorityService.__init__() got an unexpected keyword argument 'memory_service'
__________________________________________ ERROR at setup of TestDeferralIntegration.test_time_based_deferral_with_scheduler __________________________________________
tests/integration/test_deferral_integration.py:116: in mock_service_registry
    wa_service = WiseAuthorityService(
E   TypeError: WiseAuthorityService.__init__() got an unexpected keyword argument 'memory_service'
_____________________________________________ ERROR at setup of TestDeferralIntegration.test_deferral_modification_by_wa ______________________________________________
tests/integration/test_deferral_integration.py:116: in mock_service_registry
    wa_service = WiseAuthorityService(
E   TypeError: WiseAuthorityService.__init__() got an unexpected keyword argument 'memory_service'
__________________________________________ ERROR at setup of TestDeferralErrorScenarios.test_wa_service_unavailable_fallback __________________________________________
tests/integration/test_deferral_integration.py:116: in mock_service_registry
    wa_service = WiseAuthorityService(
E   TypeError: WiseAuthorityService.__init__() got an unexpected keyword argument 'memory_service'
____________________________________________ ERROR at setup of TestDeferralErrorScenarios.test_malformed_deferral_recovery ____________________________________________
tests/integration/test_deferral_integration.py:116: in mock_service_registry
    wa_service = WiseAuthorityService(
E   TypeError: WiseAuthorityService.__init__() got an unexpected keyword argument 'memory_service'
___________________________________________________ ERROR at setup of TestDeferHandler.test_basic_deferral_success ____________________________________________________
tests/test_defer_handler.py:128: in mock_persistence
    mock.get_task_by_id = Mock(return_value=create_test_task())
tests/test_defer_handler.py:75: in create_test_task
    status=TaskStatus.IN_PROGRESS,
E   AttributeError: type object 'TaskStatus' has no attribute 'IN_PROGRESS'
------------------------------------------------------------------------- Captured log setup --------------------------------------------------------------------------
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 CommunicationBus initialized for communication
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 MemoryBus initialized for memory
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 ToolBus initialized for tool
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 WiseBus initialized for wise_authority
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 RuntimeControlBus initialized for runtime_control
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 LLMBus initialized for llm
INFO     ciris_engine.logic.buses.llm_bus:llm_bus.py:110 LLMBus initialized with DistributionStrategy.LATENCY_BASED distribution strategy
INFO     ciris_engine.logic.buses.bus_manager:bus_manager.py:64 BusManager initialized with all message buses
_____________________________________________________ ERROR at setup of TestDeferHandler.test_time_based_deferral _____________________________________________________
tests/test_defer_handler.py:128: in mock_persistence
    mock.get_task_by_id = Mock(return_value=create_test_task())
tests/test_defer_handler.py:75: in create_test_task
    status=TaskStatus.IN_PROGRESS,
E   AttributeError: type object 'TaskStatus' has no attribute 'IN_PROGRESS'
------------------------------------------------------------------------- Captured log setup --------------------------------------------------------------------------
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 CommunicationBus initialized for communication
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 MemoryBus initialized for memory
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 ToolBus initialized for tool
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 WiseBus initialized for wise_authority
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 RuntimeControlBus initialized for runtime_control
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 LLMBus initialized for llm
INFO     ciris_engine.logic.buses.llm_bus:llm_bus.py:110 LLMBus initialized with DistributionStrategy.LATENCY_BASED distribution strategy
INFO     ciris_engine.logic.buses.bus_manager:bus_manager.py:64 BusManager initialized with all message buses
________________________________________________ ERROR at setup of TestDeferHandler.test_deferral_with_parameter_error ________________________________________________
tests/test_defer_handler.py:128: in mock_persistence
    mock.get_task_by_id = Mock(return_value=create_test_task())
tests/test_defer_handler.py:75: in create_test_task
    status=TaskStatus.IN_PROGRESS,
E   AttributeError: type object 'TaskStatus' has no attribute 'IN_PROGRESS'
------------------------------------------------------------------------- Captured log setup --------------------------------------------------------------------------
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 CommunicationBus initialized for communication
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 MemoryBus initialized for memory
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 ToolBus initialized for tool
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 WiseBus initialized for wise_authority
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 RuntimeControlBus initialized for runtime_control
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 LLMBus initialized for llm
INFO     ciris_engine.logic.buses.llm_bus:llm_bus.py:110 LLMBus initialized with DistributionStrategy.LATENCY_BASED distribution strategy
INFO     ciris_engine.logic.buses.bus_manager:bus_manager.py:64 BusManager initialized with all message buses
_____________________________________________ ERROR at setup of TestDeferHandler.test_deferral_when_wise_authority_fails ______________________________________________
tests/test_defer_handler.py:128: in mock_persistence
    mock.get_task_by_id = Mock(return_value=create_test_task())
tests/test_defer_handler.py:75: in create_test_task
    status=TaskStatus.IN_PROGRESS,
E   AttributeError: type object 'TaskStatus' has no attribute 'IN_PROGRESS'
------------------------------------------------------------------------- Captured log setup --------------------------------------------------------------------------
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 CommunicationBus initialized for communication
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 MemoryBus initialized for memory
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 ToolBus initialized for tool
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 WiseBus initialized for wise_authority
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 RuntimeControlBus initialized for runtime_control
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 LLMBus initialized for llm
INFO     ciris_engine.logic.buses.llm_bus:llm_bus.py:110 LLMBus initialized with DistributionStrategy.LATENCY_BASED distribution strategy
INFO     ciris_engine.logic.buses.bus_manager:bus_manager.py:64 BusManager initialized with all message buses
_________________________________________________ ERROR at setup of TestDeferHandler.test_deferral_with_task_metadata _________________________________________________
tests/test_defer_handler.py:128: in mock_persistence
    mock.get_task_by_id = Mock(return_value=create_test_task())
tests/test_defer_handler.py:75: in create_test_task
    status=TaskStatus.IN_PROGRESS,
E   AttributeError: type object 'TaskStatus' has no attribute 'IN_PROGRESS'
------------------------------------------------------------------------- Captured log setup --------------------------------------------------------------------------
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 CommunicationBus initialized for communication
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 MemoryBus initialized for memory
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 ToolBus initialized for tool
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 WiseBus initialized for wise_authority
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 RuntimeControlBus initialized for runtime_control
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 LLMBus initialized for llm
INFO     ciris_engine.logic.buses.llm_bus:llm_bus.py:110 LLMBus initialized with DistributionStrategy.LATENCY_BASED distribution strategy
INFO     ciris_engine.logic.buses.bus_manager:bus_manager.py:64 BusManager initialized with all message buses
__________________________________________________ ERROR at setup of TestDeferHandler.test_system_task_not_deferred ___________________________________________________
tests/test_defer_handler.py:128: in mock_persistence
    mock.get_task_by_id = Mock(return_value=create_test_task())
tests/test_defer_handler.py:75: in create_test_task
    status=TaskStatus.IN_PROGRESS,
E   AttributeError: type object 'TaskStatus' has no attribute 'IN_PROGRESS'
------------------------------------------------------------------------- Captured log setup --------------------------------------------------------------------------
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 CommunicationBus initialized for communication
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 MemoryBus initialized for memory
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 ToolBus initialized for tool
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 WiseBus initialized for wise_authority
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 RuntimeControlBus initialized for runtime_control
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 LLMBus initialized for llm
INFO     ciris_engine.logic.buses.llm_bus:llm_bus.py:110 LLMBus initialized with DistributionStrategy.LATENCY_BASED distribution strategy
INFO     ciris_engine.logic.buses.bus_manager:bus_manager.py:64 BusManager initialized with all message buses
____________________________________________________ ERROR at setup of TestDeferHandler.test_concurrent_deferrals _____________________________________________________
tests/test_defer_handler.py:128: in mock_persistence
    mock.get_task_by_id = Mock(return_value=create_test_task())
tests/test_defer_handler.py:75: in create_test_task
    status=TaskStatus.IN_PROGRESS,
E   AttributeError: type object 'TaskStatus' has no attribute 'IN_PROGRESS'
------------------------------------------------------------------------- Captured log setup --------------------------------------------------------------------------
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 CommunicationBus initialized for communication
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 MemoryBus initialized for memory
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 ToolBus initialized for tool
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 WiseBus initialized for wise_authority
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 RuntimeControlBus initialized for runtime_control
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 LLMBus initialized for llm
INFO     ciris_engine.logic.buses.llm_bus:llm_bus.py:110 LLMBus initialized with DistributionStrategy.LATENCY_BASED distribution strategy
INFO     ciris_engine.logic.buses.bus_manager:bus_manager.py:64 BusManager initialized with all message buses
___________________________________________________ ERROR at setup of TestDeferHandler.test_deferral_with_priority ____________________________________________________
tests/test_defer_handler.py:128: in mock_persistence
    mock.get_task_by_id = Mock(return_value=create_test_task())
tests/test_defer_handler.py:75: in create_test_task
    status=TaskStatus.IN_PROGRESS,
E   AttributeError: type object 'TaskStatus' has no attribute 'IN_PROGRESS'
------------------------------------------------------------------------- Captured log setup --------------------------------------------------------------------------
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 CommunicationBus initialized for communication
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 MemoryBus initialized for memory
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 ToolBus initialized for tool
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 WiseBus initialized for wise_authority
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 RuntimeControlBus initialized for runtime_control
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 LLMBus initialized for llm
INFO     ciris_engine.logic.buses.llm_bus:llm_bus.py:110 LLMBus initialized with DistributionStrategy.LATENCY_BASED distribution strategy
INFO     ciris_engine.logic.buses.bus_manager:bus_manager.py:64 BusManager initialized with all message buses
_______________________________________________ ERROR at setup of TestDeferralLifecycle.test_deferral_notification_flow _______________________________________________
file /home/emoore/CIRISAgent/tests/test_defer_handler.py, line 860
      @pytest.mark.asyncio
      async def test_deferral_notification_flow(
          self,
          defer_handler,
E       fixture 'defer_handler' not found
>       available fixtures: _session_event_loop, _session_faker, anyio_backend, anyio_backend_name, anyio_backend_options, api_port, api_required, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cleanup_after_test, cov, doctest_namespace, ensure_pydantic_models_rebuilt, event_loop, event_loop_policy, faker, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, mock_wise_authority_service, monkeypatch, no_cover, pytestconfig, randomize_api_port, record_property, record_testsuite_property, record_xml_attribute, recwarn, runtime, service_registry, skip_without_discord_token, tests/test_defer_handler.py::<event_loop>, tests/test_defer_handler.py::TestDeferralLifecycle::<event_loop>, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory
>       use 'pytest --fixtures [testpath]' for help on them.

/home/emoore/CIRISAgent/tests/test_defer_handler.py:860
___________________________________________ ERROR at setup of TestDeferralPermissions.test_authority_can_resolve_deferrals ____________________________________________
tests/test_deferral_permissions.py:34: in mock_memory_service
    WAPermission(
E   pydantic_core._pydantic_core.ValidationError: 4 validation errors for WAPermission
E   permission_id
E     Field required [type=missing, input_value={'action': 'resolve_defer...tc), 'expires_at': None}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   permission_type
E     Field required [type=missing, input_value={'action': 'resolve_defer...tc), 'expires_at': None}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   permission_name
E     Field required [type=missing, input_value={'action': 'resolve_defer...tc), 'expires_at': None}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action
E     Extra inputs are not permitted [type=extra_forbidden, input_value='resolve_deferral', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
__________________________________________ ERROR at setup of TestDeferralPermissions.test_observer_cannot_resolve_deferrals ___________________________________________
tests/test_deferral_permissions.py:34: in mock_memory_service
    WAPermission(
E   pydantic_core._pydantic_core.ValidationError: 4 validation errors for WAPermission
E   permission_id
E     Field required [type=missing, input_value={'action': 'resolve_defer...tc), 'expires_at': None}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   permission_type
E     Field required [type=missing, input_value={'action': 'resolve_defer...tc), 'expires_at': None}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   permission_name
E     Field required [type=missing, input_value={'action': 'resolve_defer...tc), 'expires_at': None}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action
E     Extra inputs are not permitted [type=extra_forbidden, input_value='resolve_deferral', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
__________________________________________ ERROR at setup of TestDeferralPermissions.test_expired_certificate_cannot_resolve __________________________________________
tests/test_deferral_permissions.py:34: in mock_memory_service
    WAPermission(
E   pydantic_core._pydantic_core.ValidationError: 4 validation errors for WAPermission
E   permission_id
E     Field required [type=missing, input_value={'action': 'resolve_defer...tc), 'expires_at': None}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   permission_type
E     Field required [type=missing, input_value={'action': 'resolve_defer...tc), 'expires_at': None}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   permission_name
E     Field required [type=missing, input_value={'action': 'resolve_defer...tc), 'expires_at': None}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action
E     Extra inputs are not permitted [type=extra_forbidden, input_value='resolve_deferral', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
__________________________________________ ERROR at setup of TestDeferralPermissions.test_revoked_certificate_cannot_resolve __________________________________________
tests/test_deferral_permissions.py:34: in mock_memory_service
    WAPermission(
E   pydantic_core._pydantic_core.ValidationError: 4 validation errors for WAPermission
E   permission_id
E     Field required [type=missing, input_value={'action': 'resolve_defer...tc), 'expires_at': None}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   permission_type
E     Field required [type=missing, input_value={'action': 'resolve_defer...tc), 'expires_at': None}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   permission_name
E     Field required [type=missing, input_value={'action': 'resolve_defer...tc), 'expires_at': None}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action
E     Extra inputs are not permitted [type=extra_forbidden, input_value='resolve_deferral', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
____________________________________________ ERROR at setup of TestDeferralPermissions.test_resource_specific_permissions _____________________________________________
tests/test_deferral_permissions.py:34: in mock_memory_service
    WAPermission(
E   pydantic_core._pydantic_core.ValidationError: 4 validation errors for WAPermission
E   permission_id
E     Field required [type=missing, input_value={'action': 'resolve_defer...tc), 'expires_at': None}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   permission_type
E     Field required [type=missing, input_value={'action': 'resolve_defer...tc), 'expires_at': None}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   permission_name
E     Field required [type=missing, input_value={'action': 'resolve_defer...tc), 'expires_at': None}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action
E     Extra inputs are not permitted [type=extra_forbidden, input_value='resolve_deferral', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
___________________________________________________ ERROR at setup of TestDeferralPermissions.test_grant_permission ___________________________________________________
tests/test_deferral_permissions.py:34: in mock_memory_service
    WAPermission(
E   pydantic_core._pydantic_core.ValidationError: 4 validation errors for WAPermission
E   permission_id
E     Field required [type=missing, input_value={'action': 'resolve_defer...tc), 'expires_at': None}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   permission_type
E     Field required [type=missing, input_value={'action': 'resolve_defer...tc), 'expires_at': None}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   permission_name
E     Field required [type=missing, input_value={'action': 'resolve_defer...tc), 'expires_at': None}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action
E     Extra inputs are not permitted [type=extra_forbidden, input_value='resolve_deferral', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
__________________________________________________ ERROR at setup of TestDeferralPermissions.test_revoke_permission ___________________________________________________
tests/test_deferral_permissions.py:34: in mock_memory_service
    WAPermission(
E   pydantic_core._pydantic_core.ValidationError: 4 validation errors for WAPermission
E   permission_id
E     Field required [type=missing, input_value={'action': 'resolve_defer...tc), 'expires_at': None}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   permission_type
E     Field required [type=missing, input_value={'action': 'resolve_defer...tc), 'expires_at': None}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   permission_name
E     Field required [type=missing, input_value={'action': 'resolve_defer...tc), 'expires_at': None}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action
E     Extra inputs are not permitted [type=extra_forbidden, input_value='resolve_deferral', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
________________________________________________ ERROR at setup of TestDeferralPermissions.test_permission_inheritance ________________________________________________
tests/test_deferral_permissions.py:34: in mock_memory_service
    WAPermission(
E   pydantic_core._pydantic_core.ValidationError: 4 validation errors for WAPermission
E   permission_id
E     Field required [type=missing, input_value={'action': 'resolve_defer...tc), 'expires_at': None}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   permission_type
E     Field required [type=missing, input_value={'action': 'resolve_defer...tc), 'expires_at': None}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   permission_name
E     Field required [type=missing, input_value={'action': 'resolve_defer...tc), 'expires_at': None}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action
E     Extra inputs are not permitted [type=extra_forbidden, input_value='resolve_deferral', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
_____________________________________________ ERROR at setup of TestDeferralPermissions.test_concurrent_permission_checks _____________________________________________
tests/test_deferral_permissions.py:34: in mock_memory_service
    WAPermission(
E   pydantic_core._pydantic_core.ValidationError: 4 validation errors for WAPermission
E   permission_id
E     Field required [type=missing, input_value={'action': 'resolve_defer...tc), 'expires_at': None}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   permission_type
E     Field required [type=missing, input_value={'action': 'resolve_defer...tc), 'expires_at': None}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   permission_name
E     Field required [type=missing, input_value={'action': 'resolve_defer...tc), 'expires_at': None}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action
E     Extra inputs are not permitted [type=extra_forbidden, input_value='resolve_deferral', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
____________________________________________ ERROR at setup of TestDeferralRoleEnforcement.test_resolution_role_validation ____________________________________________
file /home/emoore/CIRISAgent/tests/test_deferral_permissions.py, line 396
      @pytest.mark.asyncio
      async def test_resolution_role_validation(self, wa_service, sample_deferrals):
          """Test that resolution validates required role."""
          # Try to resolve medical deferral with non-medical authority
          response = DeferralResponse(
              approved=True,
              reason="Approved by wrong authority",
              modified_time=None,
              wa_id="wa_authority_001",  # Regular authority, not medical
              signature="test_sig"
          )

          # This should fail validation in a complete implementation
          # The actual validation would check:
          # 1. WA has resolve_deferral permission
          # 2. WA role matches deferral.requires_role
          # 3. WA certificate is valid and active

          # Mock the validation logic
          deferral = sample_deferrals[2]  # Medical deferral
E       fixture 'wa_service' not found
>       available fixtures: _session_event_loop, _session_faker, anyio_backend, anyio_backend_name, anyio_backend_options, api_port, api_required, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cleanup_after_test, cov, doctest_namespace, ensure_pydantic_models_rebuilt, event_loop, event_loop_policy, faker, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, monkeypatch, no_cover, pytestconfig, randomize_api_port, record_property, record_testsuite_property, record_xml_attribute, recwarn, runtime, sample_deferrals, service_registry, skip_without_discord_token, tests/test_deferral_permissions.py::<event_loop>, tests/test_deferral_permissions.py::TestDeferralRoleEnforcement::<event_loop>, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory
>       use 'pytest --fixtures [testpath]' for help on them.

/home/emoore/CIRISAgent/tests/test_deferral_permissions.py:396
______________________________________________ ERROR at setup of TestDeferralRoleEnforcement.test_permission_expiration _______________________________________________
file /home/emoore/CIRISAgent/tests/test_deferral_permissions.py, line 426
      @pytest.mark.asyncio
      async def test_permission_expiration(self, wa_service):
          """Test that permissions expire correctly."""
          # Grant temporary permission
          granted = await wa_service.grant_permission(
              wa_id="wa_temp_001",
              permission="resolve_deferral",
              resource="*"
          )
          assert granted is True

          # Mock permission with expiration
          expired_permission = WAPermission(
              action="resolve_deferral",
              resource="*",
              wa_id="wa_temp_001",
              granted_by="wa_root",
              granted_at=datetime.now(timezone.utc) - timedelta(days=31),
              expires_at=datetime.now(timezone.utc) - timedelta(days=1)  # Expired yesterday
          )

          # Check if permission is expired
          is_expired = expired_permission.expires_at < datetime.now(timezone.utc)
          assert is_expired is True

          # Authorization should fail for expired permission
          # In real implementation, check_authorization would validate expiration
E       fixture 'wa_service' not found
>       available fixtures: _session_event_loop, _session_faker, anyio_backend, anyio_backend_name, anyio_backend_options, api_port, api_required, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cleanup_after_test, cov, doctest_namespace, ensure_pydantic_models_rebuilt, event_loop, event_loop_policy, faker, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, monkeypatch, no_cover, pytestconfig, randomize_api_port, record_property, record_testsuite_property, record_xml_attribute, recwarn, runtime, sample_deferrals, service_registry, skip_without_discord_token, tests/test_deferral_permissions.py::<event_loop>, tests/test_deferral_permissions.py::TestDeferralRoleEnforcement::<event_loop>, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory
>       use 'pytest --fixtures [testpath]' for help on them.

/home/emoore/CIRISAgent/tests/test_deferral_permissions.py:426
_______________________________________________ ERROR at setup of TestDeferralAuditTrail.test_deferral_resolution_audit _______________________________________________
file /home/emoore/CIRISAgent/tests/test_deferral_permissions.py, line 458
      @pytest.mark.asyncio
      async def test_deferral_resolution_audit(self, wa_service):
          """Test that deferral resolutions are properly audited."""
          # Mock audit entries that would be created
          audit_entries = []

          # Resolution attempt
          resolution = DeferralResolution(
              deferral_id="defer_audit_001",
E       fixture 'wa_service' not found
>       available fixtures: _session_event_loop, _session_faker, anyio_backend, anyio_backend_name, anyio_backend_options, api_port, api_required, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cleanup_after_test, cov, doctest_namespace, ensure_pydantic_models_rebuilt, event_loop, event_loop_policy, faker, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, monkeypatch, no_cover, pytestconfig, randomize_api_port, record_property, record_testsuite_property, record_xml_attribute, recwarn, runtime, service_registry, skip_without_discord_token, tests/test_deferral_permissions.py::<event_loop>, tests/test_deferral_permissions.py::TestDeferralAuditTrail::<event_loop>, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory
>       use 'pytest --fixtures [testpath]' for help on them.

/home/emoore/CIRISAgent/tests/test_deferral_permissions.py:458
______________________________________________ ERROR at setup of TestDeferralAuditTrail.test_failed_authorization_audit _______________________________________________
file /home/emoore/CIRISAgent/tests/test_deferral_permissions.py, line 499
      @pytest.mark.asyncio
      async def test_failed_authorization_audit(self, wa_service):
          """Test that failed authorization attempts are audited."""
          # Mock unauthorized attempt
          unauthorized_attempt = {
              "timestamp": datetime.now(timezone.utc),
              "action": "deferral_resolution_denied",
              "actor": "wa_observer_001",
              "target": "defer_001",
              "reason": "insufficient_permissions",
              "details": {
                  "required_role": "AUTHORITY",
                  "actual_role": "OBSERVER",
                  "required_permission": "resolve_deferral"
              }
          }

          # This would be logged in the audit system
          assert unauthorized_attempt["reason"] == "insufficient_permissions"
          assert unauthorized_attempt["details"]["required_role"] == "AUTHORITY"
E       fixture 'wa_service' not found
>       available fixtures: _session_event_loop, _session_faker, anyio_backend, anyio_backend_name, anyio_backend_options, api_port, api_required, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cleanup_after_test, cov, doctest_namespace, ensure_pydantic_models_rebuilt, event_loop, event_loop_policy, faker, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, monkeypatch, no_cover, pytestconfig, randomize_api_port, record_property, record_testsuite_property, record_xml_attribute, recwarn, runtime, service_registry, skip_without_discord_token, tests/test_deferral_permissions.py::<event_loop>, tests/test_deferral_permissions.py::TestDeferralAuditTrail::<event_loop>, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory
>       use 'pytest --fixtures [testpath]' for help on them.

/home/emoore/CIRISAgent/tests/test_deferral_permissions.py:499
_____________________________________________ ERROR at setup of TestWiseBusErrorHandling.test_invalid_defer_until_format ______________________________________________
file /home/emoore/CIRISAgent/tests/test_wise_bus_deferrals.py, line 428
      @pytest.mark.asyncio
      async def test_invalid_defer_until_format(
          self,
          wise_bus,
          mock_time_service
      ):
          """Test handling of invalid defer_until timestamp."""
          # Arrange
          mock_service = MockWiseAuthorityService()
          wise_bus._service_registry.get_service = Mock(return_value=mock_service)

          context = DeferralContext(
              thought_id="thought_123",
              task_id="task_456",
              reason="Test",
              defer_until="invalid-timestamp",  # Invalid format
E       fixture 'mock_time_service' not found
>       available fixtures: _session_event_loop, _session_faker, anyio_backend, anyio_backend_name, anyio_backend_options, api_port, api_required, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cleanup_after_test, cov, doctest_namespace, ensure_pydantic_models_rebuilt, event_loop, event_loop_policy, faker, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, monkeypatch, no_cover, pytestconfig, randomize_api_port, record_property, record_testsuite_property, record_xml_attribute, recwarn, runtime, service_registry, skip_without_discord_token, tests/test_wise_bus_deferrals.py::<event_loop>, tests/test_wise_bus_deferrals.py::TestWiseBusErrorHandling::<event_loop>, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory, wise_bus
>       use 'pytest --fixtures [testpath]' for help on them.

/home/emoore/CIRISAgent/tests/test_wise_bus_deferrals.py:428
------------------------------------------------------------------------- Captured log setup --------------------------------------------------------------------------
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 WiseBus initialized for wise_authority
============================================================================== FAILURES ===============================================================================
_________________________________________________________ TestDiscordToolExecution.test_execute_tool_success __________________________________________________________
tests/adapters/test_discord/test_discord_adapter_comprehensive.py:313: in test_execute_tool_success
    mock_result = ToolExecutionResult(
E   pydantic_core._pydantic_core.ValidationError: 7 validation errors for ToolExecutionResult
E   tool_name
E     Field required [type=missing, input_value={'success': True, 'result...'adapter_id': 'discord'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   status
E     Field required [type=missing, input_value={'success': True, 'result...'adapter_id': 'discord'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   result
E     Input should be a valid dictionary or instance of ToolResult [type=model_type, input_value='Tool output', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/model_type
E   correlation_id
E     Field required [type=missing, input_value={'success': True, 'result...'adapter_id': 'discord'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   success
E     Extra inputs are not permitted [type=extra_forbidden, input_value=True, input_type=bool]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   execution_time
E     Extra inputs are not permitted [type=extra_forbidden, input_value=123.45, input_type=float]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   adapter_id
E     Extra inputs are not permitted [type=extra_forbidden, input_value='discord', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
_________________________________________________________________ TestDiscordAdapter.test_list_tools __________________________________________________________________
tests/adapters/test_discord/test_discord_adapter_unit.py:170: in test_list_tools
    ToolInfo(
E   pydantic_core._pydantic_core.ValidationError: 6 validation errors for ToolInfo
E   name
E     Field required [type=missing, input_value={'tool_name': 'test_tool'...cord', 'parameters': []}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   parameters
E     Input should be a valid dictionary or instance of ToolParameterSchema [type=model_type, input_value=[], input_type=list]
E       For further information visit https://errors.pydantic.dev/2.11/v/model_type
E   tool_name
E     Extra inputs are not permitted [type=extra_forbidden, input_value='test_tool', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   display_name
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Test Tool', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   adapter_id
E     Extra inputs are not permitted [type=extra_forbidden, input_value='discord', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   adapter_type
E     Extra inputs are not permitted [type=extra_forbidden, input_value='discord', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
________________________________________________________________ TestDiscordAdapter.test_execute_tool _________________________________________________________________
tests/adapters/test_discord/test_discord_adapter_unit.py:192: in test_execute_tool
    expected_result = ToolExecutionResult(
E   pydantic_core._pydantic_core.ValidationError: 7 validation errors for ToolExecutionResult
E   tool_name
E     Field required [type=missing, input_value={'success': True, 'result...'adapter_id': 'discord'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   status
E     Field required [type=missing, input_value={'success': True, 'result...'adapter_id': 'discord'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   result
E     Input should be a valid dictionary or instance of ToolResult [type=model_type, input_value='Test output', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/model_type
E   correlation_id
E     Field required [type=missing, input_value={'success': True, 'result...'adapter_id': 'discord'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   success
E     Extra inputs are not permitted [type=extra_forbidden, input_value=True, input_type=bool]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   execution_time
E     Extra inputs are not permitted [type=extra_forbidden, input_value=123.45, input_type=float]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   adapter_id
E     Extra inputs are not permitted [type=extra_forbidden, input_value='discord', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
_________________________________________________________ TestDiscordDeferrals.test_resolve_deferral_approve __________________________________________________________
tests/adapters/test_discord_deferrals.py:274: in test_resolve_deferral_approve
    response = await discord_adapter.handle_wa_command(message)
tests/adapters/test_discord_deferrals.py:117: in handle_wa_command
    wa_cert = await self._get_wa_cert(message.author.id)
tests/adapters/test_discord_deferrals.py:149: in _get_wa_cert
    return WACertificate(
E   pydantic_core._pydantic_core.ValidationError: 9 validation errors for WACertificate
E   wa_id
E     String should match pattern '^wa-\d{4}-\d{2}-\d{2}-[A-Z0-9]{6}$' [type=string_pattern_mismatch, input_value='wa_discord_wa_authority_discord', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/string_pattern_mismatch
E   pubkey
E     Field required [type=missing, input_value={'wa_id': 'wa_discord_wa_...ls'], 'is_active': True}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   jwt_kid
E     Field required [type=missing, input_value={'wa_id': 'wa_discord_wa_...ls'], 'is_active': True}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   scopes_json
E     Field required [type=missing, input_value={'wa_id': 'wa_discord_wa_...ls'], 'is_active': True}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   expires_at
E     Extra inputs are not permitted [type=extra_forbidden, input_value=datetime.datetime(2025, 7...o=datetime.timezone.utc), input_type=datetime]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   public_key
E     Extra inputs are not permitted [type=extra_forbidden, input_value='test_key', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   signature
E     Extra inputs are not permitted [type=extra_forbidden, input_value='test_sig', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   scopes
E     Extra inputs are not permitted [type=extra_forbidden, input_value=['resolve_deferrals'], input_type=list]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   is_active
E     Extra inputs are not permitted [type=extra_forbidden, input_value=True, input_type=bool]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
__________________________________________________________ TestDiscordDeferrals.test_resolve_deferral_reject __________________________________________________________
tests/adapters/test_discord_deferrals.py:300: in test_resolve_deferral_reject
    response = await discord_adapter.handle_wa_command(message)
tests/adapters/test_discord_deferrals.py:117: in handle_wa_command
    wa_cert = await self._get_wa_cert(message.author.id)
tests/adapters/test_discord_deferrals.py:149: in _get_wa_cert
    return WACertificate(
E   pydantic_core._pydantic_core.ValidationError: 9 validation errors for WACertificate
E   wa_id
E     String should match pattern '^wa-\d{4}-\d{2}-\d{2}-[A-Z0-9]{6}$' [type=string_pattern_mismatch, input_value='wa_discord_wa_authority_discord', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/string_pattern_mismatch
E   pubkey
E     Field required [type=missing, input_value={'wa_id': 'wa_discord_wa_...ls'], 'is_active': True}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   jwt_kid
E     Field required [type=missing, input_value={'wa_id': 'wa_discord_wa_...ls'], 'is_active': True}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   scopes_json
E     Field required [type=missing, input_value={'wa_id': 'wa_discord_wa_...ls'], 'is_active': True}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   expires_at
E     Extra inputs are not permitted [type=extra_forbidden, input_value=datetime.datetime(2025, 7...o=datetime.timezone.utc), input_type=datetime]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   public_key
E     Extra inputs are not permitted [type=extra_forbidden, input_value='test_key', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   signature
E     Extra inputs are not permitted [type=extra_forbidden, input_value='test_sig', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   scopes
E     Extra inputs are not permitted [type=extra_forbidden, input_value=['resolve_deferrals'], input_type=list]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   is_active
E     Extra inputs are not permitted [type=extra_forbidden, input_value=True, input_type=bool]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
_______________________________________________________ TestDiscordDeferrals.test_deferral_with_context_display _______________________________________________________
tests/adapters/test_discord_deferrals.py:395: in test_deferral_with_context_display
    assert "Priority: HIGH" in sent["content"]
E   AssertionError: assert 'Priority: HIGH' in '\n **Deferral Requiring Review** \n<@medical_wa_team>\n\n**Deferral ID**: `defer_context_001`\n**Priority**: HIGH\n**Reason**: Medical advice requested - requires licensed physician review\n**Task**: task_medical_001\n**Created**: 2025-06-27 19:17 UTC\n\n**Required Role**: MEDICAL_AUTHORITY\n\nTo resolve, use: `/wa resolve defer_context_001 [approve|reject|modify] [reason]`\n'
___________________________________________________ TestDiscordDeferrals.test_deferral_resolution_with_modification ___________________________________________________
tests/adapters/test_discord_deferrals.py:426: in test_deferral_resolution_with_modification
    response = await discord_adapter.handle_wa_command(message)
tests/adapters/test_discord_deferrals.py:117: in handle_wa_command
    wa_cert = await self._get_wa_cert(message.author.id)
tests/adapters/test_discord_deferrals.py:149: in _get_wa_cert
    return WACertificate(
E   pydantic_core._pydantic_core.ValidationError: 9 validation errors for WACertificate
E   wa_id
E     String should match pattern '^wa-\d{4}-\d{2}-\d{2}-[A-Z0-9]{6}$' [type=string_pattern_mismatch, input_value='wa_discord_wa_authority_discord', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/string_pattern_mismatch
E   pubkey
E     Field required [type=missing, input_value={'wa_id': 'wa_discord_wa_...ls'], 'is_active': True}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   jwt_kid
E     Field required [type=missing, input_value={'wa_id': 'wa_discord_wa_...ls'], 'is_active': True}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   scopes_json
E     Field required [type=missing, input_value={'wa_id': 'wa_discord_wa_...ls'], 'is_active': True}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   expires_at
E     Extra inputs are not permitted [type=extra_forbidden, input_value=datetime.datetime(2025, 7...o=datetime.timezone.utc), input_type=datetime]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   public_key
E     Extra inputs are not permitted [type=extra_forbidden, input_value='test_key', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   signature
E     Extra inputs are not permitted [type=extra_forbidden, input_value='test_sig', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   scopes
E     Extra inputs are not permitted [type=extra_forbidden, input_value=['resolve_deferrals'], input_type=list]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   is_active
E     Extra inputs are not permitted [type=extra_forbidden, input_value=True, input_type=bool]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
___________________________________________________ TestDiscordDeferralIntegration.test_full_discord_deferral_flow ____________________________________________________
tests/adapters/test_discord_deferrals.py:490: in test_full_discord_deferral_flow
    resolution_response = await discord_adapter.handle_wa_command(resolve_msg)
tests/adapters/test_discord_deferrals.py:117: in handle_wa_command
    wa_cert = await self._get_wa_cert(message.author.id)
tests/adapters/test_discord_deferrals.py:149: in _get_wa_cert
    return WACertificate(
E   pydantic_core._pydantic_core.ValidationError: 9 validation errors for WACertificate
E   wa_id
E     String should match pattern '^wa-\d{4}-\d{2}-\d{2}-[A-Z0-9]{6}$' [type=string_pattern_mismatch, input_value='wa_discord_wa_authority_discord', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/string_pattern_mismatch
E   pubkey
E     Field required [type=missing, input_value={'wa_id': 'wa_discord_wa_...ls'], 'is_active': True}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   jwt_kid
E     Field required [type=missing, input_value={'wa_id': 'wa_discord_wa_...ls'], 'is_active': True}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   scopes_json
E     Field required [type=missing, input_value={'wa_id': 'wa_discord_wa_...ls'], 'is_active': True}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   expires_at
E     Extra inputs are not permitted [type=extra_forbidden, input_value=datetime.datetime(2025, 7...o=datetime.timezone.utc), input_type=datetime]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   public_key
E     Extra inputs are not permitted [type=extra_forbidden, input_value='test_key', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   signature
E     Extra inputs are not permitted [type=extra_forbidden, input_value='test_sig', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   scopes
E     Extra inputs are not permitted [type=extra_forbidden, input_value=['resolve_deferrals'], input_type=list]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   is_active
E     Extra inputs are not permitted [type=extra_forbidden, input_value=True, input_type=bool]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
________________________________________________________ TestMockLLMComprehensive.test_action_selection_result ________________________________________________________
tests/adapters/test_mock_llm_comprehensive.py:69: in test_action_selection_result
    response = await mock_client._create(response_model=ActionSelectionDMAResult)
tests/adapters/mock_llm/service.py:64: in _create
    response = create_response(response_model, messages=messages, **filtered_kwargs)
tests/adapters/mock_llm/responses.py:388: in create_response
    result = handler(context=context)
tests/adapters/mock_llm/responses_action_selection.py:365: in action_selection
    result = ActionSelectionDMAResult(
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for ActionSelectionDMAResult
E   confidence
E     Extra inputs are not permitted [type=extra_forbidden, input_value=0.9, input_type=float]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
_______________________________________________________ TestMockLLMComprehensive.test_all_schemas_serializable ________________________________________________________
tests/adapters/test_mock_llm_comprehensive.py:163: in test_all_schemas_serializable
    response = await mock_client._create(response_model=schema)
tests/adapters/mock_llm/service.py:64: in _create
    response = create_response(response_model, messages=messages, **filtered_kwargs)
tests/adapters/mock_llm/responses.py:388: in create_response
    result = handler(context=context)
tests/adapters/mock_llm/responses_action_selection.py:365: in action_selection
    result = ActionSelectionDMAResult(
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for ActionSelectionDMAResult
E   confidence
E     Extra inputs are not permitted [type=extra_forbidden, input_value=0.9, input_type=float]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
_______________________________________________________ TestMockLLMComprehensive.test_mock_response_consistency _______________________________________________________
tests/adapters/test_mock_llm_comprehensive.py:180: in test_mock_response_consistency
    response1 = await mock_client._create(response_model=ActionSelectionDMAResult)
tests/adapters/mock_llm/service.py:64: in _create
    response = create_response(response_model, messages=messages, **filtered_kwargs)
tests/adapters/mock_llm/responses.py:388: in create_response
    result = handler(context=context)
tests/adapters/mock_llm/responses_action_selection.py:365: in action_selection
    result = ActionSelectionDMAResult(
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for ActionSelectionDMAResult
E   confidence
E     Extra inputs are not permitted [type=extra_forbidden, input_value=0.9, input_type=float]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
__________________________________________________________________ test_mock_llm_structured_outputs ___________________________________________________________________
tests/adapters/test_mock_llm_service.py:16: in test_mock_llm_structured_outputs
    assert isinstance(await client._create(response_model=ActionSelectionDMAResult), ActionSelectionDMAResult)
tests/adapters/mock_llm/service.py:64: in _create
    response = create_response(response_model, messages=messages, **filtered_kwargs)
tests/adapters/mock_llm/responses.py:388: in create_response
    result = handler(context=context)
tests/adapters/mock_llm/responses_action_selection.py:365: in action_selection
    result = ActionSelectionDMAResult(
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for ActionSelectionDMAResult
E   confidence
E     Extra inputs are not permitted [type=extra_forbidden, input_value=0.9, input_type=float]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
____________________________________________________________ TestPatternEndpoint.test_get_patterns_success ____________________________________________________________
tests/api/routes/test_adaptation.py:103: in test_get_patterns_success
    assert response.status_code == 200
E   assert 500 == 200
E    +  where 500 = <Response [500 Internal Server Error]>.status_code
_________________________________________________________ TestPatternEndpoint.test_get_patterns_with_filters __________________________________________________________
tests/api/routes/test_adaptation.py:128: in test_get_patterns_with_filters
    assert response.status_code == 200
E   assert 500 == 200
E    +  where 500 = <Response [500 Internal Server Error]>.status_code
______________________________________________________ TestPatternEndpoint.test_get_patterns_service_unavailable ______________________________________________________
tests/api/routes/test_adaptation.py:143: in test_get_patterns_service_unavailable
    assert response.status_code == 503
E   assert 500 == 503
E    +  where 500 = <Response [500 Internal Server Error]>.status_code
___________________________________________________________ TestInsightsEndpoint.test_get_insights_success ____________________________________________________________
tests/api/routes/test_adaptation.py:170: in test_get_insights_success
    assert response.status_code == 200
E   assert 500 == 200
E    +  where 500 = <Response [500 Internal Server Error]>.status_code
__________________________________________________________ TestInsightsEndpoint.test_get_insights_with_limit __________________________________________________________
tests/api/routes/test_adaptation.py:189: in test_get_insights_with_limit
    assert response.status_code == 200
E   assert 500 == 200
E    +  where 500 = <Response [500 Internal Server Error]>.status_code
____________________________________________________________ TestHistoryEndpoint.test_get_history_success _____________________________________________________________
tests/api/routes/test_adaptation.py:216: in test_get_history_success
    assert response.status_code == 200
E   assert 500 == 200
E    +  where 500 = <Response [500 Internal Server Error]>.status_code
________________________________________________________ TestHistoryEndpoint.test_get_history_filters_by_time _________________________________________________________
tests/api/routes/test_adaptation.py:247: in test_get_history_filters_by_time
    assert response.status_code == 200
E   assert 500 == 200
E    +  where 500 = <Response [500 Internal Server Error]>.status_code
______________________________________________________ TestEffectivenessEndpoint.test_get_effectiveness_success _______________________________________________________
tests/api/routes/test_adaptation.py:272: in test_get_effectiveness_success
    assert response.status_code == 200
E   assert 500 == 200
E    +  where 500 = <Response [500 Internal Server Error]>.status_code
____________________________________________________ TestEffectivenessEndpoint.test_get_effectiveness_no_patterns _____________________________________________________
tests/api/routes/test_adaptation.py:289: in test_get_effectiveness_no_patterns
    assert response.status_code == 200
E   assert 500 == 200
E    +  where 500 = <Response [500 Internal Server Error]>.status_code
_______________________________________________________ TestCorrelationsEndpoint.test_get_correlations_success ________________________________________________________
tests/api/routes/test_adaptation.py:320: in test_get_correlations_success
    assert response.status_code == 200
E   assert 500 == 200
E    +  where 500 = <Response [500 Internal Server Error]>.status_code
_________________________________________________ TestCorrelationsEndpoint.test_get_correlations_with_min_confidence __________________________________________________
tests/api/routes/test_adaptation.py:339: in test_get_correlations_with_min_confidence
    assert response.status_code == 200
E   assert 500 == 200
E    +  where 500 = <Response [500 Internal Server Error]>.status_code
_____________________________________________________________ TestReportEndpoint.test_get_report_success ______________________________________________________________
tests/api/routes/test_adaptation.py:368: in test_get_report_success
    assert response.status_code == 200
E   assert 500 == 200
E    +  where 500 = <Response [500 Internal Server Error]>.status_code
__________________________________________________________ TestReportEndpoint.test_get_report_service_error ___________________________________________________________
tests/api/routes/test_adaptation.py:388: in test_get_report_service_error
    assert "Service error" in response.json()["detail"]
E   AssertionError: assert 'Service error' in 'Auth service not initialized'
________________________________________________________ TestServiceUnavailable.test_all_endpoints_return_503 _________________________________________________________
tests/api/routes/test_adaptation.py:411: in test_all_endpoints_return_503
    assert response.status_code == 503, f"Expected 503 for {endpoint}"
E   AssertionError: Expected 503 for /v1/adaptation/patterns
E   assert 500 == 503
E    +  where 500 = <Response [500 Internal Server Error]>.status_code
______________________________________________________ TestEmergencyEndpoint.test_shutdown_with_runtime_service _______________________________________________________
../.local/lib/python3.12/site-packages/pytest_asyncio/plugin.py:549: in runtest
    super().runtest()
../.local/lib/python3.12/site-packages/pytest_asyncio/plugin.py:1069: in inner
    _loop.run_until_complete(task)
/usr/lib/python3.12/asyncio/base_events.py:687: in run_until_complete
    return future.result()
/usr/lib/python3.12/unittest/mock.py:1404: in patched
    with self.decoration_helper(patched,
/usr/lib/python3.12/contextlib.py:137: in __enter__
    return next(self.gen)
/usr/lib/python3.12/unittest/mock.py:1369: in decoration_helper
    arg = exit_stack.enter_context(patching)
/usr/lib/python3.12/contextlib.py:526: in enter_context
    result = _enter(cm)
/usr/lib/python3.12/unittest/mock.py:1442: in __enter__
    self.target = self.getter()
/usr/lib/python3.12/pkgutil.py:528: in resolve_name
    result = getattr(result, p)
E   AttributeError: module 'ciris_engine.logic.services' has no attribute 'registry'
_____________________________________________________ TestEmergencyEndpoint.test_shutdown_without_runtime_service _____________________________________________________
/usr/lib/python3.12/unittest/mock.py:1387: in patched
    with self.decoration_helper(patched,
/usr/lib/python3.12/contextlib.py:137: in __enter__
    return next(self.gen)
/usr/lib/python3.12/unittest/mock.py:1369: in decoration_helper
    arg = exit_stack.enter_context(patching)
/usr/lib/python3.12/contextlib.py:526: in enter_context
    result = _enter(cm)
/usr/lib/python3.12/unittest/mock.py:1442: in __enter__
    self.target = self.getter()
/usr/lib/python3.12/pkgutil.py:528: in resolve_name
    result = getattr(result, p)
E   AttributeError: module 'ciris_engine.logic.services' has no attribute 'registry'
_________________________________________________________ TestInitializationStatus.test_get_status_no_service _________________________________________________________
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../.local/lib/python3.12/site-packages/starlette/routing.py:73: in app
    response = await f(request)
../.local/lib/python3.12/site-packages/fastapi/routing.py:301: in app
    raw_response = await run_endpoint_function(
../.local/lib/python3.12/site-packages/fastapi/routing.py:212: in run_endpoint_function
    return await dependant.call(**values)
ciris_engine/api/routes/init.py:68: in get_initialization_status
    raise HTTPException(
E   fastapi.exceptions.HTTPException: 503: {'error': {'code': 'SERVICE_UNAVAILABLE', 'message': 'Initialization service not available', 'details': None}, 'metadata': {'timestamp': datetime.datetime(2025, 6, 27, 19, 18, 13, 614962, tzinfo=datetime.timezone.utc), 'request_id': None, 'duration_ms': None}}

During handling of the above exception, another exception occurred:
tests/api/routes/test_init.py:142: in test_get_status_no_service
    response = client.get("/v1/init/status")
../.local/lib/python3.12/site-packages/starlette/testclient.py:465: in get
    return super().get(
../.local/lib/python3.12/site-packages/httpx/_client.py:1053: in get
    return self.request(
../.local/lib/python3.12/site-packages/starlette/testclient.py:437: in request
    return super().request(
../.local/lib/python3.12/site-packages/httpx/_client.py:825: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
../.local/lib/python3.12/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
../.local/lib/python3.12/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
../.local/lib/python3.12/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
../.local/lib/python3.12/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
../.local/lib/python3.12/site-packages/starlette/testclient.py:340: in handle_request
    raise exc
../.local/lib/python3.12/site-packages/starlette/testclient.py:337: in handle_request
    portal.call(self.app, scope, receive, send)
../.local/lib/python3.12/site-packages/anyio/from_thread.py:290: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
/usr/lib/python3.12/concurrent/futures/_base.py:449: in result
    return self.__get_result()
/usr/lib/python3.12/concurrent/futures/_base.py:401: in __get_result
    raise self._exception
../.local/lib/python3.12/site-packages/anyio/from_thread.py:221: in _call_func
    retval = await retval_or_awaitable
../.local/lib/python3.12/site-packages/fastapi/applications.py:1054: in __call__
    await super().__call__(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/applications.py:112: in __call__
    await self.middleware_stack(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/middleware/errors.py:187: in __call__
    raise exc
../.local/lib/python3.12/site-packages/starlette/middleware/errors.py:165: in __call__
    await self.app(scope, receive, _send)
../.local/lib/python3.12/site-packages/starlette/middleware/exceptions.py:62: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../.local/lib/python3.12/site-packages/starlette/routing.py:714: in __call__
    await self.middleware_stack(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:734: in app
    await route.handle(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:288: in handle
    await self.app(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:76: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:59: in wrapped_app
    response = await handler(conn, exc)
../.local/lib/python3.12/site-packages/fastapi/exception_handlers.py:15: in http_exception_handler
    return JSONResponse(
../.local/lib/python3.12/site-packages/starlette/responses.py:182: in __init__
    super().__init__(content, status_code, headers, media_type, background)
../.local/lib/python3.12/site-packages/starlette/responses.py:45: in __init__
    self.body = self.render(content)
../.local/lib/python3.12/site-packages/starlette/responses.py:185: in render
    return json.dumps(
/usr/lib/python3.12/json/__init__.py:238: in dumps
    **kw).encode(obj)
/usr/lib/python3.12/json/encoder.py:200: in encode
    chunks = self.iterencode(o, _one_shot=True)
/usr/lib/python3.12/json/encoder.py:258: in iterencode
    return _iterencode(o, 0)
/usr/lib/python3.12/json/encoder.py:180: in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
E   TypeError: Object of type datetime is not JSON serializable
_______________________________________________________ TestInitializationStatus.test_get_status_service_error ________________________________________________________
ciris_engine/api/routes/init.py:81: in get_initialization_status
    status = await init_service.get_initialization_status()
/usr/lib/python3.12/unittest/mock.py:2262: in _execute_mock_call
    raise effect
E   Exception: Service error

During handling of the above exception, another exception occurred:
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../.local/lib/python3.12/site-packages/starlette/routing.py:73: in app
    response = await f(request)
../.local/lib/python3.12/site-packages/fastapi/routing.py:301: in app
    raw_response = await run_endpoint_function(
../.local/lib/python3.12/site-packages/fastapi/routing.py:212: in run_endpoint_function
    return await dependant.call(**values)
ciris_engine/api/routes/init.py:84: in get_initialization_status
    raise HTTPException(
E   fastapi.exceptions.HTTPException: 500: {'error': {'code': 'INTERNAL_ERROR', 'message': 'Failed to get initialization status: Service error', 'details': None}, 'metadata': {'timestamp': datetime.datetime(2025, 6, 27, 19, 18, 13, 902304, tzinfo=datetime.timezone.utc), 'request_id': None, 'duration_ms': None}}

During handling of the above exception, another exception occurred:
tests/api/routes/test_init.py:156: in test_get_status_service_error
    response = client.get("/v1/init/status")
../.local/lib/python3.12/site-packages/starlette/testclient.py:465: in get
    return super().get(
../.local/lib/python3.12/site-packages/httpx/_client.py:1053: in get
    return self.request(
../.local/lib/python3.12/site-packages/starlette/testclient.py:437: in request
    return super().request(
../.local/lib/python3.12/site-packages/httpx/_client.py:825: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
../.local/lib/python3.12/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
../.local/lib/python3.12/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
../.local/lib/python3.12/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
../.local/lib/python3.12/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
../.local/lib/python3.12/site-packages/starlette/testclient.py:340: in handle_request
    raise exc
../.local/lib/python3.12/site-packages/starlette/testclient.py:337: in handle_request
    portal.call(self.app, scope, receive, send)
../.local/lib/python3.12/site-packages/anyio/from_thread.py:290: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
/usr/lib/python3.12/concurrent/futures/_base.py:449: in result
    return self.__get_result()
/usr/lib/python3.12/concurrent/futures/_base.py:401: in __get_result
    raise self._exception
../.local/lib/python3.12/site-packages/anyio/from_thread.py:221: in _call_func
    retval = await retval_or_awaitable
../.local/lib/python3.12/site-packages/fastapi/applications.py:1054: in __call__
    await super().__call__(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/applications.py:112: in __call__
    await self.middleware_stack(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/middleware/errors.py:187: in __call__
    raise exc
../.local/lib/python3.12/site-packages/starlette/middleware/errors.py:165: in __call__
    await self.app(scope, receive, _send)
../.local/lib/python3.12/site-packages/starlette/middleware/exceptions.py:62: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../.local/lib/python3.12/site-packages/starlette/routing.py:714: in __call__
    await self.middleware_stack(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:734: in app
    await route.handle(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:288: in handle
    await self.app(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:76: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:59: in wrapped_app
    response = await handler(conn, exc)
../.local/lib/python3.12/site-packages/fastapi/exception_handlers.py:15: in http_exception_handler
    return JSONResponse(
../.local/lib/python3.12/site-packages/starlette/responses.py:182: in __init__
    super().__init__(content, status_code, headers, media_type, background)
../.local/lib/python3.12/site-packages/starlette/responses.py:45: in __init__
    self.body = self.render(content)
../.local/lib/python3.12/site-packages/starlette/responses.py:185: in render
    return json.dumps(
/usr/lib/python3.12/json/__init__.py:238: in dumps
    **kw).encode(obj)
/usr/lib/python3.12/json/encoder.py:200: in encode
    chunks = self.iterencode(o, _one_shot=True)
/usr/lib/python3.12/json/encoder.py:258: in iterencode
    return _iterencode(o, 0)
/usr/lib/python3.12/json/encoder.py:180: in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
E   TypeError: Object of type datetime is not JSON serializable
__________________________________________________________________ test_get_resource_limits_success ___________________________________________________________________
tests/api/routes/test_resources.py:87: in test_get_resource_limits_success
    response = client.get("/v1/resources/limits")
../.local/lib/python3.12/site-packages/starlette/testclient.py:465: in get
    return super().get(
../.local/lib/python3.12/site-packages/httpx/_client.py:1053: in get
    return self.request(
../.local/lib/python3.12/site-packages/starlette/testclient.py:437: in request
    return super().request(
../.local/lib/python3.12/site-packages/httpx/_client.py:825: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
../.local/lib/python3.12/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
../.local/lib/python3.12/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
../.local/lib/python3.12/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
../.local/lib/python3.12/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
../.local/lib/python3.12/site-packages/starlette/testclient.py:340: in handle_request
    raise exc
../.local/lib/python3.12/site-packages/starlette/testclient.py:337: in handle_request
    portal.call(self.app, scope, receive, send)
../.local/lib/python3.12/site-packages/anyio/from_thread.py:290: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
/usr/lib/python3.12/concurrent/futures/_base.py:449: in result
    return self.__get_result()
/usr/lib/python3.12/concurrent/futures/_base.py:401: in __get_result
    raise self._exception
../.local/lib/python3.12/site-packages/anyio/from_thread.py:221: in _call_func
    retval = await retval_or_awaitable
../.local/lib/python3.12/site-packages/fastapi/applications.py:1054: in __call__
    await super().__call__(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/applications.py:112: in __call__
    await self.middleware_stack(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/middleware/errors.py:187: in __call__
    raise exc
../.local/lib/python3.12/site-packages/starlette/middleware/errors.py:165: in __call__
    await self.app(scope, receive, _send)
../.local/lib/python3.12/site-packages/starlette/middleware/exceptions.py:62: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../.local/lib/python3.12/site-packages/starlette/routing.py:714: in __call__
    await self.middleware_stack(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:734: in app
    await route.handle(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:288: in handle
    await self.app(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:76: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../.local/lib/python3.12/site-packages/starlette/routing.py:73: in app
    response = await f(request)
../.local/lib/python3.12/site-packages/fastapi/routing.py:291: in app
    solved_result = await solve_dependencies(
../.local/lib/python3.12/site-packages/fastapi/dependencies/utils.py:638: in solve_dependencies
    solved = await call(**solved_result.values)
tests/api/routes/test_resources.py:60: in mock_observer
    return AuthContext(
E   pydantic_core._pydantic_core.ValidationError: 2 validation errors for AuthContext
E   permissions.0
E     Input should be 'view_messages', 'view_telemetry', 'view_reasoning', 'view_config', 'view_memory', 'view_audit', 'view_tools', 'manage_config', 'runtime_control', 'manage_incidents', 'manage_tasks', 'manage_filters', 'trigger_analysis', 'resolve_deferrals', 'provide_guidance', 'grant_permissions', 'full_access', 'emergency_shutdown' or 'manage_sensitive_config' [type=enum, input_value='read', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/enum
E   authenticated_at
E     Field required [type=missing, input_value={'user_id': 'test_user', ...'permissions': ['read']}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
_________________________________________________________________ test_get_resource_limits_no_service _________________________________________________________________
tests/api/routes/test_resources.py:112: in test_get_resource_limits_no_service
    response = client.get("/v1/resources/limits")
../.local/lib/python3.12/site-packages/starlette/testclient.py:465: in get
    return super().get(
../.local/lib/python3.12/site-packages/httpx/_client.py:1053: in get
    return self.request(
../.local/lib/python3.12/site-packages/starlette/testclient.py:437: in request
    return super().request(
../.local/lib/python3.12/site-packages/httpx/_client.py:825: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
../.local/lib/python3.12/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
../.local/lib/python3.12/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
../.local/lib/python3.12/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
../.local/lib/python3.12/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
../.local/lib/python3.12/site-packages/starlette/testclient.py:340: in handle_request
    raise exc
../.local/lib/python3.12/site-packages/starlette/testclient.py:337: in handle_request
    portal.call(self.app, scope, receive, send)
../.local/lib/python3.12/site-packages/anyio/from_thread.py:290: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
/usr/lib/python3.12/concurrent/futures/_base.py:449: in result
    return self.__get_result()
/usr/lib/python3.12/concurrent/futures/_base.py:401: in __get_result
    raise self._exception
../.local/lib/python3.12/site-packages/anyio/from_thread.py:221: in _call_func
    retval = await retval_or_awaitable
../.local/lib/python3.12/site-packages/fastapi/applications.py:1054: in __call__
    await super().__call__(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/applications.py:112: in __call__
    await self.middleware_stack(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/middleware/errors.py:187: in __call__
    raise exc
../.local/lib/python3.12/site-packages/starlette/middleware/errors.py:165: in __call__
    await self.app(scope, receive, _send)
../.local/lib/python3.12/site-packages/starlette/middleware/exceptions.py:62: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../.local/lib/python3.12/site-packages/starlette/routing.py:714: in __call__
    await self.middleware_stack(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:734: in app
    await route.handle(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:288: in handle
    await self.app(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:76: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../.local/lib/python3.12/site-packages/starlette/routing.py:73: in app
    response = await f(request)
../.local/lib/python3.12/site-packages/fastapi/routing.py:291: in app
    solved_result = await solve_dependencies(
../.local/lib/python3.12/site-packages/fastapi/dependencies/utils.py:638: in solve_dependencies
    solved = await call(**solved_result.values)
tests/api/routes/test_resources.py:60: in mock_observer
    return AuthContext(
E   pydantic_core._pydantic_core.ValidationError: 2 validation errors for AuthContext
E   permissions.0
E     Input should be 'view_messages', 'view_telemetry', 'view_reasoning', 'view_config', 'view_memory', 'view_audit', 'view_tools', 'manage_config', 'runtime_control', 'manage_incidents', 'manage_tasks', 'manage_filters', 'trigger_analysis', 'resolve_deferrals', 'provide_guidance', 'grant_permissions', 'full_access', 'emergency_shutdown' or 'manage_sensitive_config' [type=enum, input_value='read', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/enum
E   authenticated_at
E     Field required [type=missing, input_value={'user_id': 'test_user', ...'permissions': ['read']}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
___________________________________________________________________ test_get_resource_usage_success ___________________________________________________________________
tests/api/routes/test_resources.py:121: in test_get_resource_usage_success
    response = client.get("/v1/resources/usage")
../.local/lib/python3.12/site-packages/starlette/testclient.py:465: in get
    return super().get(
../.local/lib/python3.12/site-packages/httpx/_client.py:1053: in get
    return self.request(
../.local/lib/python3.12/site-packages/starlette/testclient.py:437: in request
    return super().request(
../.local/lib/python3.12/site-packages/httpx/_client.py:825: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
../.local/lib/python3.12/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
../.local/lib/python3.12/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
../.local/lib/python3.12/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
../.local/lib/python3.12/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
../.local/lib/python3.12/site-packages/starlette/testclient.py:340: in handle_request
    raise exc
../.local/lib/python3.12/site-packages/starlette/testclient.py:337: in handle_request
    portal.call(self.app, scope, receive, send)
../.local/lib/python3.12/site-packages/anyio/from_thread.py:290: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
/usr/lib/python3.12/concurrent/futures/_base.py:449: in result
    return self.__get_result()
/usr/lib/python3.12/concurrent/futures/_base.py:401: in __get_result
    raise self._exception
../.local/lib/python3.12/site-packages/anyio/from_thread.py:221: in _call_func
    retval = await retval_or_awaitable
../.local/lib/python3.12/site-packages/fastapi/applications.py:1054: in __call__
    await super().__call__(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/applications.py:112: in __call__
    await self.middleware_stack(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/middleware/errors.py:187: in __call__
    raise exc
../.local/lib/python3.12/site-packages/starlette/middleware/errors.py:165: in __call__
    await self.app(scope, receive, _send)
../.local/lib/python3.12/site-packages/starlette/middleware/exceptions.py:62: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../.local/lib/python3.12/site-packages/starlette/routing.py:714: in __call__
    await self.middleware_stack(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:734: in app
    await route.handle(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:288: in handle
    await self.app(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:76: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../.local/lib/python3.12/site-packages/starlette/routing.py:73: in app
    response = await f(request)
../.local/lib/python3.12/site-packages/fastapi/routing.py:291: in app
    solved_result = await solve_dependencies(
../.local/lib/python3.12/site-packages/fastapi/dependencies/utils.py:638: in solve_dependencies
    solved = await call(**solved_result.values)
tests/api/routes/test_resources.py:60: in mock_observer
    return AuthContext(
E   pydantic_core._pydantic_core.ValidationError: 2 validation errors for AuthContext
E   permissions.0
E     Input should be 'view_messages', 'view_telemetry', 'view_reasoning', 'view_config', 'view_memory', 'view_audit', 'view_tools', 'manage_config', 'runtime_control', 'manage_incidents', 'manage_tasks', 'manage_filters', 'trigger_analysis', 'resolve_deferrals', 'provide_guidance', 'grant_permissions', 'full_access', 'emergency_shutdown' or 'manage_sensitive_config' [type=enum, input_value='read', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/enum
E   authenticated_at
E     Field required [type=missing, input_value={'user_id': 'test_user', ...'permissions': ['read']}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
_________________________________________________________________ test_get_resource_usage_no_service __________________________________________________________________
tests/api/routes/test_resources.py:142: in test_get_resource_usage_no_service
    response = client.get("/v1/resources/usage")
../.local/lib/python3.12/site-packages/starlette/testclient.py:465: in get
    return super().get(
../.local/lib/python3.12/site-packages/httpx/_client.py:1053: in get
    return self.request(
../.local/lib/python3.12/site-packages/starlette/testclient.py:437: in request
    return super().request(
../.local/lib/python3.12/site-packages/httpx/_client.py:825: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
../.local/lib/python3.12/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
../.local/lib/python3.12/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
../.local/lib/python3.12/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
../.local/lib/python3.12/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
../.local/lib/python3.12/site-packages/starlette/testclient.py:340: in handle_request
    raise exc
../.local/lib/python3.12/site-packages/starlette/testclient.py:337: in handle_request
    portal.call(self.app, scope, receive, send)
../.local/lib/python3.12/site-packages/anyio/from_thread.py:290: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
/usr/lib/python3.12/concurrent/futures/_base.py:456: in result
    return self.__get_result()
/usr/lib/python3.12/concurrent/futures/_base.py:401: in __get_result
    raise self._exception
../.local/lib/python3.12/site-packages/anyio/from_thread.py:221: in _call_func
    retval = await retval_or_awaitable
../.local/lib/python3.12/site-packages/fastapi/applications.py:1054: in __call__
    await super().__call__(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/applications.py:112: in __call__
    await self.middleware_stack(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/middleware/errors.py:187: in __call__
    raise exc
../.local/lib/python3.12/site-packages/starlette/middleware/errors.py:165: in __call__
    await self.app(scope, receive, _send)
../.local/lib/python3.12/site-packages/starlette/middleware/exceptions.py:62: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../.local/lib/python3.12/site-packages/starlette/routing.py:714: in __call__
    await self.middleware_stack(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:734: in app
    await route.handle(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:288: in handle
    await self.app(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:76: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../.local/lib/python3.12/site-packages/starlette/routing.py:73: in app
    response = await f(request)
../.local/lib/python3.12/site-packages/fastapi/routing.py:291: in app
    solved_result = await solve_dependencies(
../.local/lib/python3.12/site-packages/fastapi/dependencies/utils.py:638: in solve_dependencies
    solved = await call(**solved_result.values)
tests/api/routes/test_resources.py:60: in mock_observer
    return AuthContext(
E   pydantic_core._pydantic_core.ValidationError: 2 validation errors for AuthContext
E   permissions.0
E     Input should be 'view_messages', 'view_telemetry', 'view_reasoning', 'view_config', 'view_memory', 'view_audit', 'view_tools', 'manage_config', 'runtime_control', 'manage_incidents', 'manage_tasks', 'manage_filters', 'trigger_analysis', 'resolve_deferrals', 'provide_guidance', 'grant_permissions', 'full_access', 'emergency_shutdown' or 'manage_sensitive_config' [type=enum, input_value='read', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/enum
E   authenticated_at
E     Field required [type=missing, input_value={'user_id': 'test_user', ...'permissions': ['read']}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
__________________________________________________________________ test_get_resource_alerts_success ___________________________________________________________________
tests/api/routes/test_resources.py:150: in test_get_resource_alerts_success
    response = client.get("/v1/resources/alerts")
../.local/lib/python3.12/site-packages/starlette/testclient.py:465: in get
    return super().get(
../.local/lib/python3.12/site-packages/httpx/_client.py:1053: in get
    return self.request(
../.local/lib/python3.12/site-packages/starlette/testclient.py:437: in request
    return super().request(
../.local/lib/python3.12/site-packages/httpx/_client.py:825: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
../.local/lib/python3.12/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
../.local/lib/python3.12/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
../.local/lib/python3.12/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
../.local/lib/python3.12/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
../.local/lib/python3.12/site-packages/starlette/testclient.py:340: in handle_request
    raise exc
../.local/lib/python3.12/site-packages/starlette/testclient.py:337: in handle_request
    portal.call(self.app, scope, receive, send)
../.local/lib/python3.12/site-packages/anyio/from_thread.py:290: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
/usr/lib/python3.12/concurrent/futures/_base.py:449: in result
    return self.__get_result()
/usr/lib/python3.12/concurrent/futures/_base.py:401: in __get_result
    raise self._exception
../.local/lib/python3.12/site-packages/anyio/from_thread.py:221: in _call_func
    retval = await retval_or_awaitable
../.local/lib/python3.12/site-packages/fastapi/applications.py:1054: in __call__
    await super().__call__(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/applications.py:112: in __call__
    await self.middleware_stack(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/middleware/errors.py:187: in __call__
    raise exc
../.local/lib/python3.12/site-packages/starlette/middleware/errors.py:165: in __call__
    await self.app(scope, receive, _send)
../.local/lib/python3.12/site-packages/starlette/middleware/exceptions.py:62: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../.local/lib/python3.12/site-packages/starlette/routing.py:714: in __call__
    await self.middleware_stack(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:734: in app
    await route.handle(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:288: in handle
    await self.app(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:76: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../.local/lib/python3.12/site-packages/starlette/routing.py:73: in app
    response = await f(request)
../.local/lib/python3.12/site-packages/fastapi/routing.py:291: in app
    solved_result = await solve_dependencies(
../.local/lib/python3.12/site-packages/fastapi/dependencies/utils.py:638: in solve_dependencies
    solved = await call(**solved_result.values)
tests/api/routes/test_resources.py:60: in mock_observer
    return AuthContext(
E   pydantic_core._pydantic_core.ValidationError: 2 validation errors for AuthContext
E   permissions.0
E     Input should be 'view_messages', 'view_telemetry', 'view_reasoning', 'view_config', 'view_memory', 'view_audit', 'view_tools', 'manage_config', 'runtime_control', 'manage_incidents', 'manage_tasks', 'manage_filters', 'trigger_analysis', 'resolve_deferrals', 'provide_guidance', 'grant_permissions', 'full_access', 'emergency_shutdown' or 'manage_sensitive_config' [type=enum, input_value='read', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/enum
E   authenticated_at
E     Field required [type=missing, input_value={'user_id': 'test_user', ...'permissions': ['read']}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
_______________________________________________________________ test_get_resource_alerts_with_critical ________________________________________________________________
tests/api/routes/test_resources.py:176: in test_get_resource_alerts_with_critical
    response = client.get("/v1/resources/alerts")
../.local/lib/python3.12/site-packages/starlette/testclient.py:465: in get
    return super().get(
../.local/lib/python3.12/site-packages/httpx/_client.py:1053: in get
    return self.request(
../.local/lib/python3.12/site-packages/starlette/testclient.py:437: in request
    return super().request(
../.local/lib/python3.12/site-packages/httpx/_client.py:825: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
../.local/lib/python3.12/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
../.local/lib/python3.12/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
../.local/lib/python3.12/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
../.local/lib/python3.12/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
../.local/lib/python3.12/site-packages/starlette/testclient.py:340: in handle_request
    raise exc
../.local/lib/python3.12/site-packages/starlette/testclient.py:337: in handle_request
    portal.call(self.app, scope, receive, send)
../.local/lib/python3.12/site-packages/anyio/from_thread.py:290: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
/usr/lib/python3.12/concurrent/futures/_base.py:449: in result
    return self.__get_result()
/usr/lib/python3.12/concurrent/futures/_base.py:401: in __get_result
    raise self._exception
../.local/lib/python3.12/site-packages/anyio/from_thread.py:221: in _call_func
    retval = await retval_or_awaitable
../.local/lib/python3.12/site-packages/fastapi/applications.py:1054: in __call__
    await super().__call__(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/applications.py:112: in __call__
    await self.middleware_stack(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/middleware/errors.py:187: in __call__
    raise exc
../.local/lib/python3.12/site-packages/starlette/middleware/errors.py:165: in __call__
    await self.app(scope, receive, _send)
../.local/lib/python3.12/site-packages/starlette/middleware/exceptions.py:62: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../.local/lib/python3.12/site-packages/starlette/routing.py:714: in __call__
    await self.middleware_stack(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:734: in app
    await route.handle(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:288: in handle
    await self.app(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:76: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../.local/lib/python3.12/site-packages/starlette/routing.py:73: in app
    response = await f(request)
../.local/lib/python3.12/site-packages/fastapi/routing.py:291: in app
    solved_result = await solve_dependencies(
../.local/lib/python3.12/site-packages/fastapi/dependencies/utils.py:638: in solve_dependencies
    solved = await call(**solved_result.values)
tests/api/routes/test_resources.py:60: in mock_observer
    return AuthContext(
E   pydantic_core._pydantic_core.ValidationError: 2 validation errors for AuthContext
E   permissions.0
E     Input should be 'view_messages', 'view_telemetry', 'view_reasoning', 'view_config', 'view_memory', 'view_audit', 'view_tools', 'manage_config', 'runtime_control', 'manage_incidents', 'manage_tasks', 'manage_filters', 'trigger_analysis', 'resolve_deferrals', 'provide_guidance', 'grant_permissions', 'full_access', 'emergency_shutdown' or 'manage_sensitive_config' [type=enum, input_value='read', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/enum
E   authenticated_at
E     Field required [type=missing, input_value={'user_id': 'test_user', ...'permissions': ['read']}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
______________________________________________________________ test_get_resource_alerts_with_hours_param ______________________________________________________________
tests/api/routes/test_resources.py:187: in test_get_resource_alerts_with_hours_param
    response = client.get("/v1/resources/alerts?hours=48")
../.local/lib/python3.12/site-packages/starlette/testclient.py:465: in get
    return super().get(
../.local/lib/python3.12/site-packages/httpx/_client.py:1053: in get
    return self.request(
../.local/lib/python3.12/site-packages/starlette/testclient.py:437: in request
    return super().request(
../.local/lib/python3.12/site-packages/httpx/_client.py:825: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
../.local/lib/python3.12/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
../.local/lib/python3.12/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
../.local/lib/python3.12/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
../.local/lib/python3.12/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
../.local/lib/python3.12/site-packages/starlette/testclient.py:340: in handle_request
    raise exc
../.local/lib/python3.12/site-packages/starlette/testclient.py:337: in handle_request
    portal.call(self.app, scope, receive, send)
../.local/lib/python3.12/site-packages/anyio/from_thread.py:290: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
/usr/lib/python3.12/concurrent/futures/_base.py:449: in result
    return self.__get_result()
/usr/lib/python3.12/concurrent/futures/_base.py:401: in __get_result
    raise self._exception
../.local/lib/python3.12/site-packages/anyio/from_thread.py:221: in _call_func
    retval = await retval_or_awaitable
../.local/lib/python3.12/site-packages/fastapi/applications.py:1054: in __call__
    await super().__call__(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/applications.py:112: in __call__
    await self.middleware_stack(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/middleware/errors.py:187: in __call__
    raise exc
../.local/lib/python3.12/site-packages/starlette/middleware/errors.py:165: in __call__
    await self.app(scope, receive, _send)
../.local/lib/python3.12/site-packages/starlette/middleware/exceptions.py:62: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../.local/lib/python3.12/site-packages/starlette/routing.py:714: in __call__
    await self.middleware_stack(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:734: in app
    await route.handle(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:288: in handle
    await self.app(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:76: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../.local/lib/python3.12/site-packages/starlette/routing.py:73: in app
    response = await f(request)
../.local/lib/python3.12/site-packages/fastapi/routing.py:291: in app
    solved_result = await solve_dependencies(
../.local/lib/python3.12/site-packages/fastapi/dependencies/utils.py:638: in solve_dependencies
    solved = await call(**solved_result.values)
tests/api/routes/test_resources.py:60: in mock_observer
    return AuthContext(
E   pydantic_core._pydantic_core.ValidationError: 2 validation errors for AuthContext
E   permissions.0
E     Input should be 'view_messages', 'view_telemetry', 'view_reasoning', 'view_config', 'view_memory', 'view_audit', 'view_tools', 'manage_config', 'runtime_control', 'manage_incidents', 'manage_tasks', 'manage_filters', 'trigger_analysis', 'resolve_deferrals', 'provide_guidance', 'grant_permissions', 'full_access', 'emergency_shutdown' or 'manage_sensitive_config' [type=enum, input_value='read', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/enum
E   authenticated_at
E     Field required [type=missing, input_value={'user_id': 'test_user', ...'permissions': ['read']}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
________________________________________________________________ test_get_resource_predictions_success ________________________________________________________________
tests/api/routes/test_resources.py:197: in test_get_resource_predictions_success
    response = client.get("/v1/resources/predictions")
../.local/lib/python3.12/site-packages/starlette/testclient.py:465: in get
    return super().get(
../.local/lib/python3.12/site-packages/httpx/_client.py:1053: in get
    return self.request(
../.local/lib/python3.12/site-packages/starlette/testclient.py:437: in request
    return super().request(
../.local/lib/python3.12/site-packages/httpx/_client.py:825: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
../.local/lib/python3.12/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
../.local/lib/python3.12/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
../.local/lib/python3.12/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
../.local/lib/python3.12/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
../.local/lib/python3.12/site-packages/starlette/testclient.py:340: in handle_request
    raise exc
../.local/lib/python3.12/site-packages/starlette/testclient.py:337: in handle_request
    portal.call(self.app, scope, receive, send)
../.local/lib/python3.12/site-packages/anyio/from_thread.py:290: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
/usr/lib/python3.12/concurrent/futures/_base.py:449: in result
    return self.__get_result()
/usr/lib/python3.12/concurrent/futures/_base.py:401: in __get_result
    raise self._exception
../.local/lib/python3.12/site-packages/anyio/from_thread.py:221: in _call_func
    retval = await retval_or_awaitable
../.local/lib/python3.12/site-packages/fastapi/applications.py:1054: in __call__
    await super().__call__(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/applications.py:112: in __call__
    await self.middleware_stack(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/middleware/errors.py:187: in __call__
    raise exc
../.local/lib/python3.12/site-packages/starlette/middleware/errors.py:165: in __call__
    await self.app(scope, receive, _send)
../.local/lib/python3.12/site-packages/starlette/middleware/exceptions.py:62: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../.local/lib/python3.12/site-packages/starlette/routing.py:714: in __call__
    await self.middleware_stack(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:734: in app
    await route.handle(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:288: in handle
    await self.app(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:76: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../.local/lib/python3.12/site-packages/starlette/routing.py:73: in app
    response = await f(request)
../.local/lib/python3.12/site-packages/fastapi/routing.py:291: in app
    solved_result = await solve_dependencies(
../.local/lib/python3.12/site-packages/fastapi/dependencies/utils.py:638: in solve_dependencies
    solved = await call(**solved_result.values)
tests/api/routes/test_resources.py:60: in mock_observer
    return AuthContext(
E   pydantic_core._pydantic_core.ValidationError: 2 validation errors for AuthContext
E   permissions.0
E     Input should be 'view_messages', 'view_telemetry', 'view_reasoning', 'view_config', 'view_memory', 'view_audit', 'view_tools', 'manage_config', 'runtime_control', 'manage_incidents', 'manage_tasks', 'manage_filters', 'trigger_analysis', 'resolve_deferrals', 'provide_guidance', 'grant_permissions', 'full_access', 'emergency_shutdown' or 'manage_sensitive_config' [type=enum, input_value='read', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/enum
E   authenticated_at
E     Field required [type=missing, input_value={'user_id': 'test_user', ...'permissions': ['read']}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
________________________________________________________ test_get_resource_predictions_includes_all_resources _________________________________________________________
tests/api/routes/test_resources.py:222: in test_get_resource_predictions_includes_all_resources
    response = client.get("/v1/resources/predictions")
../.local/lib/python3.12/site-packages/starlette/testclient.py:465: in get
    return super().get(
../.local/lib/python3.12/site-packages/httpx/_client.py:1053: in get
    return self.request(
../.local/lib/python3.12/site-packages/starlette/testclient.py:437: in request
    return super().request(
../.local/lib/python3.12/site-packages/httpx/_client.py:825: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
../.local/lib/python3.12/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
../.local/lib/python3.12/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
../.local/lib/python3.12/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
../.local/lib/python3.12/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
../.local/lib/python3.12/site-packages/starlette/testclient.py:340: in handle_request
    raise exc
../.local/lib/python3.12/site-packages/starlette/testclient.py:337: in handle_request
    portal.call(self.app, scope, receive, send)
../.local/lib/python3.12/site-packages/anyio/from_thread.py:290: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
/usr/lib/python3.12/concurrent/futures/_base.py:449: in result
    return self.__get_result()
/usr/lib/python3.12/concurrent/futures/_base.py:401: in __get_result
    raise self._exception
../.local/lib/python3.12/site-packages/anyio/from_thread.py:221: in _call_func
    retval = await retval_or_awaitable
../.local/lib/python3.12/site-packages/fastapi/applications.py:1054: in __call__
    await super().__call__(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/applications.py:112: in __call__
    await self.middleware_stack(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/middleware/errors.py:187: in __call__
    raise exc
../.local/lib/python3.12/site-packages/starlette/middleware/errors.py:165: in __call__
    await self.app(scope, receive, _send)
../.local/lib/python3.12/site-packages/starlette/middleware/exceptions.py:62: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../.local/lib/python3.12/site-packages/starlette/routing.py:714: in __call__
    await self.middleware_stack(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:734: in app
    await route.handle(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:288: in handle
    await self.app(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:76: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../.local/lib/python3.12/site-packages/starlette/routing.py:73: in app
    response = await f(request)
../.local/lib/python3.12/site-packages/fastapi/routing.py:291: in app
    solved_result = await solve_dependencies(
../.local/lib/python3.12/site-packages/fastapi/dependencies/utils.py:638: in solve_dependencies
    solved = await call(**solved_result.values)
tests/api/routes/test_resources.py:60: in mock_observer
    return AuthContext(
E   pydantic_core._pydantic_core.ValidationError: 2 validation errors for AuthContext
E   permissions.0
E     Input should be 'view_messages', 'view_telemetry', 'view_reasoning', 'view_config', 'view_memory', 'view_audit', 'view_tools', 'manage_config', 'runtime_control', 'manage_incidents', 'manage_tasks', 'manage_filters', 'trigger_analysis', 'resolve_deferrals', 'provide_guidance', 'grant_permissions', 'full_access', 'emergency_shutdown' or 'manage_sensitive_config' [type=enum, input_value='read', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/enum
E   authenticated_at
E     Field required [type=missing, input_value={'user_id': 'test_user', ...'permissions': ['read']}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
____________________________________________________________________ test_configure_alerts_success ____________________________________________________________________
tests/api/routes/test_resources.py:246: in test_configure_alerts_success
    response = client.post("/v1/resources/alerts/config", json=config_data)
../.local/lib/python3.12/site-packages/starlette/testclient.py:538: in post
    return super().post(
../.local/lib/python3.12/site-packages/httpx/_client.py:1144: in post
    return self.request(
../.local/lib/python3.12/site-packages/starlette/testclient.py:437: in request
    return super().request(
../.local/lib/python3.12/site-packages/httpx/_client.py:825: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
../.local/lib/python3.12/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
../.local/lib/python3.12/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
../.local/lib/python3.12/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
../.local/lib/python3.12/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
../.local/lib/python3.12/site-packages/starlette/testclient.py:340: in handle_request
    raise exc
../.local/lib/python3.12/site-packages/starlette/testclient.py:337: in handle_request
    portal.call(self.app, scope, receive, send)
../.local/lib/python3.12/site-packages/anyio/from_thread.py:290: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
/usr/lib/python3.12/concurrent/futures/_base.py:456: in result
    return self.__get_result()
/usr/lib/python3.12/concurrent/futures/_base.py:401: in __get_result
    raise self._exception
../.local/lib/python3.12/site-packages/anyio/from_thread.py:221: in _call_func
    retval = await retval_or_awaitable
../.local/lib/python3.12/site-packages/fastapi/applications.py:1054: in __call__
    await super().__call__(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/applications.py:112: in __call__
    await self.middleware_stack(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/middleware/errors.py:187: in __call__
    raise exc
../.local/lib/python3.12/site-packages/starlette/middleware/errors.py:165: in __call__
    await self.app(scope, receive, _send)
../.local/lib/python3.12/site-packages/starlette/middleware/exceptions.py:62: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../.local/lib/python3.12/site-packages/starlette/routing.py:714: in __call__
    await self.middleware_stack(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:734: in app
    await route.handle(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:288: in handle
    await self.app(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:76: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../.local/lib/python3.12/site-packages/starlette/routing.py:73: in app
    response = await f(request)
../.local/lib/python3.12/site-packages/fastapi/routing.py:291: in app
    solved_result = await solve_dependencies(
../.local/lib/python3.12/site-packages/fastapi/dependencies/utils.py:638: in solve_dependencies
    solved = await call(**solved_result.values)
tests/api/routes/test_resources.py:67: in mock_admin
    return AuthContext(
E   pydantic_core._pydantic_core.ValidationError: 4 validation errors for AuthContext
E   permissions.0
E     Input should be 'view_messages', 'view_telemetry', 'view_reasoning', 'view_config', 'view_memory', 'view_audit', 'view_tools', 'manage_config', 'runtime_control', 'manage_incidents', 'manage_tasks', 'manage_filters', 'trigger_analysis', 'resolve_deferrals', 'provide_guidance', 'grant_permissions', 'full_access', 'emergency_shutdown' or 'manage_sensitive_config' [type=enum, input_value='read', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/enum
E   permissions.1
E     Input should be 'view_messages', 'view_telemetry', 'view_reasoning', 'view_config', 'view_memory', 'view_audit', 'view_tools', 'manage_config', 'runtime_control', 'manage_incidents', 'manage_tasks', 'manage_filters', 'trigger_analysis', 'resolve_deferrals', 'provide_guidance', 'grant_permissions', 'full_access', 'emergency_shutdown' or 'manage_sensitive_config' [type=enum, input_value='write', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/enum
E   permissions.2
E     Input should be 'view_messages', 'view_telemetry', 'view_reasoning', 'view_config', 'view_memory', 'view_audit', 'view_tools', 'manage_config', 'runtime_control', 'manage_incidents', 'manage_tasks', 'manage_filters', 'trigger_analysis', 'resolve_deferrals', 'provide_guidance', 'grant_permissions', 'full_access', 'emergency_shutdown' or 'manage_sensitive_config' [type=enum, input_value='admin', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/enum
E   authenticated_at
E     Field required [type=missing, input_value={'user_id': 'admin_user',...ead', 'write', 'admin']}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
_______________________________________________________________ test_configure_alerts_invalid_resource ________________________________________________________________
tests/api/routes/test_resources.py:270: in test_configure_alerts_invalid_resource
    response = client.post("/v1/resources/alerts/config", json=config_data)
../.local/lib/python3.12/site-packages/starlette/testclient.py:538: in post
    return super().post(
../.local/lib/python3.12/site-packages/httpx/_client.py:1144: in post
    return self.request(
../.local/lib/python3.12/site-packages/starlette/testclient.py:437: in request
    return super().request(
../.local/lib/python3.12/site-packages/httpx/_client.py:825: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
../.local/lib/python3.12/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
../.local/lib/python3.12/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
../.local/lib/python3.12/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
../.local/lib/python3.12/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
../.local/lib/python3.12/site-packages/starlette/testclient.py:340: in handle_request
    raise exc
../.local/lib/python3.12/site-packages/starlette/testclient.py:337: in handle_request
    portal.call(self.app, scope, receive, send)
../.local/lib/python3.12/site-packages/anyio/from_thread.py:290: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
/usr/lib/python3.12/concurrent/futures/_base.py:449: in result
    return self.__get_result()
/usr/lib/python3.12/concurrent/futures/_base.py:401: in __get_result
    raise self._exception
../.local/lib/python3.12/site-packages/anyio/from_thread.py:221: in _call_func
    retval = await retval_or_awaitable
../.local/lib/python3.12/site-packages/fastapi/applications.py:1054: in __call__
    await super().__call__(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/applications.py:112: in __call__
    await self.middleware_stack(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/middleware/errors.py:187: in __call__
    raise exc
../.local/lib/python3.12/site-packages/starlette/middleware/errors.py:165: in __call__
    await self.app(scope, receive, _send)
../.local/lib/python3.12/site-packages/starlette/middleware/exceptions.py:62: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../.local/lib/python3.12/site-packages/starlette/routing.py:714: in __call__
    await self.middleware_stack(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:734: in app
    await route.handle(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:288: in handle
    await self.app(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:76: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../.local/lib/python3.12/site-packages/starlette/routing.py:73: in app
    response = await f(request)
../.local/lib/python3.12/site-packages/fastapi/routing.py:291: in app
    solved_result = await solve_dependencies(
../.local/lib/python3.12/site-packages/fastapi/dependencies/utils.py:638: in solve_dependencies
    solved = await call(**solved_result.values)
tests/api/routes/test_resources.py:67: in mock_admin
    return AuthContext(
E   pydantic_core._pydantic_core.ValidationError: 4 validation errors for AuthContext
E   permissions.0
E     Input should be 'view_messages', 'view_telemetry', 'view_reasoning', 'view_config', 'view_memory', 'view_audit', 'view_tools', 'manage_config', 'runtime_control', 'manage_incidents', 'manage_tasks', 'manage_filters', 'trigger_analysis', 'resolve_deferrals', 'provide_guidance', 'grant_permissions', 'full_access', 'emergency_shutdown' or 'manage_sensitive_config' [type=enum, input_value='read', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/enum
E   permissions.1
E     Input should be 'view_messages', 'view_telemetry', 'view_reasoning', 'view_config', 'view_memory', 'view_audit', 'view_tools', 'manage_config', 'runtime_control', 'manage_incidents', 'manage_tasks', 'manage_filters', 'trigger_analysis', 'resolve_deferrals', 'provide_guidance', 'grant_permissions', 'full_access', 'emergency_shutdown' or 'manage_sensitive_config' [type=enum, input_value='write', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/enum
E   permissions.2
E     Input should be 'view_messages', 'view_telemetry', 'view_reasoning', 'view_config', 'view_memory', 'view_audit', 'view_tools', 'manage_config', 'runtime_control', 'manage_incidents', 'manage_tasks', 'manage_filters', 'trigger_analysis', 'resolve_deferrals', 'provide_guidance', 'grant_permissions', 'full_access', 'emergency_shutdown' or 'manage_sensitive_config' [type=enum, input_value='admin', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/enum
E   authenticated_at
E     Field required [type=missing, input_value={'user_id': 'admin_user',...ead', 'write', 'admin']}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
______________________________________________________________ test_configure_alerts_invalid_thresholds _______________________________________________________________
tests/api/routes/test_resources.py:283: in test_configure_alerts_invalid_thresholds
    response = client.post("/v1/resources/alerts/config", json=config_data)
../.local/lib/python3.12/site-packages/starlette/testclient.py:538: in post
    return super().post(
../.local/lib/python3.12/site-packages/httpx/_client.py:1144: in post
    return self.request(
../.local/lib/python3.12/site-packages/starlette/testclient.py:437: in request
    return super().request(
../.local/lib/python3.12/site-packages/httpx/_client.py:825: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
../.local/lib/python3.12/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
../.local/lib/python3.12/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
../.local/lib/python3.12/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
../.local/lib/python3.12/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
../.local/lib/python3.12/site-packages/starlette/testclient.py:340: in handle_request
    raise exc
../.local/lib/python3.12/site-packages/starlette/testclient.py:337: in handle_request
    portal.call(self.app, scope, receive, send)
../.local/lib/python3.12/site-packages/anyio/from_thread.py:290: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
/usr/lib/python3.12/concurrent/futures/_base.py:449: in result
    return self.__get_result()
/usr/lib/python3.12/concurrent/futures/_base.py:401: in __get_result
    raise self._exception
../.local/lib/python3.12/site-packages/anyio/from_thread.py:221: in _call_func
    retval = await retval_or_awaitable
../.local/lib/python3.12/site-packages/fastapi/applications.py:1054: in __call__
    await super().__call__(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/applications.py:112: in __call__
    await self.middleware_stack(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/middleware/errors.py:187: in __call__
    raise exc
../.local/lib/python3.12/site-packages/starlette/middleware/errors.py:165: in __call__
    await self.app(scope, receive, _send)
../.local/lib/python3.12/site-packages/starlette/middleware/exceptions.py:62: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../.local/lib/python3.12/site-packages/starlette/routing.py:714: in __call__
    await self.middleware_stack(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:734: in app
    await route.handle(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:288: in handle
    await self.app(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:76: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../.local/lib/python3.12/site-packages/starlette/routing.py:73: in app
    response = await f(request)
../.local/lib/python3.12/site-packages/fastapi/routing.py:291: in app
    solved_result = await solve_dependencies(
../.local/lib/python3.12/site-packages/fastapi/dependencies/utils.py:638: in solve_dependencies
    solved = await call(**solved_result.values)
tests/api/routes/test_resources.py:67: in mock_admin
    return AuthContext(
E   pydantic_core._pydantic_core.ValidationError: 4 validation errors for AuthContext
E   permissions.0
E     Input should be 'view_messages', 'view_telemetry', 'view_reasoning', 'view_config', 'view_memory', 'view_audit', 'view_tools', 'manage_config', 'runtime_control', 'manage_incidents', 'manage_tasks', 'manage_filters', 'trigger_analysis', 'resolve_deferrals', 'provide_guidance', 'grant_permissions', 'full_access', 'emergency_shutdown' or 'manage_sensitive_config' [type=enum, input_value='read', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/enum
E   permissions.1
E     Input should be 'view_messages', 'view_telemetry', 'view_reasoning', 'view_config', 'view_memory', 'view_audit', 'view_tools', 'manage_config', 'runtime_control', 'manage_incidents', 'manage_tasks', 'manage_filters', 'trigger_analysis', 'resolve_deferrals', 'provide_guidance', 'grant_permissions', 'full_access', 'emergency_shutdown' or 'manage_sensitive_config' [type=enum, input_value='write', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/enum
E   permissions.2
E     Input should be 'view_messages', 'view_telemetry', 'view_reasoning', 'view_config', 'view_memory', 'view_audit', 'view_tools', 'manage_config', 'runtime_control', 'manage_incidents', 'manage_tasks', 'manage_filters', 'trigger_analysis', 'resolve_deferrals', 'provide_guidance', 'grant_permissions', 'full_access', 'emergency_shutdown' or 'manage_sensitive_config' [type=enum, input_value='admin', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/enum
E   authenticated_at
E     Field required [type=missing, input_value={'user_id': 'admin_user',...ead', 'write', 'admin']}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
__________________________________________________________ test_configure_alerts_critical_less_than_warning ___________________________________________________________
tests/api/routes/test_resources.py:298: in test_configure_alerts_critical_less_than_warning
    response = client.post("/v1/resources/alerts/config", json=config_data)
../.local/lib/python3.12/site-packages/starlette/testclient.py:538: in post
    return super().post(
../.local/lib/python3.12/site-packages/httpx/_client.py:1144: in post
    return self.request(
../.local/lib/python3.12/site-packages/starlette/testclient.py:437: in request
    return super().request(
../.local/lib/python3.12/site-packages/httpx/_client.py:825: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
../.local/lib/python3.12/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
../.local/lib/python3.12/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
../.local/lib/python3.12/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
../.local/lib/python3.12/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
../.local/lib/python3.12/site-packages/starlette/testclient.py:340: in handle_request
    raise exc
../.local/lib/python3.12/site-packages/starlette/testclient.py:337: in handle_request
    portal.call(self.app, scope, receive, send)
../.local/lib/python3.12/site-packages/anyio/from_thread.py:290: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
/usr/lib/python3.12/concurrent/futures/_base.py:449: in result
    return self.__get_result()
/usr/lib/python3.12/concurrent/futures/_base.py:401: in __get_result
    raise self._exception
../.local/lib/python3.12/site-packages/anyio/from_thread.py:221: in _call_func
    retval = await retval_or_awaitable
../.local/lib/python3.12/site-packages/fastapi/applications.py:1054: in __call__
    await super().__call__(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/applications.py:112: in __call__
    await self.middleware_stack(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/middleware/errors.py:187: in __call__
    raise exc
../.local/lib/python3.12/site-packages/starlette/middleware/errors.py:165: in __call__
    await self.app(scope, receive, _send)
../.local/lib/python3.12/site-packages/starlette/middleware/exceptions.py:62: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../.local/lib/python3.12/site-packages/starlette/routing.py:714: in __call__
    await self.middleware_stack(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:734: in app
    await route.handle(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:288: in handle
    await self.app(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:76: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../.local/lib/python3.12/site-packages/starlette/routing.py:73: in app
    response = await f(request)
../.local/lib/python3.12/site-packages/fastapi/routing.py:291: in app
    solved_result = await solve_dependencies(
../.local/lib/python3.12/site-packages/fastapi/dependencies/utils.py:638: in solve_dependencies
    solved = await call(**solved_result.values)
tests/api/routes/test_resources.py:67: in mock_admin
    return AuthContext(
E   pydantic_core._pydantic_core.ValidationError: 4 validation errors for AuthContext
E   permissions.0
E     Input should be 'view_messages', 'view_telemetry', 'view_reasoning', 'view_config', 'view_memory', 'view_audit', 'view_tools', 'manage_config', 'runtime_control', 'manage_incidents', 'manage_tasks', 'manage_filters', 'trigger_analysis', 'resolve_deferrals', 'provide_guidance', 'grant_permissions', 'full_access', 'emergency_shutdown' or 'manage_sensitive_config' [type=enum, input_value='read', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/enum
E   permissions.1
E     Input should be 'view_messages', 'view_telemetry', 'view_reasoning', 'view_config', 'view_memory', 'view_audit', 'view_tools', 'manage_config', 'runtime_control', 'manage_incidents', 'manage_tasks', 'manage_filters', 'trigger_analysis', 'resolve_deferrals', 'provide_guidance', 'grant_permissions', 'full_access', 'emergency_shutdown' or 'manage_sensitive_config' [type=enum, input_value='write', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/enum
E   permissions.2
E     Input should be 'view_messages', 'view_telemetry', 'view_reasoning', 'view_config', 'view_memory', 'view_audit', 'view_tools', 'manage_config', 'runtime_control', 'manage_incidents', 'manage_tasks', 'manage_filters', 'trigger_analysis', 'resolve_deferrals', 'provide_guidance', 'grant_permissions', 'full_access', 'emergency_shutdown' or 'manage_sensitive_config' [type=enum, input_value='admin', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/enum
E   authenticated_at
E     Field required [type=missing, input_value={'user_id': 'admin_user',...ead', 'write', 'admin']}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
________________________________________________________________ test_configure_alerts_partial_update _________________________________________________________________
tests/api/routes/test_resources.py:310: in test_configure_alerts_partial_update
    response = client.post("/v1/resources/alerts/config", json=config_data)
../.local/lib/python3.12/site-packages/starlette/testclient.py:538: in post
    return super().post(
../.local/lib/python3.12/site-packages/httpx/_client.py:1144: in post
    return self.request(
../.local/lib/python3.12/site-packages/starlette/testclient.py:437: in request
    return super().request(
../.local/lib/python3.12/site-packages/httpx/_client.py:825: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
../.local/lib/python3.12/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
../.local/lib/python3.12/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
../.local/lib/python3.12/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
../.local/lib/python3.12/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
../.local/lib/python3.12/site-packages/starlette/testclient.py:340: in handle_request
    raise exc
../.local/lib/python3.12/site-packages/starlette/testclient.py:337: in handle_request
    portal.call(self.app, scope, receive, send)
../.local/lib/python3.12/site-packages/anyio/from_thread.py:290: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
/usr/lib/python3.12/concurrent/futures/_base.py:449: in result
    return self.__get_result()
/usr/lib/python3.12/concurrent/futures/_base.py:401: in __get_result
    raise self._exception
../.local/lib/python3.12/site-packages/anyio/from_thread.py:221: in _call_func
    retval = await retval_or_awaitable
../.local/lib/python3.12/site-packages/fastapi/applications.py:1054: in __call__
    await super().__call__(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/applications.py:112: in __call__
    await self.middleware_stack(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/middleware/errors.py:187: in __call__
    raise exc
../.local/lib/python3.12/site-packages/starlette/middleware/errors.py:165: in __call__
    await self.app(scope, receive, _send)
../.local/lib/python3.12/site-packages/starlette/middleware/exceptions.py:62: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../.local/lib/python3.12/site-packages/starlette/routing.py:714: in __call__
    await self.middleware_stack(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:734: in app
    await route.handle(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:288: in handle
    await self.app(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:76: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../.local/lib/python3.12/site-packages/starlette/routing.py:73: in app
    response = await f(request)
../.local/lib/python3.12/site-packages/fastapi/routing.py:291: in app
    solved_result = await solve_dependencies(
../.local/lib/python3.12/site-packages/fastapi/dependencies/utils.py:638: in solve_dependencies
    solved = await call(**solved_result.values)
tests/api/routes/test_resources.py:67: in mock_admin
    return AuthContext(
E   pydantic_core._pydantic_core.ValidationError: 4 validation errors for AuthContext
E   permissions.0
E     Input should be 'view_messages', 'view_telemetry', 'view_reasoning', 'view_config', 'view_memory', 'view_audit', 'view_tools', 'manage_config', 'runtime_control', 'manage_incidents', 'manage_tasks', 'manage_filters', 'trigger_analysis', 'resolve_deferrals', 'provide_guidance', 'grant_permissions', 'full_access', 'emergency_shutdown' or 'manage_sensitive_config' [type=enum, input_value='read', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/enum
E   permissions.1
E     Input should be 'view_messages', 'view_telemetry', 'view_reasoning', 'view_config', 'view_memory', 'view_audit', 'view_tools', 'manage_config', 'runtime_control', 'manage_incidents', 'manage_tasks', 'manage_filters', 'trigger_analysis', 'resolve_deferrals', 'provide_guidance', 'grant_permissions', 'full_access', 'emergency_shutdown' or 'manage_sensitive_config' [type=enum, input_value='write', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/enum
E   permissions.2
E     Input should be 'view_messages', 'view_telemetry', 'view_reasoning', 'view_config', 'view_memory', 'view_audit', 'view_tools', 'manage_config', 'runtime_control', 'manage_incidents', 'manage_tasks', 'manage_filters', 'trigger_analysis', 'resolve_deferrals', 'provide_guidance', 'grant_permissions', 'full_access', 'emergency_shutdown' or 'manage_sensitive_config' [type=enum, input_value='admin', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/enum
E   authenticated_at
E     Field required [type=missing, input_value={'user_id': 'admin_user',...ead', 'write', 'admin']}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
__________________________________________________________________ test_configure_alerts_no_changes ___________________________________________________________________
tests/api/routes/test_resources.py:327: in test_configure_alerts_no_changes
    response = client.post("/v1/resources/alerts/config", json=config_data)
../.local/lib/python3.12/site-packages/starlette/testclient.py:538: in post
    return super().post(
../.local/lib/python3.12/site-packages/httpx/_client.py:1144: in post
    return self.request(
../.local/lib/python3.12/site-packages/starlette/testclient.py:437: in request
    return super().request(
../.local/lib/python3.12/site-packages/httpx/_client.py:825: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
../.local/lib/python3.12/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
../.local/lib/python3.12/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
../.local/lib/python3.12/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
../.local/lib/python3.12/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
../.local/lib/python3.12/site-packages/starlette/testclient.py:340: in handle_request
    raise exc
../.local/lib/python3.12/site-packages/starlette/testclient.py:337: in handle_request
    portal.call(self.app, scope, receive, send)
../.local/lib/python3.12/site-packages/anyio/from_thread.py:290: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
/usr/lib/python3.12/concurrent/futures/_base.py:449: in result
    return self.__get_result()
/usr/lib/python3.12/concurrent/futures/_base.py:401: in __get_result
    raise self._exception
../.local/lib/python3.12/site-packages/anyio/from_thread.py:221: in _call_func
    retval = await retval_or_awaitable
../.local/lib/python3.12/site-packages/fastapi/applications.py:1054: in __call__
    await super().__call__(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/applications.py:112: in __call__
    await self.middleware_stack(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/middleware/errors.py:187: in __call__
    raise exc
../.local/lib/python3.12/site-packages/starlette/middleware/errors.py:165: in __call__
    await self.app(scope, receive, _send)
../.local/lib/python3.12/site-packages/starlette/middleware/exceptions.py:62: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../.local/lib/python3.12/site-packages/starlette/routing.py:714: in __call__
    await self.middleware_stack(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:734: in app
    await route.handle(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:288: in handle
    await self.app(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:76: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../.local/lib/python3.12/site-packages/starlette/routing.py:73: in app
    response = await f(request)
../.local/lib/python3.12/site-packages/fastapi/routing.py:291: in app
    solved_result = await solve_dependencies(
../.local/lib/python3.12/site-packages/fastapi/dependencies/utils.py:638: in solve_dependencies
    solved = await call(**solved_result.values)
tests/api/routes/test_resources.py:67: in mock_admin
    return AuthContext(
E   pydantic_core._pydantic_core.ValidationError: 4 validation errors for AuthContext
E   permissions.0
E     Input should be 'view_messages', 'view_telemetry', 'view_reasoning', 'view_config', 'view_memory', 'view_audit', 'view_tools', 'manage_config', 'runtime_control', 'manage_incidents', 'manage_tasks', 'manage_filters', 'trigger_analysis', 'resolve_deferrals', 'provide_guidance', 'grant_permissions', 'full_access', 'emergency_shutdown' or 'manage_sensitive_config' [type=enum, input_value='read', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/enum
E   permissions.1
E     Input should be 'view_messages', 'view_telemetry', 'view_reasoning', 'view_config', 'view_memory', 'view_audit', 'view_tools', 'manage_config', 'runtime_control', 'manage_incidents', 'manage_tasks', 'manage_filters', 'trigger_analysis', 'resolve_deferrals', 'provide_guidance', 'grant_permissions', 'full_access', 'emergency_shutdown' or 'manage_sensitive_config' [type=enum, input_value='write', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/enum
E   permissions.2
E     Input should be 'view_messages', 'view_telemetry', 'view_reasoning', 'view_config', 'view_memory', 'view_audit', 'view_tools', 'manage_config', 'runtime_control', 'manage_incidents', 'manage_tasks', 'manage_filters', 'trigger_analysis', 'resolve_deferrals', 'provide_guidance', 'grant_permissions', 'full_access', 'emergency_shutdown' or 'manage_sensitive_config' [type=enum, input_value='admin', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/enum
E   authenticated_at
E     Field required [type=missing, input_value={'user_id': 'admin_user',...ead', 'write', 'admin']}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
______________________________________________________________ test_resource_monitor_exception_handling _______________________________________________________________
tests/api/routes/test_resources.py:342: in test_resource_monitor_exception_handling
    response = client.get("/v1/resources/limits")
../.local/lib/python3.12/site-packages/starlette/testclient.py:465: in get
    return super().get(
../.local/lib/python3.12/site-packages/httpx/_client.py:1053: in get
    return self.request(
../.local/lib/python3.12/site-packages/starlette/testclient.py:437: in request
    return super().request(
../.local/lib/python3.12/site-packages/httpx/_client.py:825: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
../.local/lib/python3.12/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
../.local/lib/python3.12/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
../.local/lib/python3.12/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
../.local/lib/python3.12/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
../.local/lib/python3.12/site-packages/starlette/testclient.py:340: in handle_request
    raise exc
../.local/lib/python3.12/site-packages/starlette/testclient.py:337: in handle_request
    portal.call(self.app, scope, receive, send)
../.local/lib/python3.12/site-packages/anyio/from_thread.py:290: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
/usr/lib/python3.12/concurrent/futures/_base.py:449: in result
    return self.__get_result()
/usr/lib/python3.12/concurrent/futures/_base.py:401: in __get_result
    raise self._exception
../.local/lib/python3.12/site-packages/anyio/from_thread.py:221: in _call_func
    retval = await retval_or_awaitable
../.local/lib/python3.12/site-packages/fastapi/applications.py:1054: in __call__
    await super().__call__(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/applications.py:112: in __call__
    await self.middleware_stack(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/middleware/errors.py:187: in __call__
    raise exc
../.local/lib/python3.12/site-packages/starlette/middleware/errors.py:165: in __call__
    await self.app(scope, receive, _send)
../.local/lib/python3.12/site-packages/starlette/middleware/exceptions.py:62: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../.local/lib/python3.12/site-packages/starlette/routing.py:714: in __call__
    await self.middleware_stack(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:734: in app
    await route.handle(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:288: in handle
    await self.app(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/routing.py:76: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    raise exc
../.local/lib/python3.12/site-packages/starlette/_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
../.local/lib/python3.12/site-packages/starlette/routing.py:73: in app
    response = await f(request)
../.local/lib/python3.12/site-packages/fastapi/routing.py:291: in app
    solved_result = await solve_dependencies(
../.local/lib/python3.12/site-packages/fastapi/dependencies/utils.py:638: in solve_dependencies
    solved = await call(**solved_result.values)
tests/api/routes/test_resources.py:60: in mock_observer
    return AuthContext(
E   pydantic_core._pydantic_core.ValidationError: 2 validation errors for AuthContext
E   permissions.0
E     Input should be 'view_messages', 'view_telemetry', 'view_reasoning', 'view_config', 'view_memory', 'view_audit', 'view_tools', 'manage_config', 'runtime_control', 'manage_incidents', 'manage_tasks', 'manage_filters', 'trigger_analysis', 'resolve_deferrals', 'provide_guidance', 'grant_permissions', 'full_access', 'emergency_shutdown' or 'manage_sensitive_config' [type=enum, input_value='read', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/enum
E   authenticated_at
E     Field required [type=missing, input_value={'user_id': 'test_user', ...'permissions': ['read']}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
________________________________________________________________________ test_get_current_time ________________________________________________________________________
tests/api/routes/test_time.py:86: in test_get_current_time
    assert time_data["current_time"] == "2025-01-01T12:00:00+00:00"
E   AssertionError: assert '2025-01-01T12:00:00Z' == '2025-01-01T12:00:00+00:00'
E
E     - 2025-01-01T12:00:00+00:00
E     ?                    ^^^^^^
E     + 2025-01-01T12:00:00Z
E     ?                    ^
___________________________________________________________________________ test_get_uptime ___________________________________________________________________________
tests/api/routes/test_time.py:123: in test_get_uptime
    assert uptime_data["start_time"] == "2025-01-01T00:00:00+00:00"
E   AssertionError: assert '2025-01-01T00:00:00Z' == '2025-01-01T00:00:00+00:00'
E
E     - 2025-01-01T00:00:00+00:00
E     ?                    ^^^^^^
E     + 2025-01-01T00:00:00Z
E     ?                    ^
______________________________________________________________________ test_get_time_sync_status ______________________________________________________________________
tests/api/routes/test_time.py:164: in test_get_time_sync_status
    assert sync_data["last_sync"] == "2025-01-01T00:00:00+00:00"
E   AssertionError: assert '2025-01-01T00:00:00Z' == '2025-01-01T00:00:00+00:00'
E
E     - 2025-01-01T00:00:00+00:00
E     ?                    ^^^^^^
E     + 2025-01-01T00:00:00Z
E     ?                    ^
__________________________________________________________________ test_time_service_error_handling ___________________________________________________________________
tests/api/routes/test_time.py:208: in test_time_service_error_handling
    assert response.status_code == 500
E   assert 200 == 500
E    +  where 200 = <Response [200 OK]>.status_code
___________________________________________________________ TestDreamProcessor.test_process_entering_phase ____________________________________________________________
tests/ciris_engine/logic/processors/states/test_dream_processor.py:132: in test_process_entering_phase
    assert result.errors == 0
E   assert 1 == 0
E    +  where 1 = DreamResult(thoughts_processed=0, errors=1, duration_seconds=0.0).errors
-------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------
WARNING  ciris_engine.logic.processors.states.dream_processor:dream_processor.py:291 No service registry available for dream processor
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
ERROR    ciris_engine.logic.processors.states.dream_processor:dream_processor.py:505 Error in dream round 1: 'Mock' object is not iterable
Traceback (most recent call last):
  File "/home/emoore/CIRISAgent/ciris_engine/logic/processors/states/dream_processor.py", line 475, in process_round
    results = await asyncio.gather(*[
                                    ^
TypeError: 'Mock' object is not iterable
ERROR    ciris_engine.logic.processors.states.dream_processor:dream_processor.py:572 Error in dream loop: module 'ciris_engine.logic.persistence' has no attribute 'get_active_tasks'
Traceback (most recent call last):
  File "/home/emoore/CIRISAgent/ciris_engine/logic/processors/states/dream_processor.py", line 541, in _dream_loop
    await self._update_current_phase()
  File "/home/emoore/CIRISAgent/ciris_engine/logic/processors/states/dream_processor.py", line 585, in _update_current_phase
    active_tasks = persistence.get_active_tasks(limit=100)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: module 'ciris_engine.logic.persistence' has no attribute 'get_active_tasks'. Did you mean: 'count_active_tasks'?
_________________________________________________________ TestDreamProcessor.test_process_consolidating_phase _________________________________________________________
tests/ciris_engine/logic/processors/states/test_dream_processor.py:147: in test_process_consolidating_phase
    with patch.object(dream_processor, '_consolidate_recent_memories', new_callable=AsyncMock) as mock_consolidate:
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <DreamProcessor> does not have the attribute '_consolidate_recent_memories'
-------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------
WARNING  ciris_engine.logic.processors.states.dream_processor:dream_processor.py:291 No service registry available for dream processor
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
ERROR    ciris_engine.logic.processors.states.dream_processor:dream_processor.py:572 Error in dream loop: module 'ciris_engine.logic.persistence' has no attribute 'get_active_tasks'
Traceback (most recent call last):
  File "/home/emoore/CIRISAgent/ciris_engine/logic/processors/states/dream_processor.py", line 541, in _dream_loop
    await self._update_current_phase()
  File "/home/emoore/CIRISAgent/ciris_engine/logic/processors/states/dream_processor.py", line 585, in _update_current_phase
    active_tasks = persistence.get_active_tasks(limit=100)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: module 'ciris_engine.logic.persistence' has no attribute 'get_active_tasks'. Did you mean: 'count_active_tasks'?
___________________________________________________________ TestDreamProcessor.test_process_analyzing_phase ___________________________________________________________
tests/ciris_engine/logic/processors/states/test_dream_processor.py:170: in test_process_analyzing_phase
    assert result.errors == 0
E   assert 1 == 0
E    +  where 1 = DreamResult(thoughts_processed=0, errors=1, duration_seconds=0.0).errors
-------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------
WARNING  ciris_engine.logic.processors.states.dream_processor:dream_processor.py:291 No service registry available for dream processor
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
ERROR    ciris_engine.logic.processors.states.dream_processor:dream_processor.py:505 Error in dream round 3: 'Mock' object is not iterable
Traceback (most recent call last):
  File "/home/emoore/CIRISAgent/ciris_engine/logic/processors/states/dream_processor.py", line 475, in process_round
    results = await asyncio.gather(*[
                                    ^
TypeError: 'Mock' object is not iterable
ERROR    ciris_engine.logic.processors.states.dream_processor:dream_processor.py:572 Error in dream loop: module 'ciris_engine.logic.persistence' has no attribute 'get_active_tasks'
Traceback (most recent call last):
  File "/home/emoore/CIRISAgent/ciris_engine/logic/processors/states/dream_processor.py", line 541, in _dream_loop
    await self._update_current_phase()
  File "/home/emoore/CIRISAgent/ciris_engine/logic/processors/states/dream_processor.py", line 585, in _update_current_phase
    active_tasks = persistence.get_active_tasks(limit=100)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: module 'ciris_engine.logic.persistence' has no attribute 'get_active_tasks'. Did you mean: 'count_active_tasks'?
__________________________________________________________ TestDreamProcessor.test_process_configuring_phase __________________________________________________________
tests/ciris_engine/logic/processors/states/test_dream_processor.py:184: in test_process_configuring_phase
    assert result.errors == 0
E   assert 1 == 0
E    +  where 1 = DreamResult(thoughts_processed=0, errors=1, duration_seconds=0.0).errors
-------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------
WARNING  ciris_engine.logic.processors.states.dream_processor:dream_processor.py:291 No service registry available for dream processor
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
ERROR    ciris_engine.logic.processors.states.dream_processor:dream_processor.py:505 Error in dream round 4: 'Mock' object is not iterable
Traceback (most recent call last):
  File "/home/emoore/CIRISAgent/ciris_engine/logic/processors/states/dream_processor.py", line 475, in process_round
    results = await asyncio.gather(*[
                                    ^
TypeError: 'Mock' object is not iterable
ERROR    ciris_engine.logic.processors.states.dream_processor:dream_processor.py:572 Error in dream loop: module 'ciris_engine.logic.persistence' has no attribute 'get_active_tasks'
Traceback (most recent call last):
  File "/home/emoore/CIRISAgent/ciris_engine/logic/processors/states/dream_processor.py", line 541, in _dream_loop
    await self._update_current_phase()
  File "/home/emoore/CIRISAgent/ciris_engine/logic/processors/states/dream_processor.py", line 585, in _update_current_phase
    active_tasks = persistence.get_active_tasks(limit=100)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: module 'ciris_engine.logic.persistence' has no attribute 'get_active_tasks'. Did you mean: 'count_active_tasks'?
___________________________________________________________ TestDreamProcessor.test_process_planning_phase ____________________________________________________________
tests/ciris_engine/logic/processors/states/test_dream_processor.py:202: in test_process_planning_phase
    with patch.object(dream_processor, '_get_active_tasks', new_callable=AsyncMock) as mock_get_tasks:
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <DreamProcessor> does not have the attribute '_get_active_tasks'
-------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------
WARNING  ciris_engine.logic.processors.states.dream_processor:dream_processor.py:291 No service registry available for dream processor
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
ERROR    ciris_engine.logic.processors.states.dream_processor:dream_processor.py:572 Error in dream loop: module 'ciris_engine.logic.persistence' has no attribute 'get_active_tasks'
Traceback (most recent call last):
  File "/home/emoore/CIRISAgent/ciris_engine/logic/processors/states/dream_processor.py", line 541, in _dream_loop
    await self._update_current_phase()
  File "/home/emoore/CIRISAgent/ciris_engine/logic/processors/states/dream_processor.py", line 585, in _update_current_phase
    active_tasks = persistence.get_active_tasks(limit=100)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: module 'ciris_engine.logic.persistence' has no attribute 'get_active_tasks'. Did you mean: 'count_active_tasks'?
____________________________________________________________ TestDreamProcessor.test_process_exiting_phase ____________________________________________________________
tests/ciris_engine/logic/processors/states/test_dream_processor.py:222: in test_process_exiting_phase
    assert result.errors == 0
E   assert 1 == 0
E    +  where 1 = DreamResult(thoughts_processed=0, errors=1, duration_seconds=0.0).errors
-------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------
WARNING  ciris_engine.logic.processors.states.dream_processor:dream_processor.py:291 No service registry available for dream processor
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
ERROR    ciris_engine.logic.processors.states.dream_processor:dream_processor.py:505 Error in dream round 6: 'Mock' object is not iterable
Traceback (most recent call last):
  File "/home/emoore/CIRISAgent/ciris_engine/logic/processors/states/dream_processor.py", line 475, in process_round
    results = await asyncio.gather(*[
                                    ^
TypeError: 'Mock' object is not iterable
ERROR    ciris_engine.logic.processors.states.dream_processor:dream_processor.py:572 Error in dream loop: module 'ciris_engine.logic.persistence' has no attribute 'get_active_tasks'
Traceback (most recent call last):
  File "/home/emoore/CIRISAgent/ciris_engine/logic/processors/states/dream_processor.py", line 541, in _dream_loop
    await self._update_current_phase()
  File "/home/emoore/CIRISAgent/ciris_engine/logic/processors/states/dream_processor.py", line 585, in _update_current_phase
    active_tasks = persistence.get_active_tasks(limit=100)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: module 'ciris_engine.logic.persistence' has no attribute 'get_active_tasks'. Did you mean: 'count_active_tasks'?
___________________________________________________________________ TestDreamProcessor.test_cleanup ___________________________________________________________________
tests/ciris_engine/logic/processors/states/test_dream_processor.py:234: in test_cleanup
    assert dream_processor.current_session is None
E   AssertionError: assert DreamSession(session_id='dream_1704110400', scheduled_start=None, actual_start=datetime.datetime(2024, 1, 1, 12, 0, tzinfo=datetime.timezone.utc), planned_duration=datetime.timedelta(seconds=60), phase=<DreamPhase.ENTERING: 'entering'>, memories_consolidated=0, patterns_analyzed=0, adaptations_made=0, future_tasks_scheduled=0, benchmarks_run=0, ponder_questions_processed=[], insights_gained=[], phase_durations={}, completed_at=None) is None
E    +  where DreamSession(session_id='dream_1704110400', scheduled_start=None, actual_start=datetime.datetime(2024, 1, 1, 12, 0, tzinfo=datetime.timezone.utc), planned_duration=datetime.timedelta(seconds=60), phase=<DreamPhase.ENTERING: 'entering'>, memories_consolidated=0, patterns_analyzed=0, adaptations_made=0, future_tasks_scheduled=0, benchmarks_run=0, ponder_questions_processed=[], insights_gained=[], phase_durations={}, completed_at=None) = <DreamProcessor>.current_session
-------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------
WARNING  ciris_engine.logic.processors.states.dream_processor:dream_processor.py:291 No service registry available for dream processor
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
ERROR    ciris_engine.logic.processors.states.dream_processor:dream_processor.py:572 Error in dream loop: module 'ciris_engine.logic.persistence' has no attribute 'get_active_tasks'
Traceback (most recent call last):
  File "/home/emoore/CIRISAgent/ciris_engine/logic/processors/states/dream_processor.py", line 541, in _dream_loop
    await self._update_current_phase()
  File "/home/emoore/CIRISAgent/ciris_engine/logic/processors/states/dream_processor.py", line 585, in _update_current_phase
    active_tasks = persistence.get_active_tasks(limit=100)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: module 'ciris_engine.logic.persistence' has no attribute 'get_active_tasks'. Did you mean: 'count_active_tasks'?
_________________________________________________________ TestDreamProcessor.test_consolidate_recent_memories _________________________________________________________
tests/ciris_engine/logic/processors/states/test_dream_processor.py:243: in test_consolidate_recent_memories
    type=NodeType.OBSERVATION,
E   AttributeError: type object 'NodeType' has no attribute 'OBSERVATION'
__________________________________________________________ TestDreamProcessor.test_apply_self_configuration ___________________________________________________________
tests/ciris_engine/logic/processors/states/test_dream_processor.py:297: in test_apply_self_configuration
    result = await dream_processor._apply_self_configuration()
E   AttributeError: 'DreamProcessor' object has no attribute '_apply_self_configuration'
___________________________________________________________ TestDreamProcessor.test_create_system_snapshot ____________________________________________________________
tests/ciris_engine/logic/processors/states/test_dream_processor.py:307: in test_create_system_snapshot
    with patch.object(dream_processor, '_get_active_tasks', new_callable=AsyncMock) as mock_tasks:
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <DreamProcessor> does not have the attribute '_get_active_tasks'
___________________________________________________________ TestDreamProcessor.test_minimum_dream_duration ____________________________________________________________
tests/ciris_engine/logic/processors/states/test_dream_processor.py:337: in test_minimum_dream_duration
    assert result.should_transition is False
../.local/lib/python3.12/site-packages/pydantic/main.py:989: in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
E   AttributeError: 'DreamResult' object has no attribute 'should_transition'
-------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------
WARNING  ciris_engine.logic.processors.states.dream_processor:dream_processor.py:291 No service registry available for dream processor
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
ERROR    ciris_engine.logic.processors.states.dream_processor:dream_processor.py:505 Error in dream round 10: 'Mock' object is not iterable
Traceback (most recent call last):
  File "/home/emoore/CIRISAgent/ciris_engine/logic/processors/states/dream_processor.py", line 475, in process_round
    results = await asyncio.gather(*[
                                    ^
TypeError: 'Mock' object is not iterable
ERROR    ciris_engine.logic.processors.states.dream_processor:dream_processor.py:572 Error in dream loop: module 'ciris_engine.logic.persistence' has no attribute 'get_active_tasks'
Traceback (most recent call last):
  File "/home/emoore/CIRISAgent/ciris_engine/logic/processors/states/dream_processor.py", line 541, in _dream_loop
    await self._update_current_phase()
  File "/home/emoore/CIRISAgent/ciris_engine/logic/processors/states/dream_processor.py", line 585, in _update_current_phase
    active_tasks = persistence.get_active_tasks(limit=100)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: module 'ciris_engine.logic.persistence' has no attribute 'get_active_tasks'. Did you mean: 'count_active_tasks'?
___________________________________________________________ TestDreamProcessor.test_maximum_dream_duration ____________________________________________________________
tests/ciris_engine/logic/processors/states/test_dream_processor.py:354: in test_maximum_dream_duration
    assert dream_processor.current_session.phase == DreamPhase.EXITING
E   AssertionError: assert <DreamPhase.C...onsolidating'> == <DreamPhase.E...NG: 'exiting'>
E
E     - exiting
E     + consolidating
-------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------
WARNING  ciris_engine.logic.processors.states.dream_processor:dream_processor.py:291 No service registry available for dream processor
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
ERROR    ciris_engine.logic.processors.states.dream_processor:dream_processor.py:505 Error in dream round 20: 'Mock' object is not iterable
Traceback (most recent call last):
  File "/home/emoore/CIRISAgent/ciris_engine/logic/processors/states/dream_processor.py", line 475, in process_round
    results = await asyncio.gather(*[
                                    ^
TypeError: 'Mock' object is not iterable
ERROR    ciris_engine.logic.processors.states.dream_processor:dream_processor.py:572 Error in dream loop: module 'ciris_engine.logic.persistence' has no attribute 'get_active_tasks'
Traceback (most recent call last):
  File "/home/emoore/CIRISAgent/ciris_engine/logic/processors/states/dream_processor.py", line 541, in _dream_loop
    await self._update_current_phase()
  File "/home/emoore/CIRISAgent/ciris_engine/logic/processors/states/dream_processor.py", line 585, in _update_current_phase
    active_tasks = persistence.get_active_tasks(limit=100)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: module 'ciris_engine.logic.persistence' has no attribute 'get_active_tasks'. Did you mean: 'count_active_tasks'?
___________________________________________________________ TestDreamProcessor.test_error_handling_in_phase ___________________________________________________________
tests/ciris_engine/logic/processors/states/test_dream_processor.py:365: in test_error_handling_in_phase
    with patch.object(dream_processor, '_consolidate_recent_memories', new_callable=AsyncMock) as mock_consolidate:
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <DreamProcessor> does not have the attribute '_consolidate_recent_memories'
-------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------
WARNING  ciris_engine.logic.processors.states.dream_processor:dream_processor.py:291 No service registry available for dream processor
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
ERROR    ciris_engine.logic.processors.states.dream_processor:dream_processor.py:572 Error in dream loop: module 'ciris_engine.logic.persistence' has no attribute 'get_active_tasks'
Traceback (most recent call last):
  File "/home/emoore/CIRISAgent/ciris_engine/logic/processors/states/dream_processor.py", line 541, in _dream_loop
    await self._update_current_phase()
  File "/home/emoore/CIRISAgent/ciris_engine/logic/processors/states/dream_processor.py", line 585, in _update_current_phase
    active_tasks = persistence.get_active_tasks(limit=100)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: module 'ciris_engine.logic.persistence' has no attribute 'get_active_tasks'. Did you mean: 'count_active_tasks'?
______________________________________________________________ TestDreamProcessor.test_benchmarking_mode ______________________________________________________________
tests/ciris_engine/logic/processors/states/test_dream_processor.py:398: in test_benchmarking_mode
    with patch.object(dream_processor, '_cirisnode_available', new_callable=AsyncMock) as mock_available:
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <DreamProcessor> does not have the attribute '_cirisnode_available'
-------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------
WARNING  ciris_engine.logic.processors.states.dream_processor:dream_processor.py:291 No service registry available for dream processor
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
WARNING  ciris_engine.logic.persistence.models.tasks:tasks.py:98 Task ID test_task not found for status update.
ERROR    ciris_engine.logic.processors.states.dream_processor:dream_processor.py:572 Error in dream loop: module 'ciris_engine.logic.persistence' has no attribute 'get_active_tasks'
Traceback (most recent call last):
  File "/home/emoore/CIRISAgent/ciris_engine/logic/processors/states/dream_processor.py", line 541, in _dream_loop
    await self._update_current_phase()
  File "/home/emoore/CIRISAgent/ciris_engine/logic/processors/states/dream_processor.py", line 585, in _update_current_phase
    active_tasks = persistence.get_active_tasks(limit=100)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: module 'ciris_engine.logic.persistence' has no attribute 'get_active_tasks'. Did you mean: 'count_active_tasks'?
__________________________________________________________________ TestCIRISRuntime.test_initialize ___________________________________________________________________
tests/ciris_engine/logic/runtime/test_ciris_runtime.py:53: in test_initialize
    with patch.object(ciris_runtime, '_initialize_core_services', new_callable=AsyncMock) as mock_init_services:
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <ciris_engine.logic.runtime.ciris_runtime.CIRISRuntime object at 0x750cb952fef0> does not have the attribute '_initialize_core_services'
------------------------------------------------------------------------- Captured log setup --------------------------------------------------------------------------
WARNING  ciris_engine.logic.adapters.cli.cli_observer:cli_observer.py:91 Error checking for piped input: redirected stdin is pseudofile, has no fileno()
________________________________________________________ TestCIRISRuntime.test_initialize_already_initialized _________________________________________________________
tests/ciris_engine/logic/runtime/test_ciris_runtime.py:73: in test_initialize_already_initialized
    with pytest.raises(RuntimeError) as exc_info:
E   Failed: DID NOT RAISE <class 'RuntimeError'>
------------------------------------------------------------------------- Captured log setup --------------------------------------------------------------------------
WARNING  ciris_engine.logic.adapters.cli.cli_observer:cli_observer.py:91 Error checking for piped input: redirected stdin is pseudofile, has no fileno()
_____________________________________________________________________ TestCIRISRuntime.test_start _____________________________________________________________________
tests/ciris_engine/logic/runtime/test_ciris_runtime.py:93: in test_start
    await ciris_runtime.start()
E   AttributeError: 'CIRISRuntime' object has no attribute 'start'
------------------------------------------------------------------------- Captured log setup --------------------------------------------------------------------------
WARNING  ciris_engine.logic.adapters.cli.cli_observer:cli_observer.py:91 Error checking for piped input: redirected stdin is pseudofile, has no fileno()
_____________________________________________________________ TestCIRISRuntime.test_start_not_initialized _____________________________________________________________
tests/ciris_engine/logic/runtime/test_ciris_runtime.py:102: in test_start_not_initialized
    await ciris_runtime.start()
E   AttributeError: 'CIRISRuntime' object has no attribute 'start'
------------------------------------------------------------------------- Captured log setup --------------------------------------------------------------------------
WARNING  ciris_engine.logic.adapters.cli.cli_observer:cli_observer.py:91 Error checking for piped input: redirected stdin is pseudofile, has no fileno()
___________________________________________________________ TestCIRISRuntime.test_initialize_core_services ____________________________________________________________
tests/ciris_engine/logic/runtime/test_ciris_runtime.py:154: in test_initialize_core_services
    await ciris_runtime._initialize_core_services()
E   AttributeError: 'CIRISRuntime' object has no attribute '_initialize_core_services'. Did you mean: '_initialize_memory_service'?
------------------------------------------------------------------------- Captured log setup --------------------------------------------------------------------------
WARNING  ciris_engine.logic.adapters.cli.cli_observer:cli_observer.py:91 Error checking for piped input: redirected stdin is pseudofile, has no fileno()
_______________________________________________________________ TestCIRISRuntime.test_initialize_buses ________________________________________________________________
tests/ciris_engine/logic/runtime/test_ciris_runtime.py:169: in test_initialize_buses
    with patch('ciris_engine.logic.runtime.ciris_runtime.BusManager') as mock_bus_manager_class:
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'ciris_engine.logic.runtime.ciris_runtime' from '/home/emoore/CIRISAgent/ciris_engine/logic/runtime/ciris_runtime.py'> does not have the attribute 'BusManager'
------------------------------------------------------------------------- Captured log setup --------------------------------------------------------------------------
WARNING  ciris_engine.logic.adapters.cli.cli_observer:cli_observer.py:91 Error checking for piped input: redirected stdin is pseudofile, has no fileno()
_____________________________________________________________ TestCIRISRuntime.test_initialize_processors _____________________________________________________________
tests/ciris_engine/logic/runtime/test_ciris_runtime.py:185: in test_initialize_processors
    ciris_runtime.bus_manager = Mock()
E   AttributeError: property 'bus_manager' of 'CIRISRuntime' object has no setter
------------------------------------------------------------------------- Captured log setup --------------------------------------------------------------------------
WARNING  ciris_engine.logic.adapters.cli.cli_observer:cli_observer.py:91 Error checking for piped input: redirected stdin is pseudofile, has no fileno()
______________________________________________________________ TestCIRISRuntime.test_initialize_adapters ______________________________________________________________
tests/ciris_engine/logic/runtime/test_ciris_runtime.py:204: in test_initialize_adapters
    ciris_runtime.bus_manager = Mock()
E   AttributeError: property 'bus_manager' of 'CIRISRuntime' object has no setter
------------------------------------------------------------------------- Captured log setup --------------------------------------------------------------------------
WARNING  ciris_engine.logic.adapters.cli.cli_observer:cli_observer.py:91 Error checking for piped input: redirected stdin is pseudofile, has no fileno()
_______________________________________________________________ TestCIRISRuntime.test_run_with_timeout ________________________________________________________________
tests/ciris_engine/logic/runtime/test_ciris_runtime.py:230: in test_run_with_timeout
    ciris_runtime.bus_manager = None  # No bus manager for this test
E   AttributeError: property 'bus_manager' of 'CIRISRuntime' object has no setter
------------------------------------------------------------------------- Captured log setup --------------------------------------------------------------------------
WARNING  ciris_engine.logic.adapters.cli.cli_observer:cli_observer.py:91 Error checking for piped input: redirected stdin is pseudofile, has no fileno()
________________________________________________________________ TestCIRISRuntime.test_run_with_error _________________________________________________________________
tests/ciris_engine/logic/runtime/test_ciris_runtime.py:252: in test_run_with_error
    ciris_runtime.bus_manager = None
E   AttributeError: property 'bus_manager' of 'CIRISRuntime' object has no setter
------------------------------------------------------------------------- Captured log setup --------------------------------------------------------------------------
WARNING  ciris_engine.logic.adapters.cli.cli_observer:cli_observer.py:91 Error checking for piped input: redirected stdin is pseudofile, has no fileno()
__________________________________________________________________ TestCIRISRuntime.test_get_status ___________________________________________________________________
tests/ciris_engine/logic/runtime/test_ciris_runtime.py:275: in test_get_status
    status = ciris_runtime.get_status()
E   AttributeError: 'CIRISRuntime' object has no attribute 'get_status'
------------------------------------------------------------------------- Captured log setup --------------------------------------------------------------------------
WARNING  ciris_engine.logic.adapters.cli.cli_observer:cli_observer.py:91 Error checking for piped input: redirected stdin is pseudofile, has no fileno()
_________________________________________________________________ TestCIRISRuntime.test_get_services __________________________________________________________________
tests/ciris_engine/logic/runtime/test_ciris_runtime.py:289: in test_get_services
    services = ciris_runtime.get_services()
E   AttributeError: 'CIRISRuntime' object has no attribute 'get_services'. Did you mean: 'audit_services'?
------------------------------------------------------------------------- Captured log setup --------------------------------------------------------------------------
WARNING  ciris_engine.logic.adapters.cli.cli_observer:cli_observer.py:91 Error checking for piped input: redirected stdin is pseudofile, has no fileno()
_________________________________________________________ TestCIRISRuntime.test_get_services_not_initialized __________________________________________________________
tests/ciris_engine/logic/runtime/test_ciris_runtime.py:295: in test_get_services_not_initialized
    services = ciris_runtime.get_services()
E   AttributeError: 'CIRISRuntime' object has no attribute 'get_services'. Did you mean: 'audit_services'?
------------------------------------------------------------------------- Captured log setup --------------------------------------------------------------------------
WARNING  ciris_engine.logic.adapters.cli.cli_observer:cli_observer.py:91 Error checking for piped input: redirected stdin is pseudofile, has no fileno()
____________________________________________________________ TestCIRISRuntime.test_handle_shutdown_signal _____________________________________________________________
tests/ciris_engine/logic/runtime/test_ciris_runtime.py:306: in test_handle_shutdown_signal
    await ciris_runtime._handle_shutdown_signal()
E   AttributeError: 'CIRISRuntime' object has no attribute '_handle_shutdown_signal'
------------------------------------------------------------------------- Captured log setup --------------------------------------------------------------------------
WARNING  ciris_engine.logic.adapters.cli.cli_observer:cli_observer.py:91 Error checking for piped input: redirected stdin is pseudofile, has no fileno()
____________________________________________________________ TestCIRISRuntime.test_validate_configuration _____________________________________________________________
tests/ciris_engine/logic/runtime/test_ciris_runtime.py:314: in test_validate_configuration
    ciris_runtime._validate_configuration()
E   AttributeError: 'CIRISRuntime' object has no attribute '_validate_configuration'
------------------------------------------------------------------------- Captured log setup --------------------------------------------------------------------------
WARNING  ciris_engine.logic.adapters.cli.cli_observer:cli_observer.py:91 Error checking for piped input: redirected stdin is pseudofile, has no fileno()
_______________________________________________________________ TestCIRISRuntime.test_multiple_adapters _______________________________________________________________
tests/ciris_engine/logic/runtime/test_ciris_runtime.py:330: in test_multiple_adapters
    with patch('ciris_engine.logic.runtime.ciris_runtime.AdapterManager') as mock_adapter_class:
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'ciris_engine.logic.runtime.ciris_runtime' from '/home/emoore/CIRISAgent/ciris_engine/logic/runtime/ciris_runtime.py'> does not have the attribute 'AdapterManager'
------------------------------------------------------------------------- Captured log setup --------------------------------------------------------------------------
WARNING  ciris_engine.logic.adapters.cli.cli_observer:cli_observer.py:91 Error checking for piped input: redirected stdin is pseudofile, has no fileno()
____________________________________________________________ TestCIRISRuntime.test_mock_llm_configuration _____________________________________________________________
tests/ciris_engine/logic/runtime/test_ciris_runtime.py:350: in test_mock_llm_configuration
    assert ciris_runtime._mock_llm is True
E   AttributeError: 'CIRISRuntime' object has no attribute '_mock_llm'
------------------------------------------------------------------------- Captured log setup --------------------------------------------------------------------------
WARNING  ciris_engine.logic.adapters.cli.cli_observer:cli_observer.py:91 Error checking for piped input: redirected stdin is pseudofile, has no fileno()
________________________________________________________________ TestGraphAuditService.test_start_stop ________________________________________________________________
tests/ciris_engine/logic/services/graph/test_audit_service_unit.py:52: in test_start_stop
    assert audit_service._running is True
E   AttributeError: 'GraphAuditService' object has no attribute '_running'
_______________________________________________________________ TestGraphAuditService.test_audit_event ________________________________________________________________
tests/ciris_engine/logic/services/graph/test_audit_service_unit.py:64: in test_audit_event
    await audit_service.audit_event(
E   AttributeError: 'GraphAuditService' object has no attribute 'audit_event'
___________________________________________________________ TestGraphAuditService.test_audit_authentication ___________________________________________________________
tests/ciris_engine/logic/services/graph/test_audit_service_unit.py:89: in test_audit_authentication
    await audit_service.audit_authentication(
E   AttributeError: 'GraphAuditService' object has no attribute 'audit_authentication'
_______________________________________________________ TestGraphAuditService.test_audit_authentication_failure _______________________________________________________
tests/ciris_engine/logic/services/graph/test_audit_service_unit.py:111: in test_audit_authentication_failure
    await audit_service.audit_authentication(
E   AttributeError: 'GraphAuditService' object has no attribute 'audit_authentication'
________________________________________________________ TestGraphAuditService.test_audit_configuration_change ________________________________________________________
tests/ciris_engine/logic/services/graph/test_audit_service_unit.py:132: in test_audit_configuration_change
    await audit_service.audit_configuration_change(
E   AttributeError: 'GraphAuditService' object has no attribute 'audit_configuration_change'
____________________________________________________________ TestGraphAuditService.test_audit_data_access _____________________________________________________________
tests/ciris_engine/logic/services/graph/test_audit_service_unit.py:155: in test_audit_data_access
    await audit_service.audit_data_access(
E   AttributeError: 'GraphAuditService' object has no attribute 'audit_data_access'
_______________________________________________________________ TestGraphAuditService.test_audit_error ________________________________________________________________
tests/ciris_engine/logic/services/graph/test_audit_service_unit.py:178: in test_audit_error
    await audit_service.audit_error(
E   AttributeError: 'GraphAuditService' object has no attribute 'audit_error'
_____________________________________________________________ TestGraphAuditService.test_query_audit_log ______________________________________________________________
tests/ciris_engine/logic/services/graph/test_audit_service_unit.py:203: in test_query_audit_log
    type=NodeType.AUDIT,
E   AttributeError: type object 'NodeType' has no attribute 'AUDIT'
_______________________________________________________ TestGraphAuditService.test_query_audit_log_with_filters _______________________________________________________
tests/ciris_engine/logic/services/graph/test_audit_service_unit.py:241: in test_query_audit_log_with_filters
    await audit_service.query_audit_log(
E   AttributeError: 'GraphAuditService' object has no attribute 'query_audit_log'. Did you mean: 'query_audit_trail'?
___________________________________________________________ TestGraphAuditService.test_cleanup_old_entries ____________________________________________________________
tests/ciris_engine/logic/services/graph/test_audit_service_unit.py:269: in test_cleanup_old_entries
    type=NodeType.AUDIT,
E   AttributeError: type object 'NodeType' has no attribute 'AUDIT'
___________________________________________________________ TestGraphAuditService.test_get_audit_statistics ___________________________________________________________
tests/ciris_engine/logic/services/graph/test_audit_service_unit.py:300: in test_get_audit_statistics
    type=NodeType.AUDIT,
E   AttributeError: type object 'NodeType' has no attribute 'AUDIT'
_____________________________________________________________ TestGraphAuditService.test_get_capabilities _____________________________________________________________
tests/ciris_engine/logic/services/graph/test_audit_service_unit.py:332: in test_get_capabilities
    assert "audit_event" in caps.actions
E   AssertionError: assert 'audit_event' in ['log_action', 'log_event', 'log_conscience_event', 'get_audit_trail', 'query_audit_trail', 'verify_audit_integrity', ...]
E    +  where ['log_action', 'log_event', 'log_conscience_event', 'get_audit_trail', 'query_audit_trail', 'verify_audit_integrity', ...] = ServiceCapabilities(service_name='GraphAuditService', actions=['log_action', 'log_event', 'log_conscience_event', 'get_audit_trail', 'query_audit_trail', 'verify_audit_integrity', 'get_verification_report', 'export_audit_data', 'store_in_graph', 'query_graph'], version='2.0.0', dependencies=['MemoryService'], metadata=None).actions
________________________________________________________________ TestGraphAuditService.test_get_status ________________________________________________________________
tests/ciris_engine/logic/services/graph/test_audit_service_unit.py:346: in test_get_status
    assert status.metrics["total_events"] == 100.0
E   KeyError: 'total_events'
_________________________________________________________ TestGraphAuditService.test_concurrent_audit_events __________________________________________________________
tests/ciris_engine/logic/services/graph/test_audit_service_unit.py:357: in test_concurrent_audit_events
    task = audit_service.audit_event(
E   AttributeError: 'GraphAuditService' object has no attribute 'audit_event'
_________________________________________________________ TestGraphAuditService.test_audit_with_large_details _________________________________________________________
tests/ciris_engine/logic/services/graph/test_audit_service_unit.py:384: in test_audit_with_large_details
    await audit_service.audit_event(
E   AttributeError: 'GraphAuditService' object has no attribute 'audit_event'
________________________________________________________________ TestGraphAuditService.test_node_type _________________________________________________________________
tests/ciris_engine/logic/services/graph/test_audit_service_unit.py:403: in test_node_type
    assert node_type == NodeType.AUDIT
E   AttributeError: type object 'NodeType' has no attribute 'AUDIT'
__________________________________________________________________ test_llm_service_call_structured ___________________________________________________________________
tests/ciris_engine/logic/services/runtime/test_llm_service.py:38: in test_llm_service_call_structured
    mock_result = ActionSelectionDMAResult(
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for ActionSelectionDMAResult
E   confidence
E     Extra inputs are not permitted [type=extra_forbidden, input_value=0.95, input_type=float]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
________________________________________________________________ test_memorize_handler_with_graph_node ________________________________________________________________
tests/test_memory_handlers.py:140: in test_memorize_handler_with_graph_node
    result = ActionSelectionDMAResult(
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for ActionSelectionDMAResult
E   confidence
E     Extra inputs are not permitted [type=extra_forbidden, input_value=0.95, input_type=float]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
-------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 CommunicationBus initialized for communication
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 MemoryBus initialized for memory
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 ToolBus initialized for tool
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 WiseBus initialized for wise_authority
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 RuntimeControlBus initialized for runtime_control
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 LLMBus initialized for llm
INFO     ciris_engine.logic.buses.llm_bus:llm_bus.py:110 LLMBus initialized with DistributionStrategy.LATENCY_BASED distribution strategy
INFO     ciris_engine.logic.buses.bus_manager:bus_manager.py:64 BusManager initialized with all message buses
___________________________________________________________________ test_recall_handler_with_query ____________________________________________________________________
tests/test_memory_handlers.py:230: in test_recall_handler_with_query
    result = ActionSelectionDMAResult(
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for ActionSelectionDMAResult
E   confidence
E     Extra inputs are not permitted [type=extra_forbidden, input_value=0.95, input_type=float]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
-------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 CommunicationBus initialized for communication
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 MemoryBus initialized for memory
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 ToolBus initialized for tool
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 WiseBus initialized for wise_authority
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 RuntimeControlBus initialized for runtime_control
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 LLMBus initialized for llm
INFO     ciris_engine.logic.buses.llm_bus:llm_bus.py:110 LLMBus initialized with DistributionStrategy.LATENCY_BASED distribution strategy
INFO     ciris_engine.logic.buses.bus_manager:bus_manager.py:64 BusManager initialized with all message buses
________________________________________________________________ test_memorize_handler_error_handling _________________________________________________________________
tests/test_memory_handlers.py:308: in test_memorize_handler_error_handling
    result = ActionSelectionDMAResult(
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for ActionSelectionDMAResult
E   confidence
E     Extra inputs are not permitted [type=extra_forbidden, input_value=0.95, input_type=float]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
-------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 CommunicationBus initialized for communication
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 MemoryBus initialized for memory
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 ToolBus initialized for tool
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 WiseBus initialized for wise_authority
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 RuntimeControlBus initialized for runtime_control
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 LLMBus initialized for llm
INFO     ciris_engine.logic.buses.llm_bus:llm_bus.py:110 LLMBus initialized with DistributionStrategy.LATENCY_BASED distribution strategy
INFO     ciris_engine.logic.buses.bus_manager:bus_manager.py:64 BusManager initialized with all message buses
__________________________________________________________ TestRecallHandler.test_recall_by_node_id_success ___________________________________________________________
tests/test_memory_handlers_comprehensive.py:590: in test_recall_by_node_id_success
    assert "{'content': 'Recalled content', 'data': 'test'}" in str(follow_up_thought.content)
E   assert "{'content': 'Recalled content', 'data': 'test'}" in "CIRIS_FOLLOW_UP_THOUGHT: Memory query 'recalled_node' returned: {'recalled_node': {'content': 'Recalled content', 'data': 'test', 'created_at': '2025-06-27T19:21:17.941741+00:00', 'updated_at': '2025-06-27T19:21:17.941763+00:00', 'created_by': 'test_user'}}"
E    +  where "CIRIS_FOLLOW_UP_THOUGHT: Memory query 'recalled_node' returned: {'recalled_node': {'content': 'Recalled content', 'data': 'test', 'created_at': '2025-06-27T19:21:17.941741+00:00', 'updated_at': '2025-06-27T19:21:17.941763+00:00', 'created_by': 'test_user'}}" = str("CIRIS_FOLLOW_UP_THOUGHT: Memory query 'recalled_node' returned: {'recalled_node': {'content': 'Recalled content', 'data': 'test', 'created_at': '2025-06-27T19:21:17.941741+00:00', 'updated_at': '2025-06-27T19:21:17.941763+00:00', 'created_by': 'test_user'}}")
E    +    where "CIRIS_FOLLOW_UP_THOUGHT: Memory query 'recalled_node' returned: {'recalled_node': {'content': 'Recalled content', 'data': 'test', 'created_at': '2025-06-27T19:21:17.941741+00:00', 'updated_at': '2025-06-27T19:21:17.941763+00:00', 'created_by': 'test_user'}}" = Thought(thought_id='7402efda-6e4e-4b8e-beb2-e7ec5ee2714e', source_task_id='test_task', channel_id=None, thought_type=<ThoughtType.FOLLOW_UP: 'follow_up'>, status=<ThoughtStatus.PENDING: 'pending'>, created_at='2025-06-27T19:21:17.942335+00:00', updated_at='2025-06-27T19:21:17.942335+00:00', round_number=0, content="CIRIS_FOLLOW_UP_THOUGHT: Memory query 'recalled_node' returned: {'recalled_node': {'content': 'Recalled content', 'data': 'test', 'created_at': '2025-06-27T19:21:17.941741+00:00', 'updated_at': '2025-06-27T19:21:17.941763+00:00', 'created_by': 'test_user'}}", context=ThoughtContext(task_id='test_task', channel_id=None, round_number=1, depth=1, parent_thought_id=None, correlation_id='test_correlation'), thought_depth=2, ponder_notes=None, parent_thought_id='test_thought', final_action=None).content
-------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 CommunicationBus initialized for communication
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 MemoryBus initialized for memory
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 ToolBus initialized for tool
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 WiseBus initialized for wise_authority
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 RuntimeControlBus initialized for runtime_control
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 LLMBus initialized for llm
INFO     ciris_engine.logic.buses.llm_bus:llm_bus.py:110 LLMBus initialized with DistributionStrategy.LATENCY_BASED distribution strategy
INFO     ciris_engine.logic.buses.bus_manager:bus_manager.py:64 BusManager initialized with all message buses
___________________________________________________________ TestRecallHandler.test_recall_by_query_success ____________________________________________________________
tests/test_memory_handlers_comprehensive.py:642: in test_recall_by_query_success
    assert "CONCEPT test search query" in follow_up_thought.content
E   assert 'CONCEPT test search query' in "CIRIS_FOLLOW_UP_THOUGHT: Memory query 'concept test search query' returned: {'node1': {'content': 'First match', 'created_at': '2025-06-27T19:21:18.144235+00:00', 'updated_at': '2025-06-27T19:21:18.144256+00:00', 'created_by': 'test_user'}, 'node2': {'content': 'Second match', 'created_at': '2025-06-27T19:21:18.144316+00:00', 'updated_at': '2025-06-27T19:21:18.144319+00:00', 'created_by': 'test_user'}}"
E    +  where "CIRIS_FOLLOW_UP_THOUGHT: Memory query 'concept test search query' returned: {'node1': {'content': 'First match', 'created_at': '2025-06-27T19:21:18.144235+00:00', 'updated_at': '2025-06-27T19:21:18.144256+00:00', 'created_by': 'test_user'}, 'node2': {'content': 'Second match', 'created_at': '2025-06-27T19:21:18.144316+00:00', 'updated_at': '2025-06-27T19:21:18.144319+00:00', 'created_by': 'test_user'}}" = Thought(thought_id='6f34da64-d06a-4cad-adf3-598cd49c2eae', source_task_id='test_task', channel_id=None, thought_type=<ThoughtType.FOLLOW_UP: 'follow_up'>, status=<ThoughtStatus.PENDING: 'pending'>, created_at='2025-06-27T19:21:18.145013+00:00', updated_at='2025-06-27T19:21:18.145013+00:00', round_number=0, content="CIRIS_FOLLOW_UP_THOUGHT: Memory query 'concept test search query' returned: {'node1': {'content': 'First match', 'created_at': '2025-06-27T19:21:18.144235+00:00', 'updated_at': '2025-06-27T19:21:18.144256+00:00', 'created_by': 'test_user'}, 'node2': {'content': 'Second match', 'created_at': '2025-06-27T19:21:18.144316+00:00', 'updated_at': '2025-06-27T19:21:18.144319+00:00', 'created_by': 'test_user'}}", context=ThoughtContext(task_id='test_task', channel_id=None, round_number=1, depth=1, parent_thought_id=None, correlation_id='test_correlation'), thought_depth=2, ponder_notes=None, parent_thought_id='test_thought', final_action=None).content
-------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 CommunicationBus initialized for communication
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 MemoryBus initialized for memory
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 ToolBus initialized for tool
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 WiseBus initialized for wise_authority
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 RuntimeControlBus initialized for runtime_control
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 LLMBus initialized for llm
INFO     ciris_engine.logic.buses.llm_bus:llm_bus.py:110 LLMBus initialized with DistributionStrategy.LATENCY_BASED distribution strategy
INFO     ciris_engine.logic.buses.bus_manager:bus_manager.py:64 BusManager initialized with all message buses
__________________________________________________________ TestRecallHandler.test_recall_invalid_parameters ___________________________________________________________
tests/test_memory_handlers_comprehensive.py:701: in test_recall_invalid_parameters
    result = ActionSelectionDMAResult(
E   pydantic_core._pydantic_core.ValidationError: 27 validation errors for ActionSelectionDMAResult
E   action_parameters.ObserveParams.query
E     Extra inputs are not permitted [type=extra_forbidden, input_value='test', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.ObserveParams.limit
E     Extra inputs are not permitted [type=extra_forbidden, input_value='not_a_number', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.SpeakParams.content
E     Field required [type=missing, input_value={'query': 'test', 'limit': 'not_a_number'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.SpeakParams.query
E     Extra inputs are not permitted [type=extra_forbidden, input_value='test', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.SpeakParams.limit
E     Extra inputs are not permitted [type=extra_forbidden, input_value='not_a_number', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.ToolParams.name
E     Field required [type=missing, input_value={'query': 'test', 'limit': 'not_a_number'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.ToolParams.query
E     Extra inputs are not permitted [type=extra_forbidden, input_value='test', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.ToolParams.limit
E     Extra inputs are not permitted [type=extra_forbidden, input_value='not_a_number', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.PonderParams.questions
E     Field required [type=missing, input_value={'query': 'test', 'limit': 'not_a_number'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.PonderParams.query
E     Extra inputs are not permitted [type=extra_forbidden, input_value='test', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.PonderParams.limit
E     Extra inputs are not permitted [type=extra_forbidden, input_value='not_a_number', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.RejectParams.reason
E     Field required [type=missing, input_value={'query': 'test', 'limit': 'not_a_number'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.RejectParams.query
E     Extra inputs are not permitted [type=extra_forbidden, input_value='test', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.RejectParams.limit
E     Extra inputs are not permitted [type=extra_forbidden, input_value='not_a_number', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.DeferParams.reason
E     Field required [type=missing, input_value={'query': 'test', 'limit': 'not_a_number'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.DeferParams.query
E     Extra inputs are not permitted [type=extra_forbidden, input_value='test', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.DeferParams.limit
E     Extra inputs are not permitted [type=extra_forbidden, input_value='not_a_number', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.MemorizeParams.node
E     Field required [type=missing, input_value={'query': 'test', 'limit': 'not_a_number'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.MemorizeParams.query
E     Extra inputs are not permitted [type=extra_forbidden, input_value='test', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.MemorizeParams.limit
E     Extra inputs are not permitted [type=extra_forbidden, input_value='not_a_number', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.RecallParams.limit
E     Input should be a valid integer, unable to parse string as an integer [type=int_parsing, input_value='not_a_number', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/int_parsing
E   action_parameters.ForgetParams.node
E     Field required [type=missing, input_value={'query': 'test', 'limit': 'not_a_number'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.ForgetParams.reason
E     Field required [type=missing, input_value={'query': 'test', 'limit': 'not_a_number'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.ForgetParams.query
E     Extra inputs are not permitted [type=extra_forbidden, input_value='test', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.ForgetParams.limit
E     Extra inputs are not permitted [type=extra_forbidden, input_value='not_a_number', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.TaskCompleteParams.query
E     Extra inputs are not permitted [type=extra_forbidden, input_value='test', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.TaskCompleteParams.limit
E     Extra inputs are not permitted [type=extra_forbidden, input_value='not_a_number', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
-------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 CommunicationBus initialized for communication
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 MemoryBus initialized for memory
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 ToolBus initialized for tool
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 WiseBus initialized for wise_authority
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 RuntimeControlBus initialized for runtime_control
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 LLMBus initialized for llm
INFO     ciris_engine.logic.buses.llm_bus:llm_bus.py:110 LLMBus initialized with DistributionStrategy.LATENCY_BASED distribution strategy
INFO     ciris_engine.logic.buses.bus_manager:bus_manager.py:64 BusManager initialized with all message buses
__________________________________________________________ TestRecallHandler.test_recall_with_all_parameters __________________________________________________________
tests/test_memory_handlers_comprehensive.py:739: in test_recall_with_all_parameters
    node_type=NodeType.TASK,
E   AttributeError: type object 'NodeType' has no attribute 'TASK'
-------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 CommunicationBus initialized for communication
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 MemoryBus initialized for memory
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 ToolBus initialized for tool
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 WiseBus initialized for wise_authority
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 RuntimeControlBus initialized for runtime_control
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 LLMBus initialized for llm
INFO     ciris_engine.logic.buses.llm_bus:llm_bus.py:110 LLMBus initialized with DistributionStrategy.LATENCY_BASED distribution strategy
INFO     ciris_engine.logic.buses.bus_manager:bus_manager.py:64 BusManager initialized with all message buses
________________________________________________________________ TestForgetHandler.test_forget_success ________________________________________________________________
tests/test_memory_handlers_comprehensive.py:823: in test_forget_success
    await handler.handle(result, thought, dispatch_context)
ciris_engine/logic/handlers/memory/forget_handler.py:125: in handle
    follow_up.context = ThoughtContext.model_validate(context_data)
E   pydantic_core._pydantic_core.ValidationError: 14 validation errors for ThoughtContext
E   thought_id
E     Field required [type=missing, input_value={'task_id': 'test_task', ...s': 'MemoryOpStatus.OK'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   content
E     Field required [type=missing, input_value={'task_id': 'test_task', ...s': 'MemoryOpStatus.OK'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   thought_type
E     Field required [type=missing, input_value={'task_id': 'test_task', ...s': 'MemoryOpStatus.OK'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   created_at
E     Field required [type=missing, input_value={'task_id': 'test_task', ...s': 'MemoryOpStatus.OK'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   channel_id
E     Extra inputs are not permitted [type=extra_forbidden, input_value=None, input_type=NoneType]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   round_number
E     Extra inputs are not permitted [type=extra_forbidden, input_value=1, input_type=int]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   depth
E     Extra inputs are not permitted [type=extra_forbidden, input_value=1, input_type=int]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   correlation_id
E     Extra inputs are not permitted [type=extra_forbidden, input_value='test_correlation', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_performed
E     Extra inputs are not permitted [type=extra_forbidden, input_value='FORGET', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   parent_task_id
E     Extra inputs are not permitted [type=extra_forbidden, input_value='test_task', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   is_follow_up
E     Extra inputs are not permitted [type=extra_forbidden, input_value=True, input_type=bool]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   forget_key
E     Extra inputs are not permitted [type=extra_forbidden, input_value='forget_me', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   forget_scope
E     Extra inputs are not permitted [type=extra_forbidden, input_value='local', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   forget_status
E     Extra inputs are not permitted [type=extra_forbidden, input_value='MemoryOpStatus.OK', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
-------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 CommunicationBus initialized for communication
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 MemoryBus initialized for memory
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 ToolBus initialized for tool
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 WiseBus initialized for wise_authority
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 RuntimeControlBus initialized for runtime_control
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 LLMBus initialized for llm
INFO     ciris_engine.logic.buses.llm_bus:llm_bus.py:110 LLMBus initialized with DistributionStrategy.LATENCY_BASED distribution strategy
INFO     ciris_engine.logic.buses.bus_manager:bus_manager.py:64 BusManager initialized with all message buses
_______________________________________________________ TestForgetHandler.test_forget_identity_scope_without_wa _______________________________________________________
tests/test_memory_handlers_comprehensive.py:870: in test_forget_identity_scope_without_wa
    await handler.handle(result, thought, dispatch_context)
ciris_engine/logic/handlers/memory/forget_handler.py:71: in handle
    follow_up.context = ThoughtContext.model_validate(context_data)
E   pydantic_core._pydantic_core.ValidationError: 12 validation errors for ThoughtContext
E   thought_id
E     Field required [type=missing, input_value={'task_id': 'test_task', ... denied or WA required'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   content
E     Field required [type=missing, input_value={'task_id': 'test_task', ... denied or WA required'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   thought_type
E     Field required [type=missing, input_value={'task_id': 'test_task', ... denied or WA required'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   created_at
E     Field required [type=missing, input_value={'task_id': 'test_task', ... denied or WA required'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   channel_id
E     Extra inputs are not permitted [type=extra_forbidden, input_value=None, input_type=NoneType]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   round_number
E     Extra inputs are not permitted [type=extra_forbidden, input_value=1, input_type=int]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   depth
E     Extra inputs are not permitted [type=extra_forbidden, input_value=1, input_type=int]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   correlation_id
E     Extra inputs are not permitted [type=extra_forbidden, input_value='test_correlation', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_performed
E     Extra inputs are not permitted [type=extra_forbidden, input_value='FORGET', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   parent_task_id
E     Extra inputs are not permitted [type=extra_forbidden, input_value='test_task', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   is_follow_up
E     Extra inputs are not permitted [type=extra_forbidden, input_value=True, input_type=bool]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   error
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Permission denied or WA required', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
-------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 CommunicationBus initialized for communication
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 MemoryBus initialized for memory
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 ToolBus initialized for tool
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 WiseBus initialized for wise_authority
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 RuntimeControlBus initialized for runtime_control
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 LLMBus initialized for llm
INFO     ciris_engine.logic.buses.llm_bus:llm_bus.py:110 LLMBus initialized with DistributionStrategy.LATENCY_BASED distribution strategy
INFO     ciris_engine.logic.buses.bus_manager:bus_manager.py:64 BusManager initialized with all message buses
INFO     ciris_engine.logic.handlers.memory.forget_handler:forget_handler.py:60 ForgetHandler: Permission denied or WA required for forget operation. Creating deferral.
_______________________________________________________ TestForgetHandler.test_forget_environment_scope_with_wa _______________________________________________________
tests/test_memory_handlers_comprehensive.py:916: in test_forget_environment_scope_with_wa
    await handler.handle(result, thought, dispatch_context)
ciris_engine/logic/handlers/memory/forget_handler.py:125: in handle
    follow_up.context = ThoughtContext.model_validate(context_data)
E   pydantic_core._pydantic_core.ValidationError: 14 validation errors for ThoughtContext
E   thought_id
E     Field required [type=missing, input_value={'task_id': 'test_task', ...s': 'MemoryOpStatus.OK'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   content
E     Field required [type=missing, input_value={'task_id': 'test_task', ...s': 'MemoryOpStatus.OK'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   thought_type
E     Field required [type=missing, input_value={'task_id': 'test_task', ...s': 'MemoryOpStatus.OK'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   created_at
E     Field required [type=missing, input_value={'task_id': 'test_task', ...s': 'MemoryOpStatus.OK'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   channel_id
E     Extra inputs are not permitted [type=extra_forbidden, input_value=None, input_type=NoneType]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   round_number
E     Extra inputs are not permitted [type=extra_forbidden, input_value=1, input_type=int]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   depth
E     Extra inputs are not permitted [type=extra_forbidden, input_value=1, input_type=int]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   correlation_id
E     Extra inputs are not permitted [type=extra_forbidden, input_value='test_correlation', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_performed
E     Extra inputs are not permitted [type=extra_forbidden, input_value='FORGET', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   parent_task_id
E     Extra inputs are not permitted [type=extra_forbidden, input_value='test_task', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   is_follow_up
E     Extra inputs are not permitted [type=extra_forbidden, input_value=True, input_type=bool]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   forget_key
E     Extra inputs are not permitted [type=extra_forbidden, input_value='env_node', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   forget_scope
E     Extra inputs are not permitted [type=extra_forbidden, input_value='environment', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   forget_status
E     Extra inputs are not permitted [type=extra_forbidden, input_value='MemoryOpStatus.OK', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
-------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 CommunicationBus initialized for communication
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 MemoryBus initialized for memory
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 ToolBus initialized for tool
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 WiseBus initialized for wise_authority
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 RuntimeControlBus initialized for runtime_control
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 LLMBus initialized for llm
INFO     ciris_engine.logic.buses.llm_bus:llm_bus.py:110 LLMBus initialized with DistributionStrategy.LATENCY_BASED distribution strategy
INFO     ciris_engine.logic.buses.bus_manager:bus_manager.py:64 BusManager initialized with all message buses
__________________________________________________________ TestForgetHandler.test_forget_with_no_audit_flag ___________________________________________________________
tests/test_memory_handlers_comprehensive.py:956: in test_forget_with_no_audit_flag
    await handler.handle(result, thought, dispatch_context)
ciris_engine/logic/handlers/memory/forget_handler.py:125: in handle
    follow_up.context = ThoughtContext.model_validate(context_data)
E   pydantic_core._pydantic_core.ValidationError: 14 validation errors for ThoughtContext
E   thought_id
E     Field required [type=missing, input_value={'task_id': 'test_task', ...s': 'MemoryOpStatus.OK'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   content
E     Field required [type=missing, input_value={'task_id': 'test_task', ...s': 'MemoryOpStatus.OK'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   thought_type
E     Field required [type=missing, input_value={'task_id': 'test_task', ...s': 'MemoryOpStatus.OK'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   created_at
E     Field required [type=missing, input_value={'task_id': 'test_task', ...s': 'MemoryOpStatus.OK'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   channel_id
E     Extra inputs are not permitted [type=extra_forbidden, input_value=None, input_type=NoneType]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   round_number
E     Extra inputs are not permitted [type=extra_forbidden, input_value=1, input_type=int]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   depth
E     Extra inputs are not permitted [type=extra_forbidden, input_value=1, input_type=int]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   correlation_id
E     Extra inputs are not permitted [type=extra_forbidden, input_value='test_correlation', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_performed
E     Extra inputs are not permitted [type=extra_forbidden, input_value='FORGET', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   parent_task_id
E     Extra inputs are not permitted [type=extra_forbidden, input_value='test_task', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   is_follow_up
E     Extra inputs are not permitted [type=extra_forbidden, input_value=True, input_type=bool]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   forget_key
E     Extra inputs are not permitted [type=extra_forbidden, input_value='test_node', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   forget_scope
E     Extra inputs are not permitted [type=extra_forbidden, input_value='local', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   forget_status
E     Extra inputs are not permitted [type=extra_forbidden, input_value='MemoryOpStatus.OK', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
-------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 CommunicationBus initialized for communication
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 MemoryBus initialized for memory
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 ToolBus initialized for tool
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 WiseBus initialized for wise_authority
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 RuntimeControlBus initialized for runtime_control
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 LLMBus initialized for llm
INFO     ciris_engine.logic.buses.llm_bus:llm_bus.py:110 LLMBus initialized with DistributionStrategy.LATENCY_BASED distribution strategy
INFO     ciris_engine.logic.buses.bus_manager:bus_manager.py:64 BusManager initialized with all message buses
__________________________________________________________ TestForgetHandler.test_forget_invalid_params_dict __________________________________________________________
tests/test_memory_handlers_comprehensive.py:981: in test_forget_invalid_params_dict
    result = ActionSelectionDMAResult(
E   pydantic_core._pydantic_core.ValidationError: 21 validation errors for ActionSelectionDMAResult
E   action_parameters.ObserveParams.node_id
E     Extra inputs are not permitted [type=extra_forbidden, input_value='test', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.ObserveParams.reason
E     Extra inputs are not permitted [type=extra_forbidden, input_value='test', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.SpeakParams.content
E     Field required [type=missing, input_value={'node_id': 'test', 'reason': 'test'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.SpeakParams.node_id
E     Extra inputs are not permitted [type=extra_forbidden, input_value='test', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.SpeakParams.reason
E     Extra inputs are not permitted [type=extra_forbidden, input_value='test', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.ToolParams.name
E     Field required [type=missing, input_value={'node_id': 'test', 'reason': 'test'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.ToolParams.node_id
E     Extra inputs are not permitted [type=extra_forbidden, input_value='test', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.ToolParams.reason
E     Extra inputs are not permitted [type=extra_forbidden, input_value='test', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.PonderParams.questions
E     Field required [type=missing, input_value={'node_id': 'test', 'reason': 'test'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.PonderParams.node_id
E     Extra inputs are not permitted [type=extra_forbidden, input_value='test', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.PonderParams.reason
E     Extra inputs are not permitted [type=extra_forbidden, input_value='test', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.RejectParams.node_id
E     Extra inputs are not permitted [type=extra_forbidden, input_value='test', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.DeferParams.node_id
E     Extra inputs are not permitted [type=extra_forbidden, input_value='test', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.MemorizeParams.node
E     Field required [type=missing, input_value={'node_id': 'test', 'reason': 'test'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.MemorizeParams.node_id
E     Extra inputs are not permitted [type=extra_forbidden, input_value='test', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.MemorizeParams.reason
E     Extra inputs are not permitted [type=extra_forbidden, input_value='test', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.RecallParams.reason
E     Extra inputs are not permitted [type=extra_forbidden, input_value='test', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.ForgetParams.node
E     Field required [type=missing, input_value={'node_id': 'test', 'reason': 'test'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   action_parameters.ForgetParams.node_id
E     Extra inputs are not permitted [type=extra_forbidden, input_value='test', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.TaskCompleteParams.node_id
E     Extra inputs are not permitted [type=extra_forbidden, input_value='test', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_parameters.TaskCompleteParams.reason
E     Extra inputs are not permitted [type=extra_forbidden, input_value='test', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
-------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 CommunicationBus initialized for communication
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 MemoryBus initialized for memory
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 ToolBus initialized for tool
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 WiseBus initialized for wise_authority
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 RuntimeControlBus initialized for runtime_control
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 LLMBus initialized for llm
INFO     ciris_engine.logic.buses.llm_bus:llm_bus.py:110 LLMBus initialized with DistributionStrategy.LATENCY_BASED distribution strategy
INFO     ciris_engine.logic.buses.bus_manager:bus_manager.py:64 BusManager initialized with all message buses
__________________________________________________________ TestForgetHandler.test_forget_invalid_params_type __________________________________________________________
tests/test_memory_handlers_comprehensive.py:1034: in test_forget_invalid_params_type
    await handler.handle(result, thought, dispatch_context)
ciris_engine/logic/handlers/memory/forget_handler.py:55: in handle
    follow_up.context = ThoughtContext.model_validate(context_data)
E   pydantic_core._pydantic_core.ValidationError: 12 validation errors for ThoughtContext
E   thought_id
E     Field required [type=missing, input_value={'task_id': 'test_task', ...ms type: <class 'str'>"}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   content
E     Field required [type=missing, input_value={'task_id': 'test_task', ...ms type: <class 'str'>"}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   thought_type
E     Field required [type=missing, input_value={'task_id': 'test_task', ...ms type: <class 'str'>"}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   created_at
E     Field required [type=missing, input_value={'task_id': 'test_task', ...ms type: <class 'str'>"}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   channel_id
E     Extra inputs are not permitted [type=extra_forbidden, input_value=None, input_type=NoneType]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   round_number
E     Extra inputs are not permitted [type=extra_forbidden, input_value=1, input_type=int]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   depth
E     Extra inputs are not permitted [type=extra_forbidden, input_value=1, input_type=int]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   correlation_id
E     Extra inputs are not permitted [type=extra_forbidden, input_value='test_correlation', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_performed
E     Extra inputs are not permitted [type=extra_forbidden, input_value='FORGET', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   parent_task_id
E     Extra inputs are not permitted [type=extra_forbidden, input_value='test_task', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   is_follow_up
E     Extra inputs are not permitted [type=extra_forbidden, input_value=True, input_type=bool]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   error
E     Extra inputs are not permitted [type=extra_forbidden, input_value="Invalid params type: <class 'str'>", input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
-------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 CommunicationBus initialized for communication
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 MemoryBus initialized for memory
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 ToolBus initialized for tool
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 WiseBus initialized for wise_authority
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 RuntimeControlBus initialized for runtime_control
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 LLMBus initialized for llm
INFO     ciris_engine.logic.buses.llm_bus:llm_bus.py:110 LLMBus initialized with DistributionStrategy.LATENCY_BASED distribution strategy
INFO     ciris_engine.logic.buses.bus_manager:bus_manager.py:64 BusManager initialized with all message buses
ERROR    ciris_engine.logic.handlers.memory.forget_handler:forget_handler.py:44 ForgetHandler: Invalid params type: <class 'str'>
___________________________________________________________ TestForgetHandler.test_forget_permission_denied ___________________________________________________________
tests/test_memory_handlers_comprehensive.py:1074: in test_forget_permission_denied
    await handler.handle(result, thought, dispatch_context)
ciris_engine/logic/handlers/memory/forget_handler.py:71: in handle
    follow_up.context = ThoughtContext.model_validate(context_data)
E   pydantic_core._pydantic_core.ValidationError: 12 validation errors for ThoughtContext
E   thought_id
E     Field required [type=missing, input_value={'task_id': 'test_task', ... denied or WA required'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   content
E     Field required [type=missing, input_value={'task_id': 'test_task', ... denied or WA required'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   thought_type
E     Field required [type=missing, input_value={'task_id': 'test_task', ... denied or WA required'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   created_at
E     Field required [type=missing, input_value={'task_id': 'test_task', ... denied or WA required'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   channel_id
E     Extra inputs are not permitted [type=extra_forbidden, input_value=None, input_type=NoneType]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   round_number
E     Extra inputs are not permitted [type=extra_forbidden, input_value=1, input_type=int]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   depth
E     Extra inputs are not permitted [type=extra_forbidden, input_value=1, input_type=int]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   correlation_id
E     Extra inputs are not permitted [type=extra_forbidden, input_value='test_correlation', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_performed
E     Extra inputs are not permitted [type=extra_forbidden, input_value='FORGET', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   parent_task_id
E     Extra inputs are not permitted [type=extra_forbidden, input_value='test_task', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   is_follow_up
E     Extra inputs are not permitted [type=extra_forbidden, input_value=True, input_type=bool]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   error
E     Extra inputs are not permitted [type=extra_forbidden, input_value='Permission denied or WA required', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
-------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 CommunicationBus initialized for communication
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 MemoryBus initialized for memory
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 ToolBus initialized for tool
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 WiseBus initialized for wise_authority
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 RuntimeControlBus initialized for runtime_control
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 LLMBus initialized for llm
INFO     ciris_engine.logic.buses.llm_bus:llm_bus.py:110 LLMBus initialized with DistributionStrategy.LATENCY_BASED distribution strategy
INFO     ciris_engine.logic.buses.bus_manager:bus_manager.py:64 BusManager initialized with all message buses
INFO     ciris_engine.logic.handlers.memory.forget_handler:forget_handler.py:60 ForgetHandler: Permission denied or WA required for forget operation. Creating deferral.
___________________________________________________________ TestForgetHandler.test_forget_failed_operation ____________________________________________________________
tests/test_memory_handlers_comprehensive.py:1115: in test_forget_failed_operation
    await handler.handle(result, thought, dispatch_context)
ciris_engine/logic/handlers/memory/forget_handler.py:125: in handle
    follow_up.context = ThoughtContext.model_validate(context_data)
E   pydantic_core._pydantic_core.ValidationError: 14 validation errors for ThoughtContext
E   thought_id
E     Field required [type=missing, input_value={'task_id': 'test_task', ... 'MemoryOpStatus.ERROR'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   content
E     Field required [type=missing, input_value={'task_id': 'test_task', ... 'MemoryOpStatus.ERROR'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   thought_type
E     Field required [type=missing, input_value={'task_id': 'test_task', ... 'MemoryOpStatus.ERROR'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   created_at
E     Field required [type=missing, input_value={'task_id': 'test_task', ... 'MemoryOpStatus.ERROR'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   channel_id
E     Extra inputs are not permitted [type=extra_forbidden, input_value=None, input_type=NoneType]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   round_number
E     Extra inputs are not permitted [type=extra_forbidden, input_value=1, input_type=int]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   depth
E     Extra inputs are not permitted [type=extra_forbidden, input_value=1, input_type=int]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   correlation_id
E     Extra inputs are not permitted [type=extra_forbidden, input_value='test_correlation', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   action_performed
E     Extra inputs are not permitted [type=extra_forbidden, input_value='FORGET', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   parent_task_id
E     Extra inputs are not permitted [type=extra_forbidden, input_value='test_task', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   is_follow_up
E     Extra inputs are not permitted [type=extra_forbidden, input_value=True, input_type=bool]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   forget_key
E     Extra inputs are not permitted [type=extra_forbidden, input_value='missing_node', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   forget_scope
E     Extra inputs are not permitted [type=extra_forbidden, input_value='local', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
E   forget_status
E     Extra inputs are not permitted [type=extra_forbidden, input_value='MemoryOpStatus.ERROR', input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/extra_forbidden
-------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 CommunicationBus initialized for communication
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 MemoryBus initialized for memory
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 ToolBus initialized for tool
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 WiseBus initialized for wise_authority
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 RuntimeControlBus initialized for runtime_control
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 LLMBus initialized for llm
INFO     ciris_engine.logic.buses.llm_bus:llm_bus.py:110 LLMBus initialized with DistributionStrategy.LATENCY_BASED distribution strategy
INFO     ciris_engine.logic.buses.bus_manager:bus_manager.py:64 BusManager initialized with all message buses
___________________________________________________________ TestWiseBusDeferrals.test_send_deferral_success ___________________________________________________________
tests/test_wise_bus_deferrals.py:90: in test_send_deferral_success
    result = await wise_bus.send_deferral(
ciris_engine/logic/buses/wise_bus.py:40: in send_deferral
    service = await self.get_service(
ciris_engine/logic/buses/base_bus.py:128: in get_service
    service = await self.service_registry.get_service(
E   TypeError: object MockWiseAuthorityService can't be used in 'await' expression
------------------------------------------------------------------------- Captured log setup --------------------------------------------------------------------------
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 WiseBus initialized for wise_authority
___________________________________________________ TestWiseBusDeferrals.test_send_deferral_with_string_defer_until ___________________________________________________
tests/test_wise_bus_deferrals.py:130: in test_send_deferral_with_string_defer_until
    result = await wise_bus.send_deferral(
ciris_engine/logic/buses/wise_bus.py:40: in send_deferral
    service = await self.get_service(
ciris_engine/logic/buses/base_bus.py:128: in get_service
    service = await self.service_registry.get_service(
E   TypeError: object MockWiseAuthorityService can't be used in 'await' expression
------------------------------------------------------------------------- Captured log setup --------------------------------------------------------------------------
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 WiseBus initialized for wise_authority
_______________________________________________________ TestWiseBusDeferrals.test_send_deferral_no_defer_until ________________________________________________________
tests/test_wise_bus_deferrals.py:165: in test_send_deferral_no_defer_until
    result = await wise_bus.send_deferral(
ciris_engine/logic/buses/wise_bus.py:40: in send_deferral
    service = await self.get_service(
ciris_engine/logic/buses/base_bus.py:128: in get_service
    service = await self.service_registry.get_service(
E   TypeError: object MockWiseAuthorityService can't be used in 'await' expression
------------------------------------------------------------------------- Captured log setup --------------------------------------------------------------------------
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 WiseBus initialized for wise_authority
____________________________________________________ TestWiseBusDeferrals.test_send_deferral_service_not_available ____________________________________________________
tests/test_wise_bus_deferrals.py:201: in test_send_deferral_service_not_available
    result = await wise_bus.send_deferral(
ciris_engine/logic/buses/wise_bus.py:40: in send_deferral
    service = await self.get_service(
ciris_engine/logic/buses/base_bus.py:128: in get_service
    service = await self.service_registry.get_service(
E   TypeError: object NoneType can't be used in 'await' expression
------------------------------------------------------------------------- Captured log setup --------------------------------------------------------------------------
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 WiseBus initialized for wise_authority
______________________________________________________ TestWiseBusDeferrals.test_send_deferral_service_exception ______________________________________________________
tests/test_wise_bus_deferrals.py:229: in test_send_deferral_service_exception
    result = await wise_bus.send_deferral(
ciris_engine/logic/buses/wise_bus.py:40: in send_deferral
    service = await self.get_service(
ciris_engine/logic/buses/base_bus.py:128: in get_service
    service = await self.service_registry.get_service(
E   TypeError: object MockWiseAuthorityService can't be used in 'await' expression
------------------------------------------------------------------------- Captured log setup --------------------------------------------------------------------------
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 WiseBus initialized for wise_authority
__________________________________________________________ TestWiseBusDeferrals.test_fetch_guidance_success ___________________________________________________________
tests/test_wise_bus_deferrals.py:261: in test_fetch_guidance_success
    result = await wise_bus.fetch_guidance(
ciris_engine/logic/buses/wise_bus.py:91: in fetch_guidance
    service = await self.get_service(
ciris_engine/logic/buses/base_bus.py:128: in get_service
    service = await self.service_registry.get_service(
E   TypeError: object MockWiseAuthorityService can't be used in 'await' expression
------------------------------------------------------------------------- Captured log setup --------------------------------------------------------------------------
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 WiseBus initialized for wise_authority
_________________________________________________________ TestWiseBusDeferrals.test_fetch_guidance_no_service _________________________________________________________
tests/test_wise_bus_deferrals.py:289: in test_fetch_guidance_no_service
    result = await wise_bus.fetch_guidance(
ciris_engine/logic/buses/wise_bus.py:91: in fetch_guidance
    service = await self.get_service(
ciris_engine/logic/buses/base_bus.py:128: in get_service
    service = await self.service_registry.get_service(
E   TypeError: object NoneType can't be used in 'await' expression
------------------------------------------------------------------------- Captured log setup --------------------------------------------------------------------------
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 WiseBus initialized for wise_authority
______________________________________________________________ TestWiseBusDeferrals.test_request_review _______________________________________________________________
tests/test_wise_bus_deferrals.py:313: in test_request_review
    result = await wise_bus.request_review(
ciris_engine/logic/buses/wise_bus.py:124: in request_review
    return await self.send_deferral(context, handler_name)
ciris_engine/logic/buses/wise_bus.py:40: in send_deferral
    service = await self.get_service(
ciris_engine/logic/buses/base_bus.py:128: in get_service
    service = await self.service_registry.get_service(
E   TypeError: object MockWiseAuthorityService can't be used in 'await' expression
------------------------------------------------------------------------- Captured log setup --------------------------------------------------------------------------
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 WiseBus initialized for wise_authority
_________________________________________________________ TestWiseBusDeferrals.test_bus_capability_filtering __________________________________________________________
tests/test_wise_bus_deferrals.py:365: in test_bus_capability_filtering
    result_a = await wise_bus.get_service(
ciris_engine/logic/buses/base_bus.py:128: in get_service
    service = await self.service_registry.get_service(
/usr/lib/python3.12/unittest/mock.py:1134: in __call__
    return self._mock_call(*args, **kwargs)
/usr/lib/python3.12/unittest/mock.py:1138: in _mock_call
    return self._execute_mock_call(*args, **kwargs)
/usr/lib/python3.12/unittest/mock.py:1199: in _execute_mock_call
    result = effect(*args, **kwargs)
E   TypeError: TestWiseBusDeferrals.test_bus_capability_filtering.<locals>.get_service_by_handler() got an unexpected keyword argument 'required_capabilities'
------------------------------------------------------------------------- Captured log setup --------------------------------------------------------------------------
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 WiseBus initialized for wise_authority
_______________________________________________________ TestWiseBusDeferrals.test_concurrent_deferral_requests ________________________________________________________
tests/test_wise_bus_deferrals.py:400: in test_concurrent_deferral_requests
    results = await asyncio.gather(*[
ciris_engine/logic/buses/wise_bus.py:40: in send_deferral
    service = await self.get_service(
ciris_engine/logic/buses/base_bus.py:128: in get_service
    service = await self.service_registry.get_service(
E   TypeError: object MockWiseAuthorityService can't be used in 'await' expression
------------------------------------------------------------------------- Captured log setup --------------------------------------------------------------------------
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 WiseBus initialized for wise_authority
________________________________________________________ TestWiseBusErrorHandling.test_process_message_warning ________________________________________________________
tests/test_wise_bus_deferrals.py:468: in test_process_message_warning
    message = BusMessage(
E   TypeError: BusMessage.__init__() got an unexpected keyword argument 'payload'
------------------------------------------------------------------------- Captured log setup --------------------------------------------------------------------------
INFO     ciris_engine.logic.buses.base_bus:base_bus.py:61 WiseBus initialized for wise_authority
========================================================================== warnings summary ===========================================================================
../.local/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:293
../.local/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:293
../.local/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:293
../.local/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:293
../.local/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:293
../.local/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:293
../.local/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:293
../.local/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:293
../.local/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:293
  /home/emoore/.local/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:293: PydanticDeprecatedSince20: `json_encoders` is deprecated. See https://docs.pydantic.dev/2.11/concepts/serialization/#custom-serializers for alternatives. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
    warnings.warn(

../.local/lib/python3.12/site-packages/pydantic/_internal/_config.py:323
  /home/emoore/.local/lib/python3.12/site-packages/pydantic/_internal/_config.py:323: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
    warnings.warn(DEPRECATION_MESSAGE, DeprecationWarning)

tests/adapters/test_discord/test_discord_adapter_comprehensive.py::TestDiscordWiseAuthority::test_request_approval_with_reactions
tests/adapters/test_discord/test_discord_components.py::TestDiscordEmbedFormatter::test_create_base_embed
tests/adapters/test_discord/test_discord_components.py::TestDiscordEmbedFormatter::test_format_guidance_request
tests/adapters/test_discord/test_discord_components.py::TestDiscordEmbedFormatter::test_format_approval_request
tests/adapters/test_discord/test_discord_components.py::TestDiscordEmbedFormatter::test_format_tool_execution
tests/adapters/test_discord/test_discord_components.py::TestDiscordEmbedFormatter::test_format_tool_execution
tests/adapters/test_discord/test_discord_components.py::TestDiscordEmbedFormatter::test_format_tool_execution
tests/ciris_engine/logic/adapters/discord/test_discord_adapter_unit.py::TestDiscordAdapter::test_embed_formatter
  /home/emoore/CIRISAgent/ciris_engine/logic/adapters/discord/discord_embed_formatter.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    timestamp=datetime.utcnow()

tests/api/routes/test_filters.py::TestFilterConfig::test_update_config_add_trigger
  /home/emoore/CIRISAgent/ciris_engine/api/routes/filters.py:275: RuntimeWarning: coroutine 'AsyncMockMixin._execute_mock_call' was never awaited
    filter_service.add_filter_trigger(trigger)
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

tests/api/routes/test_filters.py::TestFilterConfig::test_update_config_remove_trigger
  /home/emoore/CIRISAgent/ciris_engine/api/routes/filters.py:285: RuntimeWarning: coroutine 'AsyncMockMixin._execute_mock_call' was never awaited
    filter_service.remove_filter_trigger(trigger_id)
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

tests/ciris_engine/logic/services/graph/test_config_node_fix.py: 9 warnings
tests/ciris_engine/logic/services/graph/test_config_service_bootstrap.py: 33 warnings
tests/test_all_startup_fixes.py: 2 warnings
  /home/emoore/CIRISAgent/ciris_engine/logic/persistence/models/graph.py:44: DeprecationWarning: The default datetime adapter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes
    conn.execute(sql, params)

tests/ciris_engine/logic/services/runtime/test_llm_service.py: 10 warnings
tests/test_all_startup_fixes.py: 1 warning
  /home/emoore/.local/lib/python3.12/site-packages/instructor/client.py:398: DeprecationWarning: FUNCTIONS is deprecated and will be removed in future versions
    instructor.Mode.FUNCTIONS,

tests/test_all_startup_fixes.py: 15 warnings
  /home/emoore/.local/lib/python3.12/site-packages/instructor/process_response.py:222: DeprecationWarning: FUNCTIONS is deprecated and will be removed in future versions
    if mode == Mode.FUNCTIONS:

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================================================================= short test summary info =======================================================================
FAILED tests/adapters/test_discord/test_discord_adapter_comprehensive.py::TestDiscordToolExecution::test_execute_tool_success - pydantic_core._pydantic_core.ValidationError: 7 validation errors for ToolExecutionResult
FAILED tests/adapters/test_discord/test_discord_adapter_unit.py::TestDiscordAdapter::test_list_tools - pydantic_core._pydantic_core.ValidationError: 6 validation errors for ToolInfo
FAILED tests/adapters/test_discord/test_discord_adapter_unit.py::TestDiscordAdapter::test_execute_tool - pydantic_core._pydantic_core.ValidationError: 7 validation errors for ToolExecutionResult
FAILED tests/adapters/test_discord_deferrals.py::TestDiscordDeferrals::test_resolve_deferral_approve - pydantic_core._pydantic_core.ValidationError: 9 validation errors for WACertificate
FAILED tests/adapters/test_discord_deferrals.py::TestDiscordDeferrals::test_resolve_deferral_reject - pydantic_core._pydantic_core.ValidationError: 9 validation errors for WACertificate
FAILED tests/adapters/test_discord_deferrals.py::TestDiscordDeferrals::test_deferral_with_context_display - AssertionError: assert 'Priority: HIGH' in '\n **Deferral Requiring Review** \n<@medical_wa_team>\n\n**Deferral ID**: `defer_context_001`\n**Priority**: HIGH\...
FAILED tests/adapters/test_discord_deferrals.py::TestDiscordDeferrals::test_deferral_resolution_with_modification - pydantic_core._pydantic_core.ValidationError: 9 validation errors for WACertificate
FAILED tests/adapters/test_discord_deferrals.py::TestDiscordDeferralIntegration::test_full_discord_deferral_flow - pydantic_core._pydantic_core.ValidationError: 9 validation errors for WACertificate
FAILED tests/adapters/test_mock_llm_comprehensive.py::TestMockLLMComprehensive::test_action_selection_result - pydantic_core._pydantic_core.ValidationError: 1 validation error for ActionSelectionDMAResult
FAILED tests/adapters/test_mock_llm_comprehensive.py::TestMockLLMComprehensive::test_all_schemas_serializable - pydantic_core._pydantic_core.ValidationError: 1 validation error for ActionSelectionDMAResult
FAILED tests/adapters/test_mock_llm_comprehensive.py::TestMockLLMComprehensive::test_mock_response_consistency - pydantic_core._pydantic_core.ValidationError: 1 validation error for ActionSelectionDMAResult
FAILED tests/adapters/test_mock_llm_service.py::test_mock_llm_structured_outputs - pydantic_core._pydantic_core.ValidationError: 1 validation error for ActionSelectionDMAResult
FAILED tests/api/routes/test_adaptation.py::TestPatternEndpoint::test_get_patterns_success - assert 500 == 200
FAILED tests/api/routes/test_adaptation.py::TestPatternEndpoint::test_get_patterns_with_filters - assert 500 == 200
FAILED tests/api/routes/test_adaptation.py::TestPatternEndpoint::test_get_patterns_service_unavailable - assert 500 == 503
FAILED tests/api/routes/test_adaptation.py::TestInsightsEndpoint::test_get_insights_success - assert 500 == 200
FAILED tests/api/routes/test_adaptation.py::TestInsightsEndpoint::test_get_insights_with_limit - assert 500 == 200
FAILED tests/api/routes/test_adaptation.py::TestHistoryEndpoint::test_get_history_success - assert 500 == 200
FAILED tests/api/routes/test_adaptation.py::TestHistoryEndpoint::test_get_history_filters_by_time - assert 500 == 200
FAILED tests/api/routes/test_adaptation.py::TestEffectivenessEndpoint::test_get_effectiveness_success - assert 500 == 200
FAILED tests/api/routes/test_adaptation.py::TestEffectivenessEndpoint::test_get_effectiveness_no_patterns - assert 500 == 200
FAILED tests/api/routes/test_adaptation.py::TestCorrelationsEndpoint::test_get_correlations_success - assert 500 == 200
FAILED tests/api/routes/test_adaptation.py::TestCorrelationsEndpoint::test_get_correlations_with_min_confidence - assert 500 == 200
FAILED tests/api/routes/test_adaptation.py::TestReportEndpoint::test_get_report_success - assert 500 == 200
FAILED tests/api/routes/test_adaptation.py::TestReportEndpoint::test_get_report_service_error - AssertionError: assert 'Service error' in 'Auth service not initialized'
FAILED tests/api/routes/test_adaptation.py::TestServiceUnavailable::test_all_endpoints_return_503 - AssertionError: Expected 503 for /v1/adaptation/patterns
FAILED tests/api/routes/test_emergency.py::TestEmergencyEndpoint::test_shutdown_with_runtime_service - AttributeError: module 'ciris_engine.logic.services' has no attribute 'registry'
FAILED tests/api/routes/test_emergency.py::TestEmergencyEndpoint::test_shutdown_without_runtime_service - AttributeError: module 'ciris_engine.logic.services' has no attribute 'registry'
FAILED tests/api/routes/test_init.py::TestInitializationStatus::test_get_status_no_service - TypeError: Object of type datetime is not JSON serializable
FAILED tests/api/routes/test_init.py::TestInitializationStatus::test_get_status_service_error - TypeError: Object of type datetime is not JSON serializable
FAILED tests/api/routes/test_resources.py::test_get_resource_limits_success - pydantic_core._pydantic_core.ValidationError: 2 validation errors for AuthContext
FAILED tests/api/routes/test_resources.py::test_get_resource_limits_no_service - pydantic_core._pydantic_core.ValidationError: 2 validation errors for AuthContext
FAILED tests/api/routes/test_resources.py::test_get_resource_usage_success - pydantic_core._pydantic_core.ValidationError: 2 validation errors for AuthContext
FAILED tests/api/routes/test_resources.py::test_get_resource_usage_no_service - pydantic_core._pydantic_core.ValidationError: 2 validation errors for AuthContext
FAILED tests/api/routes/test_resources.py::test_get_resource_alerts_success - pydantic_core._pydantic_core.ValidationError: 2 validation errors for AuthContext
FAILED tests/api/routes/test_resources.py::test_get_resource_alerts_with_critical - pydantic_core._pydantic_core.ValidationError: 2 validation errors for AuthContext
FAILED tests/api/routes/test_resources.py::test_get_resource_alerts_with_hours_param - pydantic_core._pydantic_core.ValidationError: 2 validation errors for AuthContext
FAILED tests/api/routes/test_resources.py::test_get_resource_predictions_success - pydantic_core._pydantic_core.ValidationError: 2 validation errors for AuthContext
FAILED tests/api/routes/test_resources.py::test_get_resource_predictions_includes_all_resources - pydantic_core._pydantic_core.ValidationError: 2 validation errors for AuthContext
FAILED tests/api/routes/test_resources.py::test_configure_alerts_success - pydantic_core._pydantic_core.ValidationError: 4 validation errors for AuthContext
FAILED tests/api/routes/test_resources.py::test_configure_alerts_invalid_resource - pydantic_core._pydantic_core.ValidationError: 4 validation errors for AuthContext
FAILED tests/api/routes/test_resources.py::test_configure_alerts_invalid_thresholds - pydantic_core._pydantic_core.ValidationError: 4 validation errors for AuthContext
FAILED tests/api/routes/test_resources.py::test_configure_alerts_critical_less_than_warning - pydantic_core._pydantic_core.ValidationError: 4 validation errors for AuthContext
FAILED tests/api/routes/test_resources.py::test_configure_alerts_partial_update - pydantic_core._pydantic_core.ValidationError: 4 validation errors for AuthContext
FAILED tests/api/routes/test_resources.py::test_configure_alerts_no_changes - pydantic_core._pydantic_core.ValidationError: 4 validation errors for AuthContext
FAILED tests/api/routes/test_resources.py::test_resource_monitor_exception_handling - pydantic_core._pydantic_core.ValidationError: 2 validation errors for AuthContext
FAILED tests/api/routes/test_time.py::test_get_current_time - AssertionError: assert '2025-01-01T12:00:00Z' == '2025-01-01T12:00:00+00:00'
FAILED tests/api/routes/test_time.py::test_get_uptime - AssertionError: assert '2025-01-01T00:00:00Z' == '2025-01-01T00:00:00+00:00'
FAILED tests/api/routes/test_time.py::test_get_time_sync_status - AssertionError: assert '2025-01-01T00:00:00Z' == '2025-01-01T00:00:00+00:00'
FAILED tests/api/routes/test_time.py::test_time_service_error_handling - assert 200 == 500
FAILED tests/ciris_engine/logic/processors/states/test_dream_processor.py::TestDreamProcessor::test_process_entering_phase - assert 1 == 0
FAILED tests/ciris_engine/logic/processors/states/test_dream_processor.py::TestDreamProcessor::test_process_consolidating_phase - AttributeError: <DreamProcessor> does not have the attribute '_consolidate_recent_memories'
FAILED tests/ciris_engine/logic/processors/states/test_dream_processor.py::TestDreamProcessor::test_process_analyzing_phase - assert 1 == 0
FAILED tests/ciris_engine/logic/processors/states/test_dream_processor.py::TestDreamProcessor::test_process_configuring_phase - assert 1 == 0
FAILED tests/ciris_engine/logic/processors/states/test_dream_processor.py::TestDreamProcessor::test_process_planning_phase - AttributeError: <DreamProcessor> does not have the attribute '_get_active_tasks'
FAILED tests/ciris_engine/logic/processors/states/test_dream_processor.py::TestDreamProcessor::test_process_exiting_phase - assert 1 == 0
FAILED tests/ciris_engine/logic/processors/states/test_dream_processor.py::TestDreamProcessor::test_cleanup - AssertionError: assert DreamSession(session_id='dream_1704110400', scheduled_start=None, actual_start=datetime.datetime(2024, 1, 1, 12, 0, tzinfo=datetime.timezon...
FAILED tests/ciris_engine/logic/processors/states/test_dream_processor.py::TestDreamProcessor::test_consolidate_recent_memories - AttributeError: type object 'NodeType' has no attribute 'OBSERVATION'
FAILED tests/ciris_engine/logic/processors/states/test_dream_processor.py::TestDreamProcessor::test_apply_self_configuration - AttributeError: 'DreamProcessor' object has no attribute '_apply_self_configuration'
FAILED tests/ciris_engine/logic/processors/states/test_dream_processor.py::TestDreamProcessor::test_create_system_snapshot - AttributeError: <DreamProcessor> does not have the attribute '_get_active_tasks'
FAILED tests/ciris_engine/logic/processors/states/test_dream_processor.py::TestDreamProcessor::test_minimum_dream_duration - AttributeError: 'DreamResult' object has no attribute 'should_transition'
FAILED tests/ciris_engine/logic/processors/states/test_dream_processor.py::TestDreamProcessor::test_maximum_dream_duration - AssertionError: assert <DreamPhase.C...onsolidating'> == <DreamPhase.E...NG: 'exiting'>
FAILED tests/ciris_engine/logic/processors/states/test_dream_processor.py::TestDreamProcessor::test_error_handling_in_phase - AttributeError: <DreamProcessor> does not have the attribute '_consolidate_recent_memories'
FAILED tests/ciris_engine/logic/processors/states/test_dream_processor.py::TestDreamProcessor::test_benchmarking_mode - AttributeError: <DreamProcessor> does not have the attribute '_cirisnode_available'
FAILED tests/ciris_engine/logic/runtime/test_ciris_runtime.py::TestCIRISRuntime::test_initialize - AttributeError: <ciris_engine.logic.runtime.ciris_runtime.CIRISRuntime object at 0x750cb952fef0> does not have the attribute '_initialize_core_services'
FAILED tests/ciris_engine/logic/runtime/test_ciris_runtime.py::TestCIRISRuntime::test_initialize_already_initialized - Failed: DID NOT RAISE <class 'RuntimeError'>
FAILED tests/ciris_engine/logic/runtime/test_ciris_runtime.py::TestCIRISRuntime::test_start - AttributeError: 'CIRISRuntime' object has no attribute 'start'
FAILED tests/ciris_engine/logic/runtime/test_ciris_runtime.py::TestCIRISRuntime::test_start_not_initialized - AttributeError: 'CIRISRuntime' object has no attribute 'start'
FAILED tests/ciris_engine/logic/runtime/test_ciris_runtime.py::TestCIRISRuntime::test_initialize_core_services - AttributeError: 'CIRISRuntime' object has no attribute '_initialize_core_services'. Did you mean: '_initialize_memory_service'?
FAILED tests/ciris_engine/logic/runtime/test_ciris_runtime.py::TestCIRISRuntime::test_initialize_buses - AttributeError: <module 'ciris_engine.logic.runtime.ciris_runtime' from '/home/emoore/CIRISAgent/ciris_engine/logic/runtime/ciris_runtime.py'> does not have the a...
FAILED tests/ciris_engine/logic/runtime/test_ciris_runtime.py::TestCIRISRuntime::test_initialize_processors - AttributeError: property 'bus_manager' of 'CIRISRuntime' object has no setter
FAILED tests/ciris_engine/logic/runtime/test_ciris_runtime.py::TestCIRISRuntime::test_initialize_adapters - AttributeError: property 'bus_manager' of 'CIRISRuntime' object has no setter
FAILED tests/ciris_engine/logic/runtime/test_ciris_runtime.py::TestCIRISRuntime::test_run_with_timeout - AttributeError: property 'bus_manager' of 'CIRISRuntime' object has no setter
FAILED tests/ciris_engine/logic/runtime/test_ciris_runtime.py::TestCIRISRuntime::test_run_with_error - AttributeError: property 'bus_manager' of 'CIRISRuntime' object has no setter
FAILED tests/ciris_engine/logic/runtime/test_ciris_runtime.py::TestCIRISRuntime::test_get_status - AttributeError: 'CIRISRuntime' object has no attribute 'get_status'
FAILED tests/ciris_engine/logic/runtime/test_ciris_runtime.py::TestCIRISRuntime::test_get_services - AttributeError: 'CIRISRuntime' object has no attribute 'get_services'. Did you mean: 'audit_services'?
FAILED tests/ciris_engine/logic/runtime/test_ciris_runtime.py::TestCIRISRuntime::test_get_services_not_initialized - AttributeError: 'CIRISRuntime' object has no attribute 'get_services'. Did you mean: 'audit_services'?
FAILED tests/ciris_engine/logic/runtime/test_ciris_runtime.py::TestCIRISRuntime::test_handle_shutdown_signal - AttributeError: 'CIRISRuntime' object has no attribute '_handle_shutdown_signal'
FAILED tests/ciris_engine/logic/runtime/test_ciris_runtime.py::TestCIRISRuntime::test_validate_configuration - AttributeError: 'CIRISRuntime' object has no attribute '_validate_configuration'
FAILED tests/ciris_engine/logic/runtime/test_ciris_runtime.py::TestCIRISRuntime::test_multiple_adapters - AttributeError: <module 'ciris_engine.logic.runtime.ciris_runtime' from '/home/emoore/CIRISAgent/ciris_engine/logic/runtime/ciris_runtime.py'> does not have the a...
FAILED tests/ciris_engine/logic/runtime/test_ciris_runtime.py::TestCIRISRuntime::test_mock_llm_configuration - AttributeError: 'CIRISRuntime' object has no attribute '_mock_llm'
FAILED tests/ciris_engine/logic/services/graph/test_audit_service_unit.py::TestGraphAuditService::test_start_stop - AttributeError: 'GraphAuditService' object has no attribute '_running'
FAILED tests/ciris_engine/logic/services/graph/test_audit_service_unit.py::TestGraphAuditService::test_audit_event - AttributeError: 'GraphAuditService' object has no attribute 'audit_event'
FAILED tests/ciris_engine/logic/services/graph/test_audit_service_unit.py::TestGraphAuditService::test_audit_authentication - AttributeError: 'GraphAuditService' object has no attribute 'audit_authentication'
FAILED tests/ciris_engine/logic/services/graph/test_audit_service_unit.py::TestGraphAuditService::test_audit_authentication_failure - AttributeError: 'GraphAuditService' object has no attribute 'audit_authentication'
FAILED tests/ciris_engine/logic/services/graph/test_audit_service_unit.py::TestGraphAuditService::test_audit_configuration_change - AttributeError: 'GraphAuditService' object has no attribute 'audit_configuration_change'
FAILED tests/ciris_engine/logic/services/graph/test_audit_service_unit.py::TestGraphAuditService::test_audit_data_access - AttributeError: 'GraphAuditService' object has no attribute 'audit_data_access'
FAILED tests/ciris_engine/logic/services/graph/test_audit_service_unit.py::TestGraphAuditService::test_audit_error - AttributeError: 'GraphAuditService' object has no attribute 'audit_error'
FAILED tests/ciris_engine/logic/services/graph/test_audit_service_unit.py::TestGraphAuditService::test_query_audit_log - AttributeError: type object 'NodeType' has no attribute 'AUDIT'
FAILED tests/ciris_engine/logic/services/graph/test_audit_service_unit.py::TestGraphAuditService::test_query_audit_log_with_filters - AttributeError: 'GraphAuditService' object has no attribute 'query_audit_log'. Did you mean: 'query_audit_trail'?
FAILED tests/ciris_engine/logic/services/graph/test_audit_service_unit.py::TestGraphAuditService::test_cleanup_old_entries - AttributeError: type object 'NodeType' has no attribute 'AUDIT'
FAILED tests/ciris_engine/logic/services/graph/test_audit_service_unit.py::TestGraphAuditService::test_get_audit_statistics - AttributeError: type object 'NodeType' has no attribute 'AUDIT'
FAILED tests/ciris_engine/logic/services/graph/test_audit_service_unit.py::TestGraphAuditService::test_get_capabilities - AssertionError: assert 'audit_event' in ['log_action', 'log_event', 'log_conscience_event', 'get_audit_trail', 'query_audit_trail', 'verify_audit_integrity', ...]
FAILED tests/ciris_engine/logic/services/graph/test_audit_service_unit.py::TestGraphAuditService::test_get_status - KeyError: 'total_events'
FAILED tests/ciris_engine/logic/services/graph/test_audit_service_unit.py::TestGraphAuditService::test_concurrent_audit_events - AttributeError: 'GraphAuditService' object has no attribute 'audit_event'
FAILED tests/ciris_engine/logic/services/graph/test_audit_service_unit.py::TestGraphAuditService::test_audit_with_large_details - AttributeError: 'GraphAuditService' object has no attribute 'audit_event'
FAILED tests/ciris_engine/logic/services/graph/test_audit_service_unit.py::TestGraphAuditService::test_node_type - AttributeError: type object 'NodeType' has no attribute 'AUDIT'
FAILED tests/ciris_engine/logic/services/runtime/test_llm_service.py::test_llm_service_call_structured - pydantic_core._pydantic_core.ValidationError: 1 validation error for ActionSelectionDMAResult
FAILED tests/test_memory_handlers.py::test_memorize_handler_with_graph_node - pydantic_core._pydantic_core.ValidationError: 1 validation error for ActionSelectionDMAResult
FAILED tests/test_memory_handlers.py::test_recall_handler_with_query - pydantic_core._pydantic_core.ValidationError: 1 validation error for ActionSelectionDMAResult
FAILED tests/test_memory_handlers.py::test_memorize_handler_error_handling - pydantic_core._pydantic_core.ValidationError: 1 validation error for ActionSelectionDMAResult
FAILED tests/test_memory_handlers_comprehensive.py::TestRecallHandler::test_recall_by_node_id_success - assert "{'content': 'Recalled content', 'data': 'test'}" in "CIRIS_FOLLOW_UP_THOUGHT: Memory query 'recalled_node' returned: {'recalled_node': {'content': 'Recall...
FAILED tests/test_memory_handlers_comprehensive.py::TestRecallHandler::test_recall_by_query_success - assert 'CONCEPT test search query' in "CIRIS_FOLLOW_UP_THOUGHT: Memory query 'concept test search query' returned: {'node1': {'content': 'First match', 'created_a...
FAILED tests/test_memory_handlers_comprehensive.py::TestRecallHandler::test_recall_invalid_parameters - pydantic_core._pydantic_core.ValidationError: 27 validation errors for ActionSelectionDMAResult
FAILED tests/test_memory_handlers_comprehensive.py::TestRecallHandler::test_recall_with_all_parameters - AttributeError: type object 'NodeType' has no attribute 'TASK'
FAILED tests/test_memory_handlers_comprehensive.py::TestForgetHandler::test_forget_success - pydantic_core._pydantic_core.ValidationError: 14 validation errors for ThoughtContext
FAILED tests/test_memory_handlers_comprehensive.py::TestForgetHandler::test_forget_identity_scope_without_wa - pydantic_core._pydantic_core.ValidationError: 12 validation errors for ThoughtContext
FAILED tests/test_memory_handlers_comprehensive.py::TestForgetHandler::test_forget_environment_scope_with_wa - pydantic_core._pydantic_core.ValidationError: 14 validation errors for ThoughtContext
FAILED tests/test_memory_handlers_comprehensive.py::TestForgetHandler::test_forget_with_no_audit_flag - pydantic_core._pydantic_core.ValidationError: 14 validation errors for ThoughtContext
FAILED tests/test_memory_handlers_comprehensive.py::TestForgetHandler::test_forget_invalid_params_dict - pydantic_core._pydantic_core.ValidationError: 21 validation errors for ActionSelectionDMAResult
FAILED tests/test_memory_handlers_comprehensive.py::TestForgetHandler::test_forget_invalid_params_type - pydantic_core._pydantic_core.ValidationError: 12 validation errors for ThoughtContext
FAILED tests/test_memory_handlers_comprehensive.py::TestForgetHandler::test_forget_permission_denied - pydantic_core._pydantic_core.ValidationError: 12 validation errors for ThoughtContext
FAILED tests/test_memory_handlers_comprehensive.py::TestForgetHandler::test_forget_failed_operation - pydantic_core._pydantic_core.ValidationError: 14 validation errors for ThoughtContext
FAILED tests/test_wise_bus_deferrals.py::TestWiseBusDeferrals::test_send_deferral_success - TypeError: object MockWiseAuthorityService can't be used in 'await' expression
FAILED tests/test_wise_bus_deferrals.py::TestWiseBusDeferrals::test_send_deferral_with_string_defer_until - TypeError: object MockWiseAuthorityService can't be used in 'await' expression
FAILED tests/test_wise_bus_deferrals.py::TestWiseBusDeferrals::test_send_deferral_no_defer_until - TypeError: object MockWiseAuthorityService can't be used in 'await' expression
FAILED tests/test_wise_bus_deferrals.py::TestWiseBusDeferrals::test_send_deferral_service_not_available - TypeError: object NoneType can't be used in 'await' expression
FAILED tests/test_wise_bus_deferrals.py::TestWiseBusDeferrals::test_send_deferral_service_exception - TypeError: object MockWiseAuthorityService can't be used in 'await' expression
FAILED tests/test_wise_bus_deferrals.py::TestWiseBusDeferrals::test_fetch_guidance_success - TypeError: object MockWiseAuthorityService can't be used in 'await' expression
FAILED tests/test_wise_bus_deferrals.py::TestWiseBusDeferrals::test_fetch_guidance_no_service - TypeError: object NoneType can't be used in 'await' expression
FAILED tests/test_wise_bus_deferrals.py::TestWiseBusDeferrals::test_request_review - TypeError: object MockWiseAuthorityService can't be used in 'await' expression
FAILED tests/test_wise_bus_deferrals.py::TestWiseBusDeferrals::test_bus_capability_filtering - TypeError: TestWiseBusDeferrals.test_bus_capability_filtering.<locals>.get_service_by_handler() got an unexpected keyword argument 'required_capabilities'
FAILED tests/test_wise_bus_deferrals.py::TestWiseBusDeferrals::test_concurrent_deferral_requests - TypeError: object MockWiseAuthorityService can't be used in 'await' expression
FAILED tests/test_wise_bus_deferrals.py::TestWiseBusErrorHandling::test_process_message_warning - TypeError: BusMessage.__init__() got an unexpected keyword argument 'payload'
ERROR tests/api/routes/test_emergency.py::TestAsyncEmergencyEndpoint::test_async_shutdown_success - TypeError: AsyncClient.__init__() got an unexpected keyword argument 'app'
ERROR tests/api/routes/test_incidents.py::TestIncidentEndpoints::test_get_recent_incidents
ERROR tests/api/routes/test_incidents.py::TestIncidentEndpoints::test_get_incident_details
ERROR tests/api/routes/test_incidents.py::TestIncidentEndpoints::test_get_incident_not_found
ERROR tests/api/routes/test_incidents.py::TestIncidentEndpoints::test_get_incident_patterns
ERROR tests/api/routes/test_incidents.py::TestIncidentEndpoints::test_get_current_problems
ERROR tests/api/routes/test_incidents.py::TestIncidentEndpoints::test_get_incident_insights
ERROR tests/api/routes/test_incidents.py::TestIncidentEndpoints::test_analyze_incidents_requires_admin
ERROR tests/api/routes/test_incidents.py::TestIncidentEndpoints::test_analyze_incidents_success
ERROR tests/api/routes/test_incidents.py::TestIncidentEndpoints::test_get_recommendations
ERROR tests/api/routes/test_incidents.py::TestIncidentEndpoints::test_service_unavailable
ERROR tests/api/routes/test_incidents.py::TestIncidentEndpoints::test_memory_service_unavailable
ERROR tests/api/routes/test_incidents.py::TestIncidentEndpoints::test_query_parameters_validation
ERROR tests/api/routes/test_incidents.py::TestIncidentEndpoints::test_filter_parameters
ERROR tests/api/routes/test_scheduler.py::TestSchedulerEndpoints::test_list_scheduled_tasks_success
ERROR tests/api/routes/test_scheduler.py::TestSchedulerEndpoints::test_list_scheduled_tasks_with_filter
ERROR tests/api/routes/test_scheduler.py::TestSchedulerEndpoints::test_list_scheduled_tasks_pagination
ERROR tests/api/routes/test_scheduler.py::TestSchedulerEndpoints::test_list_scheduled_tasks_no_service
ERROR tests/api/routes/test_scheduler.py::TestSchedulerEndpoints::test_get_task_details_success
ERROR tests/api/routes/test_scheduler.py::TestSchedulerEndpoints::test_get_task_details_not_found
ERROR tests/api/routes/test_scheduler.py::TestSchedulerEndpoints::test_create_scheduled_task_success
ERROR tests/api/routes/test_scheduler.py::TestSchedulerEndpoints::test_create_scheduled_task_cron
ERROR tests/api/routes/test_scheduler.py::TestSchedulerEndpoints::test_create_scheduled_task_missing_schedule
ERROR tests/api/routes/test_scheduler.py::TestSchedulerEndpoints::test_create_scheduled_task_invalid_cron
ERROR tests/api/routes/test_scheduler.py::TestSchedulerEndpoints::test_cancel_scheduled_task_success
ERROR tests/api/routes/test_scheduler.py::TestSchedulerEndpoints::test_cancel_scheduled_task_not_found
ERROR tests/api/routes/test_scheduler.py::TestSchedulerEndpoints::test_get_execution_history_success
ERROR tests/api/routes/test_scheduler.py::TestSchedulerEndpoints::test_get_execution_history_filtered
ERROR tests/api/routes/test_scheduler.py::TestSchedulerEndpoints::test_get_upcoming_executions_success
ERROR tests/api/routes/test_scheduler.py::TestSchedulerEndpoints::test_admin_only_endpoints
ERROR tests/api/routes/test_wa.py::TestGetDeferrals::test_get_deferrals_success - AttributeError: type object 'Permission' has no attribute 'VIEW_LOGS'. Did you mean: 'VIEW_TOOLS'?
ERROR tests/api/routes/test_wa.py::TestGetDeferrals::test_get_deferrals_filtered - AttributeError: type object 'Permission' has no attribute 'VIEW_LOGS'. Did you mean: 'VIEW_TOOLS'?
ERROR tests/api/routes/test_wa.py::TestGetDeferralDetail::test_get_deferral_detail_success - AttributeError: type object 'Permission' has no attribute 'VIEW_LOGS'. Did you mean: 'VIEW_TOOLS'?
ERROR tests/api/routes/test_wa.py::TestGetDeferralDetail::test_get_deferral_detail_not_found - AttributeError: type object 'Permission' has no attribute 'VIEW_LOGS'. Did you mean: 'VIEW_TOOLS'?
ERROR tests/api/routes/test_wa.py::TestResolveDeferral::test_resolve_deferral_approve - AttributeError: type object 'Permission' has no attribute 'VIEW_LOGS'. Did you mean: 'VIEW_TOOLS'?
ERROR tests/api/routes/test_wa.py::TestResolveDeferral::test_resolve_deferral_reject - AttributeError: type object 'Permission' has no attribute 'VIEW_LOGS'. Did you mean: 'VIEW_TOOLS'?
ERROR tests/api/routes/test_wa.py::TestResolveDeferral::test_resolve_deferral_insufficient_permissions - AttributeError: type object 'Permission' has no attribute 'VIEW_LOGS'. Did you mean: 'VIEW_TOOLS'?
ERROR tests/api/routes/test_wa.py::TestRequestGuidance::test_request_guidance_success - AttributeError: type object 'Permission' has no attribute 'VIEW_LOGS'. Did you mean: 'VIEW_TOOLS'?
ERROR tests/api/routes/test_wa.py::TestPermissions::test_get_permissions - AttributeError: type object 'Permission' has no attribute 'VIEW_LOGS'. Did you mean: 'VIEW_TOOLS'?
ERROR tests/api/routes/test_wa.py::TestPermissions::test_grant_permission - AttributeError: type object 'Permission' has no attribute 'VIEW_LOGS'. Did you mean: 'VIEW_TOOLS'?
ERROR tests/api/routes/test_wa.py::TestPermissions::test_revoke_permission - AttributeError: type object 'Permission' has no attribute 'VIEW_LOGS'. Did you mean: 'VIEW_TOOLS'?
ERROR tests/ciris_engine/logic/processors/core/test_main_processor.py::TestAgentProcessor::test_initialize - ValueError: resource_monitor is required for processors
ERROR tests/ciris_engine/logic/processors/core/test_main_processor.py::TestAgentProcessor::test_start_processing - ValueError: resource_monitor is required for processors
ERROR tests/ciris_engine/logic/processors/core/test_main_processor.py::TestAgentProcessor::test_process_single_round - ValueError: resource_monitor is required for processors
ERROR tests/ciris_engine/logic/processors/core/test_main_processor.py::TestAgentProcessor::test_state_transition - ValueError: resource_monitor is required for processors
ERROR tests/ciris_engine/logic/processors/core/test_main_processor.py::TestAgentProcessor::test_handle_processor_error - ValueError: resource_monitor is required for processors
ERROR tests/ciris_engine/logic/processors/core/test_main_processor.py::TestAgentProcessor::test_max_consecutive_errors - ValueError: resource_monitor is required for processors
ERROR tests/ciris_engine/logic/processors/core/test_main_processor.py::TestAgentProcessor::test_round_timeout - ValueError: resource_monitor is required for processors
ERROR tests/ciris_engine/logic/processors/core/test_main_processor.py::TestAgentProcessor::test_stop_processing - ValueError: resource_monitor is required for processors
ERROR tests/ciris_engine/logic/processors/core/test_main_processor.py::TestAgentProcessor::test_emergency_stop - ValueError: resource_monitor is required for processors
ERROR tests/ciris_engine/logic/processors/core/test_main_processor.py::TestAgentProcessor::test_get_current_state - ValueError: resource_monitor is required for processors
ERROR tests/ciris_engine/logic/processors/core/test_main_processor.py::TestAgentProcessor::test_get_state_history - ValueError: resource_monitor is required for processors
ERROR tests/ciris_engine/logic/processors/core/test_main_processor.py::TestAgentProcessor::test_get_processor_metrics - ValueError: resource_monitor is required for processors
ERROR tests/ciris_engine/logic/processors/core/test_main_processor.py::TestAgentProcessor::test_validate_transition - ValueError: resource_monitor is required for processors
ERROR tests/ciris_engine/logic/processors/core/test_main_processor.py::TestAgentProcessor::test_transition_to_same_state - ValueError: resource_monitor is required for processors
ERROR tests/ciris_engine/logic/processors/core/test_main_processor.py::TestAgentProcessor::test_processor_not_found - ValueError: resource_monitor is required for processors
ERROR tests/ciris_engine/logic/processors/core/test_main_processor.py::TestAgentProcessor::test_state_transition_delay - ValueError: resource_monitor is required for processors
ERROR tests/ciris_engine/logic/processors/core/test_main_processor.py::TestAgentProcessor::test_cleanup - ValueError: resource_monitor is required for processors
ERROR tests/ciris_engine/logic/processors/core/test_main_processor.py::TestAgentProcessor::test_max_rounds_limit - ValueError: resource_monitor is required for processors
ERROR tests/ciris_engine/logic/processors/core/test_main_processor.py::TestAgentProcessor::test_record_state_transition - ValueError: resource_monitor is required for processors
ERROR tests/ciris_engine/logic/processors/core/test_main_processor.py::TestAgentProcessor::test_processor_initialization_failure - ValueError: resource_monitor is required for processors
ERROR tests/ciris_engine/logic/processors/core/test_thought_processor.py::TestThoughtProcessor::test_get_processing_queue - pydantic_core._pydantic_core.ValidationError: 18 validation errors for ActionSelectionDMAResult
ERROR tests/ciris_engine/logic/processors/core/test_thought_processor.py::TestThoughtProcessor::test_create_thought_from_task - pydantic_core._pydantic_core.ValidationError: 18 validation errors for ActionSelectionDMAResult
ERROR tests/ciris_engine/logic/processors/core/test_thought_processor.py::TestThoughtProcessor::test_create_follow_up_thought - pydantic_core._pydantic_core.ValidationError: 18 validation errors for ActionSelectionDMAResult
ERROR tests/ciris_engine/logic/processors/core/test_thought_processor.py::TestThoughtProcessor::test_process_single_thought - pydantic_core._pydantic_core.ValidationError: 18 validation errors for ActionSelectionDMAResult
ERROR tests/ciris_engine/logic/processors/core/test_thought_processor.py::TestThoughtProcessor::test_process_thought_with_error - pydantic_core._pydantic_core.ValidationError: 18 validation errors for ActionSelectionDMAResult
ERROR tests/ciris_engine/logic/processors/core/test_thought_processor.py::TestThoughtProcessor::test_max_thought_depth_limit - pydantic_core._pydantic_core.ValidationError: 18 validation errors for ActionSelectionDMAResult
ERROR tests/ciris_engine/logic/processors/core/test_thought_processor.py::TestThoughtProcessor::test_process_multiple_thoughts - pydantic_core._pydantic_core.ValidationError: 18 validation errors for ActionSelectionDMAResult
ERROR tests/ciris_engine/logic/processors/core/test_thought_processor.py::TestThoughtProcessor::test_handle_terminal_action - pydantic_core._pydantic_core.ValidationError: 18 validation errors for ActionSelectionDMAResult
ERROR tests/ciris_engine/logic/processors/core/test_thought_processor.py::TestThoughtProcessor::test_action_dispatch_failure - pydantic_core._pydantic_core.ValidationError: 18 validation errors for ActionSelectionDMAResult
ERROR tests/ciris_engine/logic/processors/core/test_thought_processor.py::TestThoughtProcessor::test_get_queue_stats - pydantic_core._pydantic_core.ValidationError: 18 validation errors for ActionSelectionDMAResult
ERROR tests/ciris_engine/logic/processors/core/test_thought_processor.py::TestThoughtProcessor::test_priority_processing_order - pydantic_core._pydantic_core.ValidationError: 18 validation errors for ActionSelectionDMAResult
ERROR tests/ciris_engine/logic/runtime/test_service_initializer.py::TestServiceInitializer::test_initialize_all - TypeError: ServiceInitializer.__init__() got an unexpected keyword argument 'db_path'
ERROR tests/ciris_engine/logic/runtime/test_service_initializer.py::TestServiceInitializer::test_initialize_infrastructure - TypeError: ServiceInitializer.__init__() got an unexpected keyword argument 'db_path'
ERROR tests/ciris_engine/logic/runtime/test_service_initializer.py::TestServiceInitializer::test_initialize_database - TypeError: ServiceInitializer.__init__() got an unexpected keyword argument 'db_path'
ERROR tests/ciris_engine/logic/runtime/test_service_initializer.py::TestServiceInitializer::test_initialize_memory - TypeError: ServiceInitializer.__init__() got an unexpected keyword argument 'db_path'
ERROR tests/ciris_engine/logic/runtime/test_service_initializer.py::TestServiceInitializer::test_initialize_identity - TypeError: ServiceInitializer.__init__() got an unexpected keyword argument 'db_path'
ERROR tests/ciris_engine/logic/runtime/test_service_initializer.py::TestServiceInitializer::test_initialize_security - TypeError: ServiceInitializer.__init__() got an unexpected keyword argument 'db_path'
ERROR tests/ciris_engine/logic/runtime/test_service_initializer.py::TestServiceInitializer::test_initialize_services - TypeError: ServiceInitializer.__init__() got an unexpected keyword argument 'db_path'
ERROR tests/ciris_engine/logic/runtime/test_service_initializer.py::TestServiceInitializer::test_initialize_llm_service_mock - TypeError: ServiceInitializer.__init__() got an unexpected keyword argument 'db_path'
ERROR tests/ciris_engine/logic/runtime/test_service_initializer.py::TestServiceInitializer::test_initialize_llm_service_real - TypeError: ServiceInitializer.__init__() got an unexpected keyword argument 'db_path'
ERROR tests/ciris_engine/logic/runtime/test_service_initializer.py::TestServiceInitializer::test_shutdown_all - TypeError: ServiceInitializer.__init__() got an unexpected keyword argument 'db_path'
ERROR tests/ciris_engine/logic/runtime/test_service_initializer.py::TestServiceInitializer::test_shutdown_with_error - TypeError: ServiceInitializer.__init__() got an unexpected keyword argument 'db_path'
ERROR tests/ciris_engine/logic/runtime/test_service_initializer.py::TestServiceInitializer::test_get_all_services - TypeError: ServiceInitializer.__init__() got an unexpected keyword argument 'db_path'
ERROR tests/ciris_engine/logic/runtime/test_service_initializer.py::TestServiceInitializer::test_verify_initialization - TypeError: ServiceInitializer.__init__() got an unexpected keyword argument 'db_path'
ERROR tests/ciris_engine/logic/runtime/test_service_initializer.py::TestServiceInitializer::test_verify_initialization_missing_service - TypeError: ServiceInitializer.__init__() got an unexpected keyword argument 'db_path'
ERROR tests/ciris_engine/logic/runtime/test_service_initializer.py::TestServiceInitializer::test_service_count - TypeError: ServiceInitializer.__init__() got an unexpected keyword argument 'db_path'
ERROR tests/ciris_engine/logic/runtime/test_service_initializer.py::TestServiceInitializer::test_initialization_order_dependencies - TypeError: ServiceInitializer.__init__() got an unexpected keyword argument 'db_path'
ERROR tests/ciris_engine/logic/services/graph/test_config_service.py::test_config_service_lifecycle - ModuleNotFoundError: No module named 'ciris_engine.logic.services.runtime.secrets_service'
ERROR tests/ciris_engine/logic/services/graph/test_config_service.py::test_config_service_set_and_get - ModuleNotFoundError: No module named 'ciris_engine.logic.services.runtime.secrets_service'
ERROR tests/ciris_engine/logic/services/graph/test_config_service.py::test_config_service_get_nonexistent - ModuleNotFoundError: No module named 'ciris_engine.logic.services.runtime.secrets_service'
ERROR tests/ciris_engine/logic/services/graph/test_config_service.py::test_config_service_update_config - ModuleNotFoundError: No module named 'ciris_engine.logic.services.runtime.secrets_service'
ERROR tests/ciris_engine/logic/services/graph/test_config_service.py::test_config_service_list_configs - ModuleNotFoundError: No module named 'ciris_engine.logic.services.runtime.secrets_service'
ERROR tests/ciris_engine/logic/services/graph/test_config_service.py::test_config_service_list_by_prefix - ModuleNotFoundError: No module named 'ciris_engine.logic.services.runtime.secrets_service'
ERROR tests/ciris_engine/logic/services/graph/test_config_service.py::test_config_service_delete_config - ModuleNotFoundError: No module named 'ciris_engine.logic.services.runtime.secrets_service'
ERROR tests/ciris_engine/logic/services/graph/test_config_service.py::test_config_service_complex_values - ModuleNotFoundError: No module named 'ciris_engine.logic.services.runtime.secrets_service'
ERROR tests/ciris_engine/logic/services/graph/test_config_service.py::test_config_service_capabilities - ModuleNotFoundError: No module named 'ciris_engine.logic.services.runtime.secrets_service'
ERROR tests/ciris_engine/logic/services/graph/test_config_service.py::test_config_service_status - ModuleNotFoundError: No module named 'ciris_engine.logic.services.runtime.secrets_service'
ERROR tests/ciris_engine/logic/services/graph/test_config_service.py::test_config_service_versioning - ModuleNotFoundError: No module named 'ciris_engine.logic.services.runtime.secrets_service'
ERROR tests/ciris_engine/logic/services/graph/test_config_service.py::test_config_service_metadata_tracking - ModuleNotFoundError: No module named 'ciris_engine.logic.services.runtime.secrets_service'
ERROR tests/ciris_engine/logic/services/graph/test_config_service.py::test_config_service_batch_operations - ModuleNotFoundError: No module named 'ciris_engine.logic.services.runtime.secrets_service'
ERROR tests/ciris_engine/logic/services/graph/test_config_service.py::test_config_service_sensitive_config - ModuleNotFoundError: No module named 'ciris_engine.logic.services.runtime.secrets_service'
ERROR tests/ciris_engine/logic/services/graph/test_config_service.py::test_config_node_typed_graph_node_compliance - ModuleNotFoundError: No module named 'ciris_engine.logic.services.runtime.secrets_service'
ERROR tests/ciris_engine/logic/services/graph/test_config_service.py::test_config_service_no_duplicate_updates - ModuleNotFoundError: No module named 'ciris_engine.logic.services.runtime.secrets_service'
ERROR tests/ciris_engine/logic/services/graph/test_config_service.py::test_config_service_path_values - ModuleNotFoundError: No module named 'ciris_engine.logic.services.runtime.secrets_service'
ERROR tests/ciris_engine/logic/services/infrastructure/test_authentication.py::TestAuthenticationService::test_start_stop - TypeError: AuthenticationService.__init__() got an unexpected keyword argument 'secrets_service'
ERROR tests/ciris_engine/logic/services/infrastructure/test_authentication.py::TestAuthenticationService::test_create_token - TypeError: AuthenticationService.__init__() got an unexpected keyword argument 'secrets_service'
ERROR tests/ciris_engine/logic/services/infrastructure/test_authentication.py::TestAuthenticationService::test_verify_valid_token - TypeError: AuthenticationService.__init__() got an unexpected keyword argument 'secrets_service'
ERROR tests/ciris_engine/logic/services/infrastructure/test_authentication.py::TestAuthenticationService::test_verify_expired_token - TypeError: AuthenticationService.__init__() got an unexpected keyword argument 'secrets_service'
ERROR tests/ciris_engine/logic/services/infrastructure/test_authentication.py::TestAuthenticationService::test_verify_invalid_token - TypeError: AuthenticationService.__init__() got an unexpected keyword argument 'secrets_service'
ERROR tests/ciris_engine/logic/services/infrastructure/test_authentication.py::TestAuthenticationService::test_refresh_token - TypeError: AuthenticationService.__init__() got an unexpected keyword argument 'secrets_service'
ERROR tests/ciris_engine/logic/services/infrastructure/test_authentication.py::TestAuthenticationService::test_refresh_invalid_token - TypeError: AuthenticationService.__init__() got an unexpected keyword argument 'secrets_service'
ERROR tests/ciris_engine/logic/services/infrastructure/test_authentication.py::TestAuthenticationService::test_revoke_token - TypeError: AuthenticationService.__init__() got an unexpected keyword argument 'secrets_service'
ERROR tests/ciris_engine/logic/services/infrastructure/test_authentication.py::TestAuthenticationService::test_check_permission_allowed - TypeError: AuthenticationService.__init__() got an unexpected keyword argument 'secrets_service'
ERROR tests/ciris_engine/logic/services/infrastructure/test_authentication.py::TestAuthenticationService::test_check_permission_denied - TypeError: AuthenticationService.__init__() got an unexpected keyword argument 'secrets_service'
ERROR tests/ciris_engine/logic/services/infrastructure/test_authentication.py::TestAuthenticationService::test_check_permission_unauthenticated - TypeError: AuthenticationService.__init__() got an unexpected keyword argument 'secrets_service'
ERROR tests/ciris_engine/logic/services/infrastructure/test_authentication.py::TestAuthenticationService::test_validate_api_key - TypeError: AuthenticationService.__init__() got an unexpected keyword argument 'secrets_service'
ERROR tests/ciris_engine/logic/services/infrastructure/test_authentication.py::TestAuthenticationService::test_validate_invalid_api_key - TypeError: AuthenticationService.__init__() got an unexpected keyword argument 'secrets_service'
ERROR tests/ciris_engine/logic/services/infrastructure/test_authentication.py::TestAuthenticationService::test_create_service_token - TypeError: AuthenticationService.__init__() got an unexpected keyword argument 'secrets_service'
ERROR tests/ciris_engine/logic/services/infrastructure/test_authentication.py::TestAuthenticationService::test_permission_levels - TypeError: AuthenticationService.__init__() got an unexpected keyword argument 'secrets_service'
ERROR tests/ciris_engine/logic/services/infrastructure/test_authentication.py::TestAuthenticationService::test_cleanup_expired_tokens - TypeError: AuthenticationService.__init__() got an unexpected keyword argument 'secrets_service'
ERROR tests/ciris_engine/logic/services/infrastructure/test_authentication.py::TestAuthenticationService::test_get_capabilities - TypeError: AuthenticationService.__init__() got an unexpected keyword argument 'secrets_service'
ERROR tests/ciris_engine/logic/services/infrastructure/test_authentication.py::TestAuthenticationService::test_get_status - TypeError: AuthenticationService.__init__() got an unexpected keyword argument 'secrets_service'
ERROR tests/ciris_engine/logic/services/infrastructure/test_authentication.py::TestAuthenticationService::test_encrypt_token_metadata - TypeError: AuthenticationService.__init__() got an unexpected keyword argument 'secrets_service'
ERROR tests/ciris_engine/logic/services/infrastructure/test_authentication.py::TestAuthenticationService::test_concurrent_token_creation - TypeError: AuthenticationService.__init__() got an unexpected keyword argument 'secrets_service'
ERROR tests/ciris_engine/logic/services/infrastructure/test_authentication.py::TestAuthenticationService::test_token_with_custom_expiry - TypeError: AuthenticationService.__init__() got an unexpected keyword argument 'secrets_service'
ERROR tests/integration/test_deferral_integration.py::TestDeferralIntegration::test_full_deferral_flow - TypeError: WiseAuthorityService.__init__() got an unexpected keyword argument 'memory_service'
ERROR tests/integration/test_deferral_integration.py::TestDeferralIntegration::test_concurrent_deferrals_different_priorities - TypeError: WiseAuthorityService.__init__() got an unexpected keyword argument 'memory_service'
ERROR tests/integration/test_deferral_integration.py::TestDeferralIntegration::test_time_based_deferral_with_scheduler - TypeError: WiseAuthorityService.__init__() got an unexpected keyword argument 'memory_service'
ERROR tests/integration/test_deferral_integration.py::TestDeferralIntegration::test_deferral_modification_by_wa - TypeError: WiseAuthorityService.__init__() got an unexpected keyword argument 'memory_service'
ERROR tests/integration/test_deferral_integration.py::TestDeferralErrorScenarios::test_wa_service_unavailable_fallback - TypeError: WiseAuthorityService.__init__() got an unexpected keyword argument 'memory_service'
ERROR tests/integration/test_deferral_integration.py::TestDeferralErrorScenarios::test_malformed_deferral_recovery - TypeError: WiseAuthorityService.__init__() got an unexpected keyword argument 'memory_service'
ERROR tests/test_defer_handler.py::TestDeferHandler::test_basic_deferral_success - AttributeError: type object 'TaskStatus' has no attribute 'IN_PROGRESS'
ERROR tests/test_defer_handler.py::TestDeferHandler::test_time_based_deferral - AttributeError: type object 'TaskStatus' has no attribute 'IN_PROGRESS'
ERROR tests/test_defer_handler.py::TestDeferHandler::test_deferral_with_parameter_error - AttributeError: type object 'TaskStatus' has no attribute 'IN_PROGRESS'
ERROR tests/test_defer_handler.py::TestDeferHandler::test_deferral_when_wise_authority_fails - AttributeError: type object 'TaskStatus' has no attribute 'IN_PROGRESS'
ERROR tests/test_defer_handler.py::TestDeferHandler::test_deferral_with_task_metadata - AttributeError: type object 'TaskStatus' has no attribute 'IN_PROGRESS'
ERROR tests/test_defer_handler.py::TestDeferHandler::test_system_task_not_deferred - AttributeError: type object 'TaskStatus' has no attribute 'IN_PROGRESS'
ERROR tests/test_defer_handler.py::TestDeferHandler::test_concurrent_deferrals - AttributeError: type object 'TaskStatus' has no attribute 'IN_PROGRESS'
ERROR tests/test_defer_handler.py::TestDeferHandler::test_deferral_with_priority - AttributeError: type object 'TaskStatus' has no attribute 'IN_PROGRESS'
ERROR tests/test_defer_handler.py::TestDeferralLifecycle::test_deferral_notification_flow
ERROR tests/test_deferral_permissions.py::TestDeferralPermissions::test_authority_can_resolve_deferrals - pydantic_core._pydantic_core.ValidationError: 4 validation errors for WAPermission
ERROR tests/test_deferral_permissions.py::TestDeferralPermissions::test_observer_cannot_resolve_deferrals - pydantic_core._pydantic_core.ValidationError: 4 validation errors for WAPermission
ERROR tests/test_deferral_permissions.py::TestDeferralPermissions::test_expired_certificate_cannot_resolve - pydantic_core._pydantic_core.ValidationError: 4 validation errors for WAPermission
ERROR tests/test_deferral_permissions.py::TestDeferralPermissions::test_revoked_certificate_cannot_resolve - pydantic_core._pydantic_core.ValidationError: 4 validation errors for WAPermission
ERROR tests/test_deferral_permissions.py::TestDeferralPermissions::test_resource_specific_permissions - pydantic_core._pydantic_core.ValidationError: 4 validation errors for WAPermission
ERROR tests/test_deferral_permissions.py::TestDeferralPermissions::test_grant_permission - pydantic_core._pydantic_core.ValidationError: 4 validation errors for WAPermission
ERROR tests/test_deferral_permissions.py::TestDeferralPermissions::test_revoke_permission - pydantic_core._pydantic_core.ValidationError: 4 validation errors for WAPermission
ERROR tests/test_deferral_permissions.py::TestDeferralPermissions::test_permission_inheritance - pydantic_core._pydantic_core.ValidationError: 4 validation errors for WAPermission
ERROR tests/test_deferral_permissions.py::TestDeferralPermissions::test_concurrent_permission_checks - pydantic_core._pydantic_core.ValidationError: 4 validation errors for WAPermission
ERROR tests/test_deferral_permissions.py::TestDeferralRoleEnforcement::test_resolution_role_validation
ERROR tests/test_deferral_permissions.py::TestDeferralRoleEnforcement::test_permission_expiration
ERROR tests/test_deferral_permissions.py::TestDeferralAuditTrail::test_deferral_resolution_audit
ERROR tests/test_deferral_permissions.py::TestDeferralAuditTrail::test_failed_authorization_audit
ERROR tests/test_wise_bus_deferrals.py::TestWiseBusErrorHandling::test_invalid_defer_until_format
========================================== 124 failed, 607 passed, 58 skipped, 90 warnings, 155 errors in 234.41s (0:03:54) ===========================================
emoore@LEGION7:~/CIRISAgent$
